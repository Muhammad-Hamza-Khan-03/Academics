(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[94366],{80185:function(e,t,n){"use strict";n.r(t),n.d(t,{ForceSetUserInputInUic:function(){return pc},GetAppModal:function(){return Ac},GetAppModalExperience:function(){return $i},KeyboardKeys:function(){return Os},SubjectDropdown:function(){return Ds},UnifiedInputComponent:function(){return ac},UnifiedInputEditor:function(){return oc},UnifiedInputRenderer:function(){return hc},generateHtmlForRenderer:function(){return uc},unifiedInputComponentExternalFunctionality:function(){return _c}});var r,i=n(27791),a=n(8136),o=n(50824),s=n.n(o),l=n(86677),c=n(27378),u=n(74961),d=n(68114),h=n(24662),p=n(68860),m=n(96745),v=n(84718),f=n(36648),g=n(69153),y=n(71142),b=n(54029),x=n(75688);!function(e){e.GLOBAL_COMMAND_KEY="wtaCmd",e.DEFAULT_NAMESPACE="default",e[e.RIO_CLIENT_INTERVAL=10]="RIO_CLIENT_INTERVAL",e[e.RIO_CLIENT_TIMEOUT=5e3]="RIO_CLIENT_TIMEOUT"}(r||(r={}));var C,E,S,I,k,w,T;!function(e){e.TYPEAHEAD="typeahead",e.ENTER_SUBMIT="enter_submit",e.BUTTON_SUBMIT="button_submit"}(C||(C={})),function(e){e.STUDY="study"}(E||(E={})),function(e){e.BIGEGG_SRP="bigegg-srp",e.BIGEGG_SUGGEST="bigegg-suggest"}(S||(S={})),function(e){e.MOBILE="mobile",e.DESKTOP="desktop"}(I||(I={})),function(e){e.KEY_UP="keyup",e.MIX="mix",e.PASTE="paste",e.CAMERA="camera"}(k||(k={})),function(e){e.ERROR="error",e.INFO="info",e.SUCCESS="success",e.WARNING="warning"}(w||(w={})),function(e){e.TEXTBOOKS="textbooks",e.QUESTIONS="questions",e.SUGGESTIONS="suggestions"}(T||(T={}));var M,P,A,_,O="search user query",N="unified input",Z="user query",H="keyboard menu",L="unified input camera",z="unified input",R="unable to process image",D="file exceeds 5mb limit",U="continue uploading image",B="continue uploading image without ocr",F="remove image",j="image added to unified input",q="component unified input",W="image transcribed by ocr",G="start search query",K="search query",V="keyboard type",Q="specialty keyboard used",$="character limit exceeded",X="input exceeds 5000 character limit",Y="search query result item",J="query result item",ee="unable to transcribe image",te="open image upload",ne="multiple isbn entered",re="incorrect isbn",ie="Media API service is unavailable",ae="Sight API service is unavailable",oe="bottom unified input",se="search suggestion pill",le="get the app",ce="get the app via qr code",ue="unified input image upload",de="unified input paq",he="next image",pe="reset",me="edit image completed",ve="show all images";!function(e){e.LOGGED_OUT="logged_out",e.HARD_OR_SOFT_LOGGED_IN="hard_or_soft_logged_in"}(M||(M={})),function(e){e.CLICKSTREAM_VIEW="clickstream_view",e.CLICKSTREAM_INTERACTION="clickstream_interaction",e.CLICKSTREAM_COMPONENT_VIEW="clickstream_component_view",e.CLICKSTREAM_NOTIFICATIONS="clickstream_notifications",e.CLICKSTREAM_SUCCESS="clickstream_success",e.SEARCH_QUERY="search_query"}(P||(P={})),function(e){e.VIDEO_PLAYER="video player",e.ICON="icon",e.BUTTON="button",e.LINK="link",e.DROP_DOWN="drop down",e.COMPONENT="component",e.TEXT="text",e.SEARCH="search",e.SELECT="select",e.BANNER="banner"}(A||(A={})),function(e){e.PLAY="play",e.PAUSE="pause",e.SEARCH="search",e.CLICK="click",e.EXPAND="expand",e.SELECT="select",e.SUBSCRIBE="subscribe",e.START="start",e.COLLAPSE="collapse"}(_||(_={}));var fe,ge,ye=Object.freeze({EXACT:"exact",GREAT:"great",PRACTICE:"practice"}),be=(Object.freeze({EXACT:98}),function(e){return e.replace(/<code class="asciimath">|<\/code>/g,"").trim()}),xe=function(e){return e.replace(/<code class="asciimath">|<\/code>/g,"")},Ce=function(e,t,n){return t||n||!e?!t&&n&&n==xe(e)?k.PASTE:t&&be(t)==be(e)?k.CAMERA:k.MIX:k.KEY_UP},Ee="Welcome! What would you like help with today?",Se=[{id:"PhysicsEquations",dataId:"acceleration",Label:"Acceleration",Text:"a=(v-v<sub>0</sub>/t)",AsciiMath:"\\overline{a}=(v-v_(0))/(t)"},{id:"PhysicsEquations",dataId:"angularVelocity",Label:"Angular Velocity",Text:"&omega;=&Delta;&theta;/t",AsciiMath:"\\omega = (\\Delta \\theta )/(t)"},{id:"PhysicsEquations",dataId:"centripetalAcceleration",Label:"Centripetal Acceleration",Text:"a<sub>c</sub>=v<sup>2</sup>/r",AsciiMath:"a_(c)=(v^(2))/(r)"},{id:"PhysicsEquations",dataId:"density",Label:"Density",Text:"&#x03C1;=m/V",AsciiMath:"\\rho =(m)/(V)"},{id:"PhysicsEquations",dataId:"displacement",Label:"Displacement",Text:"x=x<sub>0</sub>+v<sub>0</sub>*t+<sup>1</sup>&frasl;<sub>2</sub>at<sup>2</sup>",AsciiMath:"x=x_(0)+v_(0)*t+(1)/(2)at^(2)"},{id:"PhysicsEquations",dataId:"electricPower",Label:"Electric Power (Watts)",Text:"P=VI",AsciiMath:"P=VI"},{id:"PhysicsEquations",dataId:"force",Label:"Force",Text:"F=ma",AsciiMath:"F=ma"},{id:"PhysicsEquations",dataId:"idealGasLaw",Label:"Ideal Gas Law",Text:"PV=nRT",AsciiMath:"PV=nRT"},{id:"PhysicsEquations",dataId:"kineticEnergy",Label:"Kinetic Energy",Text:"K=1/2mv<sup>2</sup>",AsciiMath:"K=(1)/(2)mv^(2)"},{id:"PhysicsEquations",dataId:"ohmLaw",Label:"Ohm's Law",Text:"V=IR",AsciiMath:"V=IR"},{id:"PhysicsEquations",dataId:"power",Label:"Power",Text:"P=W/t",AsciiMath:"P=(W)/(t)"},{id:"PhysicsEquations",dataId:"wavelength",Label:"Wavelength",Text:"&#x03BB;=v/f",AsciiMath:"\\lambda =(v)/(f)"},{id:"PhysicsEquations",dataId:"weight",Label:"Weight",Text:"w=m*g",AsciiMath:"w=m*g"}],Ie={math:{keys:[{id:"division",character:null,uni:"\xf7",keycode:null},{id:"lte",character:null,uni:"\u2264",keycode:null},{id:"gte",character:null,uni:"\u2265",keycode:null},{id:"degree",character:"o",uni:null,keycode:111},{id:"pi",character:null,uni:"\u03c0",keycode:null},{id:"infinity",character:null,uni:"\u221e",keycode:null},{id:"intersect",character:null,uni:"\u2229",keycode:null},{id:"union",character:null,uni:"\u222a",keycode:null},{id:"angstrom",character:null,uni:"\uf215",keycode:null},{id:"xBar",character:null,uni:"\uf050",keycode:null},{id:"muXBar",character:null,uni:"\uf047",keycode:null},{id:"sigmaXBar",character:null,uni:"\uf049",keycode:null},{id:"pow",character:null,uni:"\uf137",keycode:null},{id:"sub",character:null,uni:"\uf138",keycode:null},{id:"scientific",character:null,uni:"\uf016",keycode:null},{id:"nlog",character:null,uni:"\uf077",keycode:null},{id:"fraction",character:null,uni:"\uf139",keycode:null},{id:"mixed",character:null,uni:"\uf120",keycode:null},{id:"sqrt",character:null,uni:"\u221a",keycode:null},{id:"nthrt",character:null,uni:"\uf023",keycode:null},{id:"indefIntegral",character:null,uni:"\u222b",keycode:null},{id:"defIntegral",character:null,uni:"\uf044",keycode:null},{id:"piecewise",character:null,uni:"\uf084",keycode:null},{id:"summation",character:null,uni:"\uf030",keycode:null},{id:"point",character:null,uni:"\uf121",keycode:null},{id:"lim",character:null,uni:"\uf029",keycode:null},{id:"permutation",character:null,uni:"\uf012",keycode:null},{id:"combination",character:null,uni:"\uf011",keycode:null},{id:"matrix",character:null,uni:"\uf005",keycode:null},{id:"table",character:null,uni:"\uf007",keycode:null},{id:"xPxTable",character:null,uni:"\uf006",keycode:null},{id:"arrow",character:null,uni:"\uf027",keycode:null},{id:"positiveIon",character:null,uni:"\uf091",keycode:null},{id:"negativeIon",character:null,uni:"\uf092",keycode:null}]},geometry:{keys:[{id:"circle",character:null,uni:"\uf032",keycode:null},{id:"triangle",character:null,uni:"\uf036",keycode:null},{id:"tri",character:null,uni:"\uf162",keycode:null},{id:"rectangle",character:null,uni:"\uf033",keycode:null},{id:"parallelogram",character:null,uni:"\uf034",keycode:null},{id:"trapezoid",character:null,uni:"\uf035",keycode:null},{id:"sphere",character:null,uni:"\uf042",keycode:null},{id:"cylinder",character:null,uni:"\uf040",keycode:null},{id:"cone",character:null,uni:"\uf039",keycode:null},{id:"pyramid",character:null,uni:"\uf041",keycode:null},{id:"box",character:null,uni:"\uf038",keycode:null}]}},ke=[{id:"alpha",label:"&#x03B1;",func:"alpha"},{id:"beta",label:"&#x03B2;",func:"beta"},{id:"epsilon",label:"&#x03B5;",func:"epsilon"},{id:"theta",label:"&#x03B8;",func:"theta"},{id:"lambda",label:"&#x03BB;",func:"lambda"},{id:"mu",label:"&#x03BC;",func:"mu"},{id:"rho",label:"&#x03C1;",func:"rho"},{id:"sigma",label:"&#x03C3;",func:"sigma"},{id:"tau",label:"&#x03C4;",func:"tau"},{id:"phi",label:"&#x03C6;",func:"phi"},{id:"omega",label:"&#x03C9;",func:"omega"},{id:"Delta",label:"&#x0394;",func:"Delta"},{id:"Phi",label:"&#x03A6;",func:"Phi"},{id:"Omega",label:"&#x03A9;",func:"Omega"}];!function(e){e.CACHE_FIRST="cache-first",e.CACHE_ONLY="cache-only",e.CACHE_AND_NETWORK="cache-and-network",e.NETWORK_ONLY="network-only",e.NO_CACHE="no-cache",e.STANDBY="standby"}(fe||(fe={})),function(e){e.ALL="all",e.IGNORE="ignore",e.NONE="none"}(ge||(ge={}));var we,Te;!function(e){e.IMAGE_PREVIEW_MODAL="imagePreviewModal"}(we||(we={})),function(e){e.UP="up",e.RIGHT="right",e.DOWN="down",e.LEFT="left"}(Te||(Te={}));var Me,Pe=["image/jpeg","image/jpg","image/png"],Ae=5242880,_e="bigegg-srp",Oe="study",Ne="/chat",Ze="search-metadata",He="apollographql-client-name",Le="chegg-web",ze="uicDataSource",Re="force-set-user-input-in-uic",De={x:0,y:0,width:100,height:100,unit:"%"},Ue="delete-selection",Be="delete-singleselection",Fe=5e3,je={subjectsList:{Math:"math",Geometry:"geometry",Physics:"physics","Greek Alphabet":"greekAlphabet"},physicsEquationsLabels:[{dataId:"acceleration",Label:"acceleration"},{dataId:"angularVelocity",Label:"angular Velocity"},{dataId:"centripetalAcceleration",Label:"Centripetal Acceleration"},{dataId:"density",Label:"density"},{dataId:"displacement",Label:"Displacement"},{dataId:"electricPower",Label:"Electric Power (Watts)"},{dataId:"force",Label:"Force"},{dataId:"idealGasLaw",Label:"Ideal Gas Law"},{dataId:"kineticEnergy",Label:"Kinetic Energy"},{dataId:"ohmLaw",Label:"Ohm's Law"},{dataId:"power",Label:"Power"},{dataId:"wavelength",Label:"Wavelength"},{dataId:"weight",Label:"Weight"}],tooltipTexts:{uploadImage:"Upload Image",specialSymbols:"Special Symbols",maxLimitReached:"Image limit reached",multipleImageSupport:{title:"New!",message:"Now you can add up to 5 images."},enableMathMode:{title:"Solving a math problem?",message:"Easily ask math, physics, and chemistry questions in math mode."},betterMathFormatting:{title:"You\u2019re in math mode!",message:"Keep typing to automatically convert special characters into math symbols."}},ocrData:{popover:{heading:"image(s) added",singleUpload:"Add text from an image",multipleUpload:"Add images for reference"},heading:"Adjust the frame around one question",buttons:{resetButton:"Reset",continue:"Continue",next:"Next",done:"Done"},errorMessages:{emptyImage:{heading:"We couldn't find your question",message:"Would you still like to upload your image? You'll have to enter text manually in order to submit your question."},couldNotTranscribeImage:{title:"We couldn't find your question",message:"Would you still like to upload your image? You'll have to enter text manually in order to submit your question."}},loadingText:"Processing...",placeholderText:"Drop images here or upload from your computer"},editorInlineErrors:{inputLimitExceeded:"Must be less than ".concat(Fe," characters."),multipleIsbnDetectedError:"Please search 1 EAN or ISBN at a time.",noMatchingIsbnFound:"Sorry, we couldn't find anything matching your search."},sideBottomErrors:{imageLimitReached:{message1:"You can add up to 1 image",message5:"You can add up to 5 images"},couldNotUploadImage:{title:"Failed to upload image for OCR",message:"Try uploading a different image or try again later."},sightApiDown:{title:"Failed to get transcription",message:"Try uploading a different image or try again later."},couldNotSearchQuestion:{title:"Something went wrong",message:"We were unable to search the archive. You can still submit your question to experts."},fileSizeExceedsLimit:{title:"Please use a smaller image",message:"Images must be under ".concat(Ae/Math.pow(1024,2),"MB")},tooManyFilesUploaded:{title:"Please upload a single file only",message:"We only support transcribing one image at a time."},invalidFileUploaded:{title:"Invalid or unsupported file",message:"Valid file formats: ".concat(Pe.join(", "),".")},unknownError:{title:"Unkown Error",message:"An unknown error occurred. Please try after some time."}},mtcLabels:{tryItOut:"Try it out!",tryItOutLabel:["Show me the steps to solve ...","Give me an example of ..."]},mtcLegalDisclaimer:{text:"Instant responses come from subject-matter experts, AI models trained on Chegg's learning content, or OpenAI\u200b. Automated chats are recorded & may be used to improve your experience. Please don\u2019t share sensitive info."}},qe=Object.freeze({SEARCH_QUERY:"SearchBox-search-query",RECENT_QUERY:"SearchBox-recent-query",URL_QUERY_PARAMS:"SearchBox-URL-query-prams"});!function(e){e.GARUDA="GARUDA"}(Me||(Me={}));var We,Ge=/Fill in the given values you have, and we'll solve for the missing variable./gi,Ke=function(e,t){if("number"!==typeof e)return null;if(e>98){if(0===t)return ye.EXACT;if(t>=1&&t<=3)return ye.GREAT;if(4===t)return ye.PRACTICE}else{if(t>=0&&t<=2)return ye.GREAT;if(3===t)return ye.PRACTICE}return null},Ve=function(e){var t=[],n=1;return e.forEach((function(e,r){var i={search_result_id:e.id,search_result_rank:n,search_result_module_name:null,search_result_module_rank:n,search_result_rank_in_module:n,is_search_result_cached:null,search_result_category_exists:null,search_result_type:E.STUDY,search_result_algo_score:e.score,search_result_match_percent:e.matchScore,search_result_match_badge:Ke(e.matchScore,r),search_result_match_percent_v2:e.matchScoreV2};t.push(i),n++})),t},Qe=function(e,t,n,r,i,a,o,s,l,c,u){return{type:P.CLICKSTREAM_INTERACTION,data:{content:{metadata:{search:{auto_type:Ce(e,t,n),experience:/Mobile/.test(navigator.userAgent)?I.MOBILE:I.DESKTOP,profile:S.BIGEGG_SRP,term:xe(e),type:r,strack_id:l||void 0,track_id:c||void 0,search_id:u||void 0,result_type:i},multi_turn_chat:o?{conversation_id:o,role:s.role,message_type:s.messageType}:void 0}},event_name:O,interaction:{type:_.SEARCH,element:{name:Z,type:r==C.BUTTON_SUBMIT?A.ICON:A.TEXT,region_name:a?oe:N}}},eventVersion:3}},$e=(0,n(32292).getClient)(),Xe=function(e){var t;null===(t=$e.sendEvent(e))||void 0===t||t.catch(console.error)},Ye=n(45980),Je=n(4753),et=n(83463),tt=et.ZP.button.withConfig({componentId:"susd2d-0"})(["align-items:center;background-color:",";background-color:",";border:",";border-radius:",";cursor:pointer;display:flex;height:",";justify-content:center;margin:0;padding:0;width:",";",""],p.Z.white,(function(e){return e.active?"#201258":"#ffff"}),Ye.Z.px8,(function(e){return e.theme.cuiTheme.radius.circle}),Ye.Z.px40,Ye.Z.px40,(function(e){return e.disabled?(0,et.iv)(["background-color:",";cursor:default;"],p.Z.grey200):(0,et.iv)(["&:hover{z-index:400;","}"],(0,Je.Z)())})),nt=function(e){var t=e["aria-label"],n=e.children,r=e["data-test"],i=e.disabled,a=e.onClick,o=e.active,s=e.id;return c.createElement(tt,{"aria-label":t,"data-test":r,disabled:i,onClick:a,active:o,id:s},n)},rt=n(25773),it=n(64649),at=n(13285),ot=n(10895),st=n(54192),lt=n(60654),ct=n(49034),ut=n(91976),dt=n(22951);function ht(e){return![We.Character,We.Head,We.Placeholder,We.TrigLog].includes(e.type)}!function(e){e[e.Accent=0]="Accent",e[e.Character=1]="Character",e[e.Fraction=2]="Fraction",e[e.Head=3]="Head",e[e.Integral=4]="Integral",e[e.Limit=5]="Limit",e[e.Matrix=6]="Matrix",e[e.PermComb=7]="PermComb",e[e.Piecewise=8]="Piecewise",e[e.Placeholder=9]="Placeholder",e[e.Radical=10]="Radical",e[e.ShapeTable=11]="ShapeTable",e[e.Subscript=12]="Subscript",e[e.Summation=13]="Summation",e[e.Superscript=14]="Superscript",e[e.Table=15]="Table",e[e.EquationTable=16]="EquationTable",e[e.TrigLog=17]="TrigLog"}(We||(We={}));var pt={type:"trapezoid",char:"&#xF129;",width:3.125,labels:[["b","_1","="],["b","_2","="],["h","="]]},mt={type:"tri",char:"&#xF140;",width:4,labels:[["b","="],["A","="],["c","="],["B","="],["a","="],["C","="]]},vt=[{type:"rectangle",char:"&#xF127;",width:4.09375,labels:[["l","="],["w","="]]},{type:"circle",char:"&#xF126;",width:3.6875,labels:[["r","="]]},{type:"triangle",char:"&#xF130;",width:3.5625,labels:[["h","="],["b","="]]},{type:"parallelogram",char:"&#xF128;",width:4.96875,labels:[["h","="],["b","="]]},pt,{type:"box",char:"&#xF131;",width:4.34375,labels:[["h","="],["l","="],["w","="]]},{type:"sphere",char:"&#xF135;",width:4.625,labels:[["r","="]]},{type:"cone",char:"&#xF132;",width:3.625,labels:[["h","="],["r","="]]},{type:"cylinder",char:"&#xF133;",width:3.65625,labels:[["h","="],["r","="]]},{type:"pyramid",char:"&#xF134;",width:4.9375,labels:[["h","="],["l","="],["w","="]]},mt];function ft(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yt=["\u03b1","\u03b2","\u03b3","\u03b4","\u03b5","\u03b6","\u03b7","\u03b8","\u03b9","\u03ba","\u03bb","\u03bc","\u03bd","\u03be","\u03bf","\u03c0","\u03c1","\u03c3","\u03c4","\u03c5","\u03c6","\u03c7","\u03c8","\u03c9","\u221e","x\u0304"],bt="\u21b5";function xt(e){return"string"===typeof e?e:e.value}function Ct(e){return"0"===(e=xt(e))||"1"===e||"2"===e||"3"===e||"4"===e||"5"===e||"6"===e||"7"===e||"8"===e||"9"===e}function Et(e){return 1===(e=xt(e)).length&&(e[0]>="a"&&e[0]<="z"||e[0]>="A"&&e[0]<="Z")}function St(e){return"."===(e=xt(e))}function It(e){return"\xd7"===(e=xt(e))||"\xf7"===e||"+"===e||"-"===e||"\u2229"===e||"\u222a"===e||"="===e||"<"===e||">"===e||"\u2264"===e||"\u2265"===e||"\u2260"===e||"\u2192"===e||"\xb0"===e||"%"===e||","===e||"?"===e||"."===e||"_"===e||"^"===e||"\xb1"===e||"\u2220"===e||"\u2299"===e||"\u25b3"===e||"\u25a1"===e||"\u2245"===e||"\u2225"===e||"\u27c2"===e}function kt(e){return"!"===xt(e)}function wt(e){return":"===(e=xt(e))||"~"===e||"@"===e||"#"===e||"$"===e||"&"===e||";"===e}function Tt(e){return"<"===(e=xt(e))||"\u2264"===e||">"===e||"\u2265"===e||"\u2260"===e}function Mt(e){return"|"===(e=xt(e))}function Pt(e){return At(e=xt(e))||_t(e)||Mt(e)}function At(e){return"("===(e=xt(e))||"["===e||"{"===e}function _t(e){return")"===(e=xt(e))||"]"===e||"}"===e}function Ot(e){return null!==function(e){var t,n=ft(vt);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.char===e)return r}}catch(i){n.e(i)}finally{n.f()}return null}(e=xt(e))}function Nt(e){return" "===(e=xt(e))||"\t"===e}function Zt(e){return Et(e=xt(e))||yt.indexOf(e)>=0}function Ht(e){return(e=xt(e))===bt}function Lt(e){return","===(e=xt(e))}function zt(e){return"string"===typeof(e=xt(e))&&/^[\ud800-\udbff]$/.test(e)}function Rt(e){return"string"===typeof(e=xt(e))&&/^[\udc00-\udfff]$/.test(e)}function Dt(e,t){var n,r=t;if(t.type===We.Head){if((r=Bt(t))===t||!t.next)return!0;t=t.next}var i=null!==(n=e.prev)&&void 0!==n?n:e;return e.prev=r,r.next=e,i.next=t,t.prev=i,!0}var Ut=function(){function e(){(0,dt.Z)(this,e)}return(0,ut.Z)(e,null,[{key:"GetNewId",value:function(){var t=e._id;return e._id++,"EditorElement_".concat(t)}}]),e}();function Bt(e){var t;return null!==(t=e.prev)&&void 0!==t?t:e}function Ft(e,t){var n,r=t;if(t.type===We.Head){if((r=Bt(t))===t||!t.next)return!0;t=t.next}var i=null!==(n=e.next)&&void 0!==n?n:e;return e.next=t,t.prev=e,i.prev=r,r.next=i,!0}function jt(e){switch(e.type){case We.Limit:case We.Subscript:case We.Superscript:case We.Accent:return[e.contents];case We.Fraction:return[e.numerator,e.denominator];case We.Integral:case We.Summation:return[e.lowerBound,e.upperBound];case We.Matrix:case We.Piecewise:case We.ShapeTable:case We.EquationTable:case We.Table:return(0,at.Z)(e.children);case We.PermComb:return[e.left,e.right];case We.Radical:return[e.index,e.radicand]}}function qt(e){if(e){for(;(null===(t=e)||void 0===t?void 0:t.type)!==We.Head;){var t,n;e=null!==(n=e.next)&&void 0!==n?n:e}return e}return{type:We.Head}}function Wt(e){switch(e.type){case We.Limit:var t,n,r,i;return!!Wt(e.contents)||((null===(t=e.contents.next)||void 0===t?void 0:t.type)===We.Character&&"\u2192"===e.contents.next.value?e.contents.next.next===e.contents:(null===(n=e.contents.next)||void 0===n?void 0:n.type)===We.Placeholder&&(null===(r=e.contents.next.next)||void 0===r?void 0:r.type)===We.Character&&"\u2192"===e.contents.next.next.value&&(null===(i=e.contents.next.next.next)||void 0===i?void 0:i.type)===We.Placeholder&&e.contents.next.next.next.next===e.contents);case We.Table:return e.children.slice(2).every((function(e){return Wt(e)}));case We.Radical:return Wt(e.radicand);case We.Subscript:case We.Superscript:case We.Accent:case We.Fraction:case We.Integral:case We.Summation:case We.Matrix:case We.Piecewise:case We.ShapeTable:case We.EquationTable:case We.PermComb:return jt(e).every((function(e){return Wt(e)}));case We.Head:return(!e.next||e.next===e)&&(!e.prev||e.prev===e)}}function Gt(e){var t;switch(e.type){case We.Accent:case We.Limit:case We.Subscript:case We.Superscript:return Bt(e.contents);case We.Fraction:return Bt(e.denominator);case We.Head:var n,r,i=e.parent;if(!i)return e;if(i.type===We.Fraction){if(i.denominator===e)return Bt(i.numerator)}else if(i.type===We.Integral||i.type===We.Summation){if(i.upperBound===e)return Bt(i.lowerBound)}else if(i.type===We.PermComb){if(i.right===e)return Bt(i.left)}else if(i.type===We.Radical){if(i.radicand===e)return Bt(i.index)}else if(i.type===We.Matrix||i.type===We.Piecewise||i.type===We.Table||i.type===We.ShapeTable||i.type===We.EquationTable){var a=i.children.indexOf(e);if(a>0)return Bt(i.children[a-1])}else if(i.type===We.Superscript&&(null===(n=i.prev)||void 0===n?void 0:n.type)===We.Subscript)return Bt(i.prev.contents);return null!==(r=i.prev)&&void 0!==r?r:i;case We.Integral:case We.Summation:return Bt(e.upperBound);case We.Matrix:case We.Piecewise:case We.ShapeTable:case We.EquationTable:case We.Table:return Bt(e.children[e.children.length-1]);case We.PermComb:return Bt(e.right);case We.Radical:return Bt(e.radicand);case We.Character:case We.Placeholder:case We.TrigLog:return null!==(t=e.prev)&&void 0!==t?t:e}}function Kt(e){var t;return function(e,t){switch(e.type){case We.Accent:case We.Limit:case We.Subscript:case We.Superscript:return e.contents;case We.Fraction:return e.numerator;case We.Head:var n,r=e.parent;if(!r)return t;if(r.type===We.Fraction){if(r.numerator===e)return r.denominator}else if(r.type===We.PermComb){if(r.left===e)return r.right}else if(r.type===We.Radical){if(r.index===e)return r.radicand}else if(r.type===We.Integral||r.type===We.Summation){if(r.lowerBound===e)return r.upperBound}else if(r.type===We.Matrix||r.type===We.Piecewise||r.type===We.ShapeTable||r.type===We.Table||r.type===We.EquationTable){var i=r.children.indexOf(e);if(i+1<r.children.length)return r.children[i+1]}else if(r.type===We.Subscript&&(null===(n=r.next)||void 0===n?void 0:n.type)===We.Superscript)return r.next.contents;return r;case We.Integral:case We.Summation:return e.lowerBound;case We.Matrix:case We.Piecewise:case We.ShapeTable:case We.EquationTable:case We.Table:return e.children.length?e.children[0]:e;case We.PermComb:return e.left;case We.Radical:return e.index;case We.Character:case We.Placeholder:case We.TrigLog:return e}}(null!==(t=e.next)&&void 0!==t?t:e,e)}(0,it.Z)(Ut,"_id",0);var Vt=function(){function e(){(0,dt.Z)(this,e)}return(0,ut.Z)(e,null,[{key:"GetNewId",value:function(){var t=e._id;return e._id++,"EditorElement_".concat(t)}}]),e}();function Qt(e,t){if(void 0===t&&(t=[]),"string"===typeof t&&(t=[t]),Array.isArray(t)){var n={type:We.Head,next:void 0,prev:void 0,parent:e};n.next=n,n.prev=n;for(var r=0;r<t.length;r++){var i=t[r];"string"===typeof i&&(i=$t(i)),Xt(n,i)}return n.id=Vt.GetNewId(),n}return t}function $t(e,t,n){var r={type:We.Character,next:void 0,prev:void 0,value:e,grey:null!==t&&void 0!==t&&t,math:null!==n&&void 0!==n&&n};return r.next=r,r.prev=r,r.id=Vt.GetNewId(),r}function Xt(e,t){return Dt(e,t),e}function Yt(e){var t;return null!==(t=e.prev)&&void 0!==t?t:e}function Jt(e){var t;return null!==(t=e.next)&&void 0!==t?t:e}function en(e,t){var n,r=[];for(n=e;n!==Yt(e);){var i;r.push(n),n=t?null!==(i=n.next)&&void 0!==i?i:n:Kt(n)}return r.push(n),r}function tn(e){return e.next!==e}function nn(e,t){for(var n=hn(t);n.next&&n.next!==e&&(n.next.type!==We.Character||!Ht(n.next));)n=n.next;return n}function rn(e,t){for(var n=hn(t);n.prev&&n.prev!==Yt(e)&&(n.type!==We.Character||!Ht(n));)n=n.prev;return n}function an(e,t,n){var r=e.next;if(t===n)return!1;if(t===e)return!0;if(n===e)return!1;for(;r&&r.type!==We.Head;){if(r===t)return!0;if(r===n)return!1;r=r.next}throw"Neither A or B found in Head.IsABeforeB"}function on(e){return function(e,t){var n,r=e.next;for(;r&&r.type!==We.Head&&(r.type!==We.Character||r.value!==t);)r=r.next;return null!==(n=r)&&void 0!==n?n:e}(e,bt)!==e}function sn(e,t,n){var r,i,a,o=e.next,s=null;if(n.includes("editor01-"))return{startNode:s=e,endNode:e.prev};for(;o&&o.type!==We.Head&&(o.type!==We.Character||o.id!==n);)o=o.next;o=null===(i=s=null===(r=o)||void 0===r?void 0:r.prev)||void 0===i?void 0:i.next;for(var l=0;o&&o.type===We.Character&&o.value===t[l]&&l<t.length;)o=o.next,l++;return{startNode:s,endNode:null===(a=o)||void 0===a?void 0:a.prev}}function ln(e,t,n){var r,i,a=Yt(e),o=null!==(r=t.prev)&&void 0!==r?r:t,s=n?null!==(i=n.next)&&void 0!==i?i:n:e;o.next=s,s.prev=o;var l=Qt();return l.next=t,l.prev=n||a,t.prev=l,n?n.next=l:a.next=l,l}function cn(e,t,n){var r=[];r.push(Qt());for(var i=0,a=e.next;a&&a.type!==We.Head;){var o=a.next;n&&a.type===We.Character&&At(a)?i++:n&&a.type===We.Character&&_t(a)&&i--,0===i&&a.type===We.Character&&a.value===t?r.push(Qt()):Xt(r[r.length-1],a),a=o}return r}(0,it.Z)(Vt,"_id",0);var un=function(e){e.next=e,e.prev=e};function dn(e){var t;return!!Wt(e)&&[We.Matrix,We.Fraction,We.Piecewise,We.Table,We.ShapeTable,We.Superscript,We.Subscript,We.Accent,We.Radical,We.PermComb,We.Limit].includes(null===(t=e.parent)||void 0===t?void 0:t.type)}function hn(e){for(var t=qt(e),n=e;t.parent;)t=qt(n=t.parent);return n}function pn(e){var t,n,r;if(At(e))t=function(e){return Kt(e)},n=function(e){return e.type===We.Character&&At(e)},r=function(e){return e.type===We.Character&&_t(e)};else{if(!_t(e))throw"arg to FindMatchingParen must be paren";t=function(e){return Gt(e)},n=function(e){return e.type===We.Character&&_t(e)},r=function(e){return e.type===We.Character&&At(e)}}var i=e,a=1;do{n(i=t(i))?a++:r(i)&&a--}while(a>0);return i}function mn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vn(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fn(e){var t,n=mn(vt);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.type===e.toLowerCase())return r}}catch(i){n.e(i)}finally{n.f()}return null}function gn(e){var t,n=mn(vt);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.char.toLowerCase()===e.toLowerCase())return r}}catch(i){n.e(i)}finally{n.f()}return null}var yn=n(33940),bn=function(){function e(){(0,dt.Z)(this,e)}return(0,ut.Z)(e,null,[{key:"initializeUnitArrays",value:function(){e.allunitnames=[],e.allunittypes=[];for(var t=0;t<e.UnitTypes.length;t++)for(var n=e.UnitTypes[t].type,r=e.UnitTypes[t].names,i=0;i<r.length;i++)e.allunitnames.push(r[i]),e.allunittypes.push(n)}},{key:"GetAllUnits",value:function(){return 0==e.allunitnames.length&&e.initializeUnitArrays(),e.allunitnames}},{key:"GetUnitTypeByName",value:function(t){0==e.allunitnames.length&&e.initializeUnitArrays();for(var n=0;n<e.allunitnames.length;n++)if(e.allunitnames[n]===t)return e.allunittypes[n];return"unknown"}}]),e}();(0,it.Z)(bn,"UnitTypes",[{type:"kL",names:["kiloliters","kilolitres","kiloliter","kilolitre","kL"]},{type:"hL",names:["hectoliters","hectolitres","hectoliter","hectolitre","hL"]},{type:"daL",names:["decaliters","decalitres","decaliter","decalitre","dekaliters","dekaliter","daL"]},{type:"L",names:["liters","litres","liter","litre"]},{type:"dL",names:["deciliters","decilitres","deciliter","decilitre","dL"]},{type:"cL",names:["centiliters","centilitres","centiliter","centilitre","cL"]},{type:"mL",names:["milliliters","millilitres","milliliter","millilitre","ml","mL"]},{type:"km",names:["kilometers","kilometres","kilometer","kilometre","km"]},{type:"hm",names:["hectometers","hectometres","hectometer","hectometre"]},{type:"dam",names:["decameters","decametres","decameter","decametre","dekameters","dekameter"]},{type:"m",names:["meters","metres","meter","metre"]},{type:"dm",names:["decimeters","decimetres","decimeter","decimetre"]},{type:"cm",names:["centimeters","centimetres","centimeter","centimetre","cm"]},{type:"mm",names:["millimeters","millimetres","millimeter","millimetre","mm"]},{type:"Mg",names:["tonnes","tonne","megagrams","megagram"]},{type:"kg",names:["kilograms","kilogram","kg"]},{type:"hg",names:["hectograms","hectogram"]},{type:"dag",names:["decagrams","decagram","dekagrams","dekagram"]},{type:"g",names:["grams","gram"]},{type:"dg",names:["decigrams","decigram"]},{type:"cg",names:["centigrams","centigram","cg"]},{type:"mg",names:["milligrams","milligram","mg"]},{type:"s",names:["seconds"]},{type:"hr",names:["hours","hour","hr"]},{type:"gal",names:["gallons","gallon","gals","gal"]},{type:"qt",names:["quarts","quart","qts","qt"]},{type:"pt",names:["pints","pint","pts","pt"]},{type:"c",names:["cups","cup"]},{type:"mi",names:["miles","mile","mi"]},{type:"yd",names:["yards","yard","yds","yd"]},{type:"ft",names:["feets","foots","feet","foot","ft"]},{type:"in",names:["inches","inch"]},{type:"ton",names:["tons","ton"]},{type:"lb",names:["pounds","pound","lbs","lb"]},{type:"oz",names:["ounces","ounce","oz"]}]),(0,it.Z)(bn,"allunitnames",[]),(0,it.Z)(bn,"allunittypes",[]);var xn,Cn,En=function(){function e(t){(0,dt.Z)(this,e),(0,it.Z)(this,"func",void 0),this.func=t}return(0,ut.Z)(e,null,[{key:"Digit",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&Ct(e)}))}},{key:"Letter",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&Et(e)}))}},{key:"Identifier",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&Zt(e)}))}},{key:"NonletterIdentifier",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&!Et(e)&&Zt(e)}))}},{key:"Oper",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&It(e)}))}},{key:"Variable",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&Et(e)&&"e"!==e.value}))}},{key:"DecimalSep",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&St(e)}))}},{key:"PlusMinus",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&("+"===e.value||"-"===e.value)}))}},{key:"DecimalTwo",value:function(){return e.IsTrue((function(e){return e.type===We.Character&&Ct(e)&&"2"===e.value}))}},{key:"Any",value:function(){return e.IsTrue((function(){return!0}))}},{key:"Grey",value:function(){return new e((function(e){return e.type===We.Character&&e.grey?e:null}))}},{key:"NotGrey",value:function(){return new e((function(e){return e.type===We.Character&&e.grey?null:e}))}},{key:"SpecificCharacter",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.IsTrue((function(e){return e.type===We.Character&&(n?e.value.toUpperCase()===t.toUpperCase():e.value===t)}))}},{key:"LeftParen",value:function(){return e.SpecificCharacter("(")}},{key:"RightParen",value:function(){return e.SpecificCharacter(")")}},{key:"Factorial",value:function(){return e.SpecificCharacter("!")}},{key:"NaturalNumber",value:function(){return e.Many(e.Digit())}},{key:"Integer",value:function(){return e.Con(e.Opt(e.PlusMinus()),e.NaturalNumber())}},{key:"Decimal",value:function(){return e.Con(e.Integer(),e.Opt(e.Con(e.DecimalSep(),e.NaturalNumber())))}},{key:"Number",value:function(){return e.Or(e.Con(e.NaturalNumber(),e.Opt(e.Con(e.DecimalSep(),e.NaturalNumber()))),e.Con(e.DecimalSep(),e.NaturalNumber()))}},{key:"SubSup",value:function(){return e.Con(e.Subscript(),e.Superscript())}},{key:"DecimalFraction",value:function(){return e.Fraction(e.Decimal(),e.Decimal())}},{key:"DecimalSuper",value:function(){return e.Superscript(e.Decimal())}},{key:"Coff",value:function(){return e.Or(e.Decimal(),e.DecimalFraction())}},{key:"PolyVarTerm",value:function(){return e.Con(e.Opt(e.PlusMinus()),e.Opt(e.Coff()),e.Letter(),e.Opt(e.DecimalSuper()))}},{key:"Poly2OrMore",value:function(){return e.Con(e.PolyVarTerm(),e.Many(e.Con(e.PlusMinus(),e.Or(e.PolyVarTerm(),e.Coff()))))}},{key:"SuperTwo",value:function(){return e.Superscript(e.DecimalTwo())}},{key:"QuadraticTerm",value:function(){return e.Con(e.Opt(e.PlusMinus()),e.Opt(e.Coff()),e.Letter(),e.Opt(e.SuperTwo()))}},{key:"ConstantTerm",value:function(){return e.Con(e.Opt(e.PlusMinus()),e.Coff())}},{key:"DefectiveQuadraticPoly",value:function(){return e.Con(e.QuadraticTerm(),e.ConstantTerm(),e.ConstantTerm())}},{key:"FuncName",value:function(){return e.Or.apply(e,(0,at.Z)(e.FuncNames.map((function(t){return e.SpecificWord(t)}))))}},{key:"FuncNameAndScript",value:function(){return e.Con(e.FuncName(),e.Opt(e.Or(e.Superscript(),e.Subscript())))}},{key:"FunctionWithParenArg",value:function(){return e.Con(e.FuncNameAndScript(),e.ParenGroup())}},{key:"SpecificWord",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.Con.apply(e,(0,at.Z)([t].map((function(t){return e.SpecificCharacter(t,n)}))))}},{key:"NonfunctionLetterSequence",value:function(){var t=e.Many(e.Letter());return new e((function(n){var r=t.func(n);if(!r)return r;for(var i="",a=n;a!==r;a=e.NextToken(a)){var o;if((null===(o=a)||void 0===o?void 0:o.type)!==We.Character)throw"pointer must be Character";i+=a.value}return e.FuncNames.some((function(e){return i.includes(e)}))?null:r}))}},{key:"Word",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.Or(e.Lookahead(e.Epsilon(),e.Or(e.WordFinalPunctuation(),e.SpecificCharacter(" ",!0))),e.Lookahead(e.Epsilon(),e.IsTrue((function(e){return e.type===We.Head})))),r=e.Or(e.Many(e.Con(e.Letter(),e.Opt(e.WordMiddlePunctuation())),3),e.Con(e.TwoLetterWord(),n),e.SpecialWord());t||(r=e.Or(r,e.Con(e.OneLetterWord(),n)));var i=e.Or(e.Many(e.WordFinalPunctuation()),e.Lookahead(e.Epsilon(),e.IsFalse((function(e){return e.type===We.Superscript||e.type===We.Subscript}))));return e.Con(e.Opt(e.WordInitialPunctuation()),r,i)}},{key:"TwoLetterWord",value:function(){return e.Or.apply(e,(0,at.Z)(e.twoLengthWordWhiteList.map((function(t){return e.SpecificWord(t,!0)}))))}},{key:"OneLetterWord",value:function(){return e.Or(e.CapitalIWord(),e.WeakOneLetterWord())}},{key:"CapitalIWord",value:function(){return e.Lookahead(e.SpecificCharacter("I"),e.IsFalse((function(e){return e.type===We.Character&&Et(e)})))}},{key:"WeakOneLetterWord",value:function(){return e.Lookahead(e.Or(e.SpecificCharacter("a",!0),e.SpecificCharacter("i",!0)),e.Con(e.Many(e.SpecificCharacter(" ")),e.Word(!0)))}},{key:"SpecialWord",value:function(){return e.Or.apply(e,(0,at.Z)(e.SpecialWords.map((function(t){return e.SpecificWord(t)}))))}},{key:"WordInitialPunctuation",value:function(){return e.Or(e.SpecificCharacter("'"),e.SpecificCharacter('"'))}},{key:"WordMiddlePunctuation",value:function(){return e.SpecificCharacter("'")}},{key:"WordFinalPunctuation",value:function(){return e.Or(e.SpecificCharacter("!"),e.SpecificCharacter("?"),e.Lookahead(e.SpecificCharacter("."),e.IsFalse((function(e){return e.type===We.Character&&Ct(e)}))),e.SpecificCharacter(","),e.SpecificCharacter('"'),e.Con(e.Lookahead(e.Epsilon(),e.SmileyString(),!0),e.Or(e.SpecificCharacter(":"),e.SpecificCharacter(";"))))}},{key:"PermComb",value:function(){return e.Con(e.NaturalNumber(),e.Or(e.SpecificCharacter("P"),e.SpecificCharacter("C")),e.NaturalNumber())}},{key:"Unit",value:function(){var t=bn.GetAllUnits(),n=e.Or.apply(e,(0,at.Z)(t.map((function(t){return e.SpecificWord(t)}))));return e.Lookahead(n,e.UnitFollow())}},{key:"UnitFollow",value:function(){return e.Or(e.WordFinalPunctuation(),e.IsTrue((function(e){return e.type===We.Head||e.type===We.Superscript||e.type===We.Character&&(Nt(e)||Ht(e)||wt(e)||Pt(e)||Mt(e))})))}},{key:"ChemCompound",value:function(){return e.Lookahead(e.Con(e.Opt(e.NaturalNumber()),e.Or(e.ChemIon(),e.Many(e.ChemCompoundItem()))),e.ChemFollow())}},{key:"ChemCompoundItem",value:function(){return e.Or(e.ChemElementAndSubscript(),e.Con(e.LeftParen(),e.Many(e.ChemElementAndSubscript()),e.RightParen(),e.Subscript(e.Opt(e.NaturalNumber()))))}},{key:"ChemElementAndSubscript",value:function(){return e.Con(e.ChemElement(),e.Opt(e.Subscript(e.NaturalNumber())))}},{key:"ChemIon",value:function(){return e.Con(e.ChemElement(),e.Superscript(e.Or(e.Con(e.PlusMinus(),e.Opt(e.NaturalNumber())),e.Con(e.NaturalNumber(),e.PlusMinus()))))}},{key:"ChemElement",value:function(){return e.Or.apply(e,(0,at.Z)(e.ChemElementArr.map((function(t){return e.SpecificWord(t)}))))}},{key:"ChemFollow",value:function(){return e.Or(e.WordFinalPunctuation(),e.IsTrue((function(e){return e.type===We.Head||e.type===We.Character&&(Nt(e)||Ht(e)||It(e)||wt(e))})))}},{key:"ParenGroup",value:function(){return new e((function(t){var n;if(t.type!==We.Character||!At(t))return null;for(var r=1,i=e.NextToken(t);i&&i.type!==We.Head&&(1!==r||i.type!==We.Character||!_t(i));){if(i.type===We.Character&&At(i)?r++:i.type===We.Character&&_t(i)&&r--,r<0)return null;i=e.NextToken(i)}return 1===r&&(null===(n=i)||void 0===n?void 0:n.type)===We.Character&&_t(i)?e.NextToken(i):null}))}},{key:"PullInFractionNumerator",value:function(){return e.Many(e.Or(e.ParenGroup(),e.FunctionWithParenArg(),e.NonfunctionLetterSequence(),e.NonletterIdentifier(),e.Digit(),e.DecimalSep(),e.Superscript(),e.Subscript(),e.Radical(),e.Factorial()),1)}},{key:"PullInFractionDenominator",value:function(){return e.Many(e.Or(e.ParenGroup(),e.Identifier(),e.Digit(),e.DecimalSep(),e.Variable(),e.Superscript(),e.Subscript(),e.Radical(),e.Factorial()),1)}},{key:"FractionString",value:function(){return e.CaptureGroups(e.Opt(e.PullInFractionNumerator()),e.SpecificCharacter("/"),e.Opt(e.PullInFractionDenominator()))}},{key:"SmileyString",value:function(){var t=new e((function(e){var t;return(null===(t=e.prev)||void 0===t?void 0:t.type)!==We.Character?null:" "===e.prev.value?e:null})),n=e.Con(e.Or(e.SpecificCharacter(":"),e.SpecificCharacter(";")),e.Opt(e.SpecificCharacter("-")),e.Or(e.Con(e.NotGrey(),e.SpecificCharacter(")")),e.Con(e.NotGrey(),e.SpecificCharacter("("))));return e.Con(e.Or(e.Start(),t),n,e.Or(e.SpecificCharacter(" "),e.End()))}},{key:"NextToken",value:function(e){var t;return e.type===We.Head?e:null!==(t=e.next)&&void 0!==t?t:null}},{key:"IsTrue",value:function(t){return new e((function(n){return t(n)?e.NextToken(n):null}))}},{key:"IsFalse",value:function(t){return e.IsTrue((function(e){return!t(e)}))}},{key:"Con",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return new e((function(e){for(var t=0,r=n;t<r.length;t++){var i=r[t].func(e);if(!i)return null;e=i}return e}))}},{key:"Or",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return new e((function(e){for(var t=0,r=n;t<r.length;t++){var i=r[t].func(e);if(null!==i)return i}return null}))}},{key:"Lookahead",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new e((function(e){var i=t.func(e);if(null===i)return null;var a=n.func(i);return r||null!==a?r&&null!==a?null:i:null}))}},{key:"Opt",value:function(t){return e.Many(t,0,1)}},{key:"Many",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return new e((function(e){for(var i=0,a=!0;i<r&&a&&e.type!==We.Head;){var o=t.func(e);null===o?a=!1:(i++,e=o)}return i>=n&&i<=r?e:null}))}},{key:"Epsilon",value:function(){return new e((function(e){return e}))}},{key:"Null",value:function(){return new e((function(){return null}))}},{key:"Fraction",value:function(t,n){return new e((function(r){var i,a;if(r.type===We.Fraction&&(r.numerator.next&&(null===(i=t.func(r.numerator.next))||void 0===i?void 0:i.type)===We.Head&&r.denominator.next&&(null===(a=n.func(r.denominator.next))||void 0===a?void 0:a.type)===We.Head))return e.NextToken(r);return null}))}},{key:"Radical",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.Many(e.Any(),0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Many(e.Any(),0);return new e((function(r){var i,a;if(r.type===We.Radical&&(r.index.next&&(null===(i=t.func(r.index.next))||void 0===i?void 0:i.type)===We.Head&&r.radicand.next&&(null===(a=n.func(r.radicand.next))||void 0===a?void 0:a.type)===We.Head))return e.NextToken(r);return null}))}},{key:"Superscript",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.Many(e.Any(),0);return new e((function(n){var r;if(n.type===We.Superscript&&(n.contents.next&&(null===(r=t.func(n.contents.next))||void 0===r?void 0:r.type)===We.Head))return e.NextToken(n);return null}))}},{key:"Subscript",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.Many(e.Any(),0);return new e((function(n){var r;if(n.type===We.Subscript&&(n.contents.next&&(null===(r=t.func(n.contents.next))||void 0===r?void 0:r.type)===We.Head))return e.NextToken(n);return null}))}},{key:"CaptureGroups",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return new e((function(e,t){for(var r,i,a=e,o={},s=0;s<n.length;s++){if(null===(i=n[s].func(a)))return null;o["$"+(s+1)]={start:a,end:i},a=i}if("object"===(0,yn.Z)(t))for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(t[l]=o[l]);return null!==(r=i)&&void 0!==r?r:null}))}},{key:"Start",value:function(){return new e((function(e){return e.prev&&e.prev.type!==We.Head?null:e}))}},{key:"End",value:function(){return new e((function(e){return e.type===We.Head?e:null}))}}]),e}();function Sn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return In(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return In(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function In(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,it.Z)(En,"FuncNames",["arcsinh","arccosh","arccsch","arcsech","arctanh","arccoth","arcsin","arcsen","arccos","arctan","arccsc","arcsec","arccot","sinh","cosh","tanh","csch","sech","coth","sqrt","abs","sin","sen","cos","tan","csc","sec","cot","log","ln","lim"]),(0,it.Z)(En,"twoLengthWordWhiteList",["of","to","in","it","is","be","as","at","so","we","he","by","or","on","do","if","me","my","up","an","go","no","us","am","i'd","i'm","hi","ok","ty","np","Im","pc"]),(0,it.Z)(En,"SpecialWords",["y-intercept","y-int","slope-intercept","x-int","x-intercept","x intercept","y intercept"].sort().reverse()),(0,it.Z)(En,"ChemElementArr",["Nh","Mc","Ts","Og","Uue","Ac","Ag","Al","Am","Ar","As","At","Au","Ba","Be","Bh","Bi","Bk","Br","Ca","Cd","Ce","Cf","Cl","Cm","Cn","Co","Cr","Cs","Cu","Db","Ds","Dy","Er","Es","Eu","Fe","Fl","Fm","Fr","Ga","Gd","Ge","He","Hf","Hg","Ho","Hs","In","Ir","Kr","La","Li","Lr","Lu","Lv","Md","Mg","Mn","Mo","Mt","Na","Nb","Nd","Ne","Ni","No","Np","Os","Pa","Pb","Pd","Ph","Pm","Po","Pr","Pt","Pu","Ra","Rb","Re","Rf","Rg","Rh","Rn","Ru","Sb","Sc","Se","Sg","Si","Sm","Sn","Sr","Ta","Tb","Tc","Te","Th","Ti","Tl","Tm","Xe","Yb","Zn","Zr","B","C","F","H","I","K","N","O","P","S","U","V","W","Y"]),function(e){e.ALGEBRA="algebra",e.BASICMATH="basicmath",e.CALCULUS="calculus",e.CHEMISTRY="chemistry",e.FINITEMATH="finitemath",e.LINEARALGEBRA="linearalgebra",e.PREALGEBRA="prealgebra",e.PRECALCULUS="precalculus",e.STATISTICS="statistics",e.TRIGONOMETRY="trigonometry",e.GRAPH="graphing"}(xn||(xn={}));var kn=(0,ut.Z)((function e(){(0,dt.Z)(this,e)}));function wn(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[],a=null!==(n=e.children[t].next)&&void 0!==n?n:e.children[t];if(dn(e.children[t]))return[On(e.children[t],r)];var o=Nn.RunAutomaton(a,!0,void 0,void 0,r);i.push("");var s,l=Sn(o);try{for(l.s();!(s=l.n()).done;){var c=s.value;i[i.length-1]+=c.html;var u=c.type;"word"!==u&&"space"!==u&&"comma"!==u||i.push("")}}catch(d){l.e(d)}finally{l.f()}return""===i[i.length-1]&&i.pop(),i}function Tn(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n)t=e.value;else{t="";for(var r=0;r<e.value.length;r++)t+='<mi mathvariant="italic" id ='+e.id+" >"+e.value[r]+"</mi>"}return t}function Mn(){return"<mo>"+Nn.FunctionApplicationSymbol+"</mo>"}function Pn(e,t,n,r){var i="<"+t;if(e.id&&!n&&(i+=' id="'+e.id+'"'),r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i+=" "+a+'="'+r[a]+'"');return i+=">"}(0,it.Z)(kn,"ChemElement",En.ChemElement()),(0,it.Z)(kn,"ChemCompound",En.ChemCompound()),(0,it.Z)(kn,"Number",En.Number()),(0,it.Z)(kn,"FuncName",En.FuncName()),(0,it.Z)(kn,"Unit",En.Unit()),(0,it.Z)(kn,"Word",En.Word()),(0,it.Z)(kn,"SubSup",En.SubSup()),(0,it.Z)(kn,"Smiley",En.SmileyString());var An={"\\overline":"&#x2c9;","\\overrightarrow":"&#x2192;","\\overleftrightarrow":"&#x2194;","\\overfrown":"&#x23dc;"};var _n=(Cn={},(0,it.Z)(Cn,We.Accent,(function(e,t,n,r,i,a,o){var s=Pn(e,"mover",t,{accent:"true",stretchy:"true"})+Pn(e.contents,"mrow",t);return s+=On(e.contents,t)+"</mrow><mo>"+An[e.accent]+"</mo>",s+="</mover>"})),(0,it.Z)(Cn,We.Character,(function(e,t,n,r,i,a,o){var s="";for(var l in void 0===e.id||t||(s+=' id="'+e.id+'"'),e.grey&&!t&&(s+=' class="greyParen"'),a)Object.prototype.hasOwnProperty.call(a,l)&&(s+=" "+l+'="'+a[l]+'"');var c="string"===typeof o?o:e.value;return Object.prototype.hasOwnProperty.call(Nn.UnicodeToHex,c)&&(c=Nn.UnicodeToHex[c]),"x\u0304"===e.value?'<mover accent="true" id ='+e.id+"><mi>x</mi><mo>&#x203e;</mo></mover>":"<".concat(i).concat(s,">").concat(c,"</").concat(i,">")})),(0,it.Z)(Cn,We.Fraction,(function(e,t,n,r,i,a,o){var s=Pn(e,"mfrac",t)+Pn(e.numerator,"mrow",t,{class:"fraction"});return s+=On(e.numerator,t),s+="</mrow>"+Pn(e.denominator,"mrow",t,{class:"fraction"}),s+=On(e.denominator,t),s+="</mrow></mfrac>"})),(0,it.Z)(Cn,We.Head,(function(e,t,n,r,i,a,o){var s,l,c,u,d,h="";if(e.parent&&(null===(s=e.next)||void 0===s?void 0:s.type)!==We.EquationTable?(u=!0,d=!0):(u=!1,d=!1,h+=Pn(e,"div",t,{class:"editorLine"})),dn(e))return Nn.PlaceholderString;if(((null===(l=e.parent)||void 0===l?void 0:l.type)===We.Summation||(null===(c=e.parent)||void 0===c?void 0:c.type)===We.Integral)&&Wt(e))return e.parent.placeholders?Nn.PlaceholderString:"<mphantom>"+Pn(e,"mi",t)+Nn.ZeroWidthNonBreakingSpace+"</mi></mphantom>";var p,m=Nn.RunAutomaton(null!==(p=e.next)&&void 0!==p?p:e,d,n,void 0,t);d||function(e){for(var t=null,n=0;n<e.length;n++)if("space"===e[n].type)t&&t.push(e[n]);else if(e[n].inMath)for(t||(t=[]);t.length>0;){var r=t.pop();if(!r)throw"popped undefined from stack";if(!("inMathHtml"in r))throw"space step without inMathHtml";r.html=r.inMathHtml,r.inMath=!0}else t=null}(m);for(var v=0;v<m.length;v++){var f=m[v];d||(u&&!f.inMath&&(h+="</mrow></math>"),!u&&f.inMath&&(h+="<math><mrow>"),u=f.inMath),h+=f.html}return e.parent||(u&&(h+="</mrow></math>"),h+="</div>"),h})),(0,it.Z)(Cn,We.Integral,(function(e,t,n,r,i,a,o){var s='<mstyle displaystyle="true"><munderover>'+Pn(e,"mo",t)+Nn.IntegralSymbol+"</mo>";return s+=Pn(e.lowerBound,"mrow",t),!tn(e.lowerBound)&&e.placeholders?s+=Nn.PlaceholderString:s+=On(e.lowerBound,t),s+="</mrow>",s+=Pn(e.upperBound,"mrow",t),!tn(e.upperBound)&&e.placeholders?s+=Nn.PlaceholderString:s+=On(e.upperBound,t),s+="</mrow>",s+="</munderover></mstyle>"})),(0,it.Z)(Cn,We.Limit,(function(e,t,n,r,i,a,o){var s="<munder>"+Pn(e,"mo",t,{class:"fontItalic"})+"lim</mo>"+Pn(e.contents,"mrow",t);return s+=On(e.contents,t),s+="</mrow></munder>"})),(0,it.Z)(Cn,We.Matrix,(function(e,t,n,r,i,a,o){for(var s=Pn(e,"mrow",t)+'<mo class="matrix">[</mo><mtable>',l=0;l<e.children.length;l+=e.numCols){s+="<mtr>"+e.children.slice(l,l+e.numCols).map((function(e){return"<mtd>"+Pn(e,"mrow",t)+On(e,t)+"</mrow></mtd>"})).join("")+"</mtr>"}return s+='</mtable><mo class="matrix">]</mo></mrow>'})),(0,it.Z)(Cn,We.PermComb,(function(e,t,n,r,i,a,o){var s=Pn(e,"mmultiscripts",t)+"<mi>"+e.letter+"</mi>";return s+=Pn(e.right,"mrow",t)+On(e.right,t)+"</mrow><none/><mprescripts/>",s+=Pn(e.left,"mrow",t)+On(e.left,t)+"</mrow><none/></mmultiscripts>"})),(0,it.Z)(Cn,We.Piecewise,(function(e,t,n,r,i,a,o){for(var s='<mrow><mo class="matrix">{</mo>'+Pn(e,"mtable",t),l=0;l<e.children.length;l++){var c=wn(e,l,t);s+="<mtr>";for(var u=0;u<c.length;u++){var d="",h="";1===c.length||2===c.length?(d="<mtd>",h="</mrow></mtd>",d+=0===u?Pn(e.children[l],"mrow",t):"<mrow>"):c.length>2&&(0===u?(d="<mtd>"+Pn(e.children[l],"mrow",t),h="</mrow></mtd><mtd><mrow>"):u===c.length-1&&(d="</mrow></mtd><mtd><mrow>",h="</mrow></mtd>")),s+=d+c[u]+h}s+="</mtr>"}return s+='</mtable><mspace width="em"></mspace></mrow>'})),(0,it.Z)(Cn,We.Placeholder,(function(e,t,n,r,i,a,o){return"".concat(Pn(e,"mo",t,{class:"Placeholder"}),"?</mo>")})),(0,it.Z)(Cn,We.Radical,(function(e,t,n,r,i,a,o){var s=Pn(e,"mroot",t)+Pn(e.radicand,"mrow",t,{class:"radical"})+On(e.radicand,t)+'<mspace width="thinmathspace"></mspace></mrow>';return Wt(e.index)?e.placeholders?s+=Pn(e.index,"mrow",t,{class:"radical"})+Nn.PlaceholderString+"</mrow>":s+='<mrow class="radical">'+Pn(e.index,"mphantom",t)+"<mn>2</mn></mphantom></mrow>":s+=Pn(e.index,"mrow",t,{class:"radical"})+On(e.index,t)+"</mrow>",s+="</mroot>"})),(0,it.Z)(Cn,We.ShapeTable,(function(e,t,n,r,i,a,o){var s,l,c=void 0===e.id||t?"":' id="'+e.id+'"',u="";if("tri"===(null===(s=e.shapeType)||void 0===s?void 0:s.type)){l="<mtable"+c+">";for(var d="<mtable>",h="<mtable>",p=0;p<e.labels.length;p+=2)d+="<mtr><mtd><mrow>",d+=On(e.labels[p],t),d+="</mrow></mtd><mtd>"+Pn(e.children[p],"mrow",t),d+=On(e.children[p],t),d+="</mrow></mtd></mtr>",h+="<mtr><mtd><mrow>",h+=On(e.labels[p+1],t),h+="</mrow></mtd><mtd>"+Pn(e.children[p+1],"mrow",t),h+=On(e.children[p+1],t),h+="</mrow></mtd></mtr>";return l+'<mtr><mtd class="tableMtd tableMtr"><mi>Side</mi></mtd><mtd class="tableMtr"><mi>Angle</mi></mtd></mtr><mtr><mtd  class="tableMtd">'+(d+="</mtable>")+"</mtd><mtd>"+(h+="</mtable>")+"</mtd></mtr></mtable>"}if(l="<mtable"+c+">",e.labels.length>1){var m;for(m=0;m<e.labels.length-1;m++)u+='<mtr><mtd class="tableMtr"><mrow>',u+=On(e.labels[m],t),u+='</mrow></mtd><mtd class="tableMtr">'+Pn(e.children[m],"mrow",t),u+=On(e.children[m],t),u+="</mrow></mtd></mtr>";u+="<mtr><mtd><mrow>",u+=On(e.labels[m],t),u+="</mrow></mtd><mtd>"+Pn(e.children[m],"mrow",t),u+=On(e.children[m],t),u+="</mrow></mtd></mtr>"}else u+="<mtr><mtd><mrow>",u+=On(e.labels[0],t),u+="</mrow></mtd><mtd>"+Pn(e.children[0],"mrow",t),u+=On(e.children[0],t),u+="</mrow></mtd></mtr>";return l+u+"</mtable>"})),(0,it.Z)(Cn,We.Subscript,(function(e,t,n,r,i,a,o){var s=Pn(e,"msub",t)+"<mrow>"+r+"</mrow>"+Pn(e.contents,"mrow",t);return s+=On(e.contents,t),s+="</mrow></msub>"})),(0,it.Z)(Cn,We.Summation,(function(e,t,n,r,i,a,o){var s='<mstyle displaystyle="true"><munderover>'+Pn(e,"mo",t)+Nn.SummationSymbol+"</mo>";return s+=Pn(e.lowerBound,"mrow",t),!tn(e.lowerBound)&&e.placeholders?s+=Nn.PlaceholderString:s+=On(e.lowerBound,t),s+="</mrow>",s+=Pn(e.upperBound,"mrow",t),!tn(e.upperBound)&&e.placeholders?s+=Nn.PlaceholderString:s+=On(e.upperBound,t),s+="</mrow>",s+="</munderover></mstyle>"})),(0,it.Z)(Cn,We.Superscript,(function(e,t,n,r,i,a,o){var s=Pn(e,"msup",t)+"<mrow>"+r+"</mrow>"+Pn(e.contents,"mrow",t);return s+=On(e.contents,t),s+="</mrow></msup>"})),(0,it.Z)(Cn,We.Table,(function(e,t,n,r,i,a,o){var s="<mtable"+(void 0===e.id||t?"":' id="'+e.id+'"')+">";s+="<mtr>"+Pn(e.children[0],"mtd",t,{class:"tableMtr tableMtd"}),s+=On(e.children[0],t),s+="</mtd>"+Pn(e.children[1],"mtd",t,{class:"tableMtr"}),s+=On(e.children[1],t),s+="</mtd></mtr>";for(var l=2;l<e.children.length;l+=2)s+="<mtr>"+Pn(e.children[l],"mtd",t,{class:"tableMtd"}),s+=On(e.children[l],t),s+="</mtd>"+Pn(e.children[l+1],"mtd",t),s+=On(e.children[l+1],t),s+="</mtd></mtr>";return s+="</mtable>"})),(0,it.Z)(Cn,We.EquationTable,(function(e,t,n,r,i,a,o){var s="<span"+(e.id&&!t?' id="'+e.id+'"':"")+' class="equationTableOuter">';s+='<span class="equationTableInstruction">'+e.label+"</span>",s+='<span class="equationTableEquation"><math><mstyle mathvariant="bold-italic" align="left">'+On(e.equation,t)+"</mstyle></math></span>",s+='<table class="equationTableInner">';for(var l=0;l<e.variables.length;l++)s+="<tr>",s+="<td><math><mrow>"+On(e.variables[l],t)+"</mrow></math></td>",s+="<td><math><mo>=</mo></math></td>",Wt(e.children[l])&&e.summaries?(s+='<td class="EquationTablePlaceholder"><math>'+Pn(e.children[l],"mrow",t),s+="<mrow><mtext>"+e.summaries[l]+"</mtext></mrow>"):(s+="<td><math>"+Pn(e.children[l],"mrow",t),s+=On(e.children[l],t)),s+="</mrow></math></td></tr>";return s+="</table>",s+="</span>"})),(0,it.Z)(Cn,We.TrigLog,(function(e,t,n,r,i,a,o){return Tn(e,t)+Mn()})),Cn);function On(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;switch(e.type){case We.Accent:case We.Character:case We.Fraction:case We.Head:case We.Integral:case We.Limit:case We.Matrix:case We.PermComb:case We.Piecewise:case We.Placeholder:case We.Radical:case We.ShapeTable:case We.Subscript:case We.Summation:case We.Superscript:case We.Table:case We.EquationTable:case We.TrigLog:return _n[e.type](e,t,n,r,i,a,o)}}var Nn=function(){function e(){(0,dt.Z)(this,e)}return(0,ut.Z)(e,null,[{key:"StepChemElement",value:function(t,n,r,i,a){if(r&&a){var o=kn.ChemElement.func(t);if(null!==o){for(var s='<mstyle mathvariant="normal">',l=e.EnumerateUntil(t,o),c=0;c<l.length;c++){s+=On(l[c],i,void 0,void 0,"mi")}return s+="</mstyle>",n.push({node:o,html:s,inMath:!0,type:"chemElement"}),!0}}return!1}},{key:"StepChemCompound",value:function(t,n,r,i,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(i===xn.CHEMISTRY&&!o&&(null===r||"space"===r||"oper"===r||"newline"===r)){var s=kn.ChemCompound.func(t);if(null!==s){var l=e.RunAutomaton(t,!0,xn.CHEMISTRY,(function(e){return e===s}),a,!0),c=l.map((function(e){return e.html})).join("");return n.push({node:s,html:c,inMath:!0,type:"chem"}),!0}}return!1}},{key:"StepNumber",value:function(t,n,r){var i=kn.Number.func(t);if(null!==i){var a,o="",s=Sn(e.EnumerateUntil(t,i));try{for(s.s();!(a=s.n()).done;){var l=a.value;if(l.type!==We.Character)throw"non-Character in Number";o+=r?l.value:On(l,r,void 0,void 0,"mn")}}catch(c){s.e(c)}finally{s.f()}return r&&(o="<mn>"+o+"</mn>"),n.push({node:i,html:o,inMath:!0,type:"number"}),!0}return!1}},{key:"StepUnit",value:function(t,n,r,i){if(null===r||"number"===r||"space"===r){var a=kn.Unit.func(t);if(null!==a){var o,s="",l="",c=Sn(e.EnumerateUntil(t,a));try{for(c.s();!(o=c.n()).done;){var u=o.value;if(u.type!==We.Character)throw"non-Character in Unit";l+=u.value,s+=i?u.value:On(u,i,void 0,void 0,"mi")}}catch(h){c.e(h)}finally{c.f()}i&&(s="<mi>"+s+"</mi>");var d='<mstyle mathvariant="normal" class="unit '+bn.GetUnitTypeByName(l)+'">'+s+"</mstyle>";return n.push({node:a,html:d,inMath:!0,type:"unit"}),!0}}return!1}},{key:"StepSmiley",value:function(t,n,r,i){var a=kn.Smiley.func(t);if(null!==a){var o,s=r?"mtext":"span",l="<"+s+">",c=Sn(e.EnumerateUntil(t,a));try{for(c.s();!(o=c.n()).done;){l+=On(o.value,i,void 0,void 0,s)}}catch(u){c.e(u)}finally{c.f()}return l+="</"+s+">",n.push({node:a,html:l,inMath:r,type:"smiley"}),!0}return!1}},{key:"StepWord",value:function(t,n,r,i,a){if("letter"!==i){var o=kn.Word.func(t);if(null!==o){var s,l=r?"mtext":"span",c="",u="",d=Sn(e.EnumerateUntil(t,o));try{for(d.s();!(s=d.n()).done;){var h=s.value;if(h.type!==We.Character)throw"non-Character in Word";u+=h.value,c+=a?h.value:On(h,a,void 0,void 0,l)}}catch(f){d.e(f)}finally{d.f()}for(var p=!1,m=n.length-1;m>=0;m--){var v=!1;switch(n[m].type){case"space":v=!0;break;case"word":p=!0}if(!v)break}if(e.IsAcceptableWord(u,r,p))return n.push({node:o,html:c,inMath:r,type:"word"}),!0}}return!1}},{key:"StepFuncName",value:function(t,n,r){var i=kn.FuncName.func(t);if(null!==i){var a="<mi>";r&&(a=Pn(t,"mi",r,{mathvariant:"normal"}));var o,s=Sn(e.EnumerateUntil(t,i));try{for(s.s();!(o=s.n()).done;){var l=o.value;if(l.type!==We.Character)throw"non-Character in FuncName";a+=r?l.value:On(l,r,void 0,void 0,"mi",{mathvariant:"normal"})}}catch(u){s.e(u)}finally{s.f()}a+="</mi>";var c="<mo>"+e.FunctionApplicationSymbol+"</mo>";return n.push({node:i,html:a+c,inMath:!0,type:"func",preHtml:a,postHtml:c}),!0}return!1}},{key:"StepSubSup",value:function(t,n,r,i){var a=kn.SubSup.func(t);if(null!==a){var o,s;if(e.IsBaseType(r)){var l=n.pop();if(!l)throw"popped empty stack";s=l.html}else s=e.PlaceholderString;var c=null===(o=a.prev)||void 0===o?void 0:o.prev,u=a.prev;if((null===c||void 0===c?void 0:c.type)!==We.Subscript||(null===u||void 0===u?void 0:u.type)!==We.Superscript)throw"SubSup not Sub followed by Sup";return n.push({node:a,html:e.MakeSubSup(s,c,u,i),inMath:!0,type:"subsup"}),!0}return!1}},{key:"StepCharacter",value:function(t,n,r,i,a){if(!t.next)throw"Character without next";var o,s;if(It(t)){if("'"===t.value)o=On(t,a,void 0,void 0,"mo",{},e.UnicodeToHex["\u2032"]);else if('"'===t.value)o=On(t,a,void 0,void 0,"mo",{},e.UnicodeToHex["\u2033"]);else if("*"===t.value)o=On(t,a,void 0,void 0,"mo",{},e.UnicodeToHex["*"]);else{if(":"===t.value&&!r)return o=On(t,a,void 0,void 0,"span",{},":"),void n.push({node:t.next,html:o,inMath:!1,type:"oper",inMathHtml:""});o=On(t,a,void 0,void 0,"mo")}s=","===t.value?"comma":"oper"}else if(kt(t))o=On(t,a,void 0,void 0,"mo"),s="factorial";else{if(wt(t))return o=On(t,a,void 0,void 0,r?"mtext":"span"),void n.push({node:t.next,html:o,inMath:r,type:"symbol"});if(Zt(t))return o=On(t,a,void 0,void 0,t.math?"mi":"span"),s="letter",void n.push({node:t.next,html:o,inMath:t.math,type:s});if(Ot(t)){var l,c=null===(l=function(e){var t,n=mn(vt);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.char===e)return r}}catch(i){n.e(i)}finally{n.f()}return null}(t.value))||void 0===l?void 0:l.type;if(void 0===c)throw"shape with invalid character";return o=On(t,a,void 0,void 0,"span",{class:c}),void n.push({node:t.next,html:o,inMath:!1,type:"shape"})}if(Nt(t)){var u=On(t,a,void 0,void 0,"mtext",{},e.NonBreakingSpace);return o=r?u:On(t,a,void 0,void 0,"span",{}," "+e.ZeroWidthNonBreakingSpace),void n.push({node:t.next,html:o,inMath:r,type:"space",inMathHtml:u})}if(Ht(t))return void n.push({node:t.next,html:"</div>"+Pn(t,"div",a,{class:"editorLine"}),inMath:!1,type:"newline"});var d="";switch(void 0===t.id||a||(d+=' id="'+t.id+'"'),t.grey&&!a&&(d+=' class="greyParen"'),t.value){case"\u263a":t.value="\u263a\ufe0f";case"\u2639":t.value="\u2639\ufe0f";default:t.value=t.value}o="<mi"+d+">"+t.value+"</mi>",s="letter"}n.push({node:t.next,html:o,inMath:!0,type:s})}},{key:"StepSubSupNode",value:function(t,n,r,i){if(!t.next)throw"should not happen";var a,o=e.GrouperToString(t);if(0===n.length)return a=On(t,i,void 0,e.PlaceholderString),void n.push({node:t.next,html:a,inMath:!0,type:o});if(e.IsBaseType(r)){var s=n.pop();if(!s)throw"popped empty stack";if("func"===r){if(!("preHtml"in s))throw"func without preHtml";a=On(t,i,void 0,s.preHtml)+s.postHtml}else a=On(t,i,void 0,s.html)}else a=On(t,i,void 0,e.PlaceholderString);n.push({node:t.next,html:a,inMath:!0,type:o})}},{key:"Step",value:function(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s="",l=null;if(n.length>0&&(l=n[n.length-1].type),!e.StepChemElement(t,n,i,a,o)&&!e.StepChemCompound(t,n,l,i,a,o)&&!e.StepNumber(t,n,a)&&!e.StepUnit(t,n,l,a)&&!e.StepSmiley(t,n,r,a)&&!e.StepWord(t,n,r,l,a)&&!e.StepFuncName(t,n,a)&&!e.StepSubSup(t,n,l,a))if(t.type===We.Character)e.StepCharacter(t,n,r,i,a);else if(t.type===We.Superscript||t.type===We.Subscript)e.StepSubSupNode(t,n,l,a);else{if(t.type===We.TrigLog){if(!t.next)throw"should not happen";var c=Tn(t,a),u=Mn();return void n.push({node:t.next,html:c+u,inMath:!0,type:"func",preHtml:c,postHtml:u})}var d;s=On(t,a);var h=e.GrouperToString(t);n.push({node:null!==(d=t.next)&&void 0!==d?d:t,html:s,inMath:!0,type:h})}}},{key:"RunAutomaton",value:function(t,n,r,i){var a,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];i=null!==(a=i)&&void 0!==a?a:function(){return!1};for(var l=t,c=[];l.type!==We.Head&&!i(l);){e.Step(l,c,n,r,o,s);var u=c[c.length-1];l=u.node}return c}},{key:"RunOnce",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];e.Step(t,r,n);var i=r.shift();return i}},{key:"EnumerateUntil",value:function(e,t){for(var n=[],r=e;r&&r.type!==We.Head&&r!==t;r=r.next)n.push(r);return n}},{key:"GrouperToString",value:function(e){return e.type===We.Fraction?"fraction":e.type===We.Superscript?"superscript":e.type===We.Subscript?"subscript":e.type===We.Limit?"limit":e.type===We.Integral?"integral":e.type===We.Summation?"summation":e.type===We.Radical?"radical":e.type===We.PermComb?"permcomb":e.type===We.Table?"table":e.type===We.Matrix?"matrix":e.type===We.Piecewise?"piecewise":e.type===We.ShapeTable?"shapetable":e.type===We.Placeholder?"placeholder":null}},{key:"MakeSubSup",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Pn(n,"msubsup",r);return i+="<mrow>"+e+"</mrow>",i+=Pn(t.contents,"mrow",r)+On(t.contents,r)+"</mrow>",i+=Pn(n.contents,"mrow",r)+On(n.contents,r)+"</mrow></msubsup>"}},{key:"IsAcceptableWord",value:function(t,n,r){var i=(!e.StartsWithOptionalVariableAndFuncName(t)||e.IsTriggyWord(t,r))&&!e.IsBlacklistedWord(t)&&(e.HasVowel(t)||e.IsWordWithoutVowel(t));return n&&(i=i&&!e.ContainsFuncName(t)),i}},{key:"StartsWithOptionalVariableAndFuncName",value:function(e){for(var t=0;t<En.FuncNames.length;t++){var n=En.FuncNames[t];if(e.startsWith(n)||e.startsWith("x"+n)||e.startsWith("y"+n)||e.startsWith("z"+n)||e.startsWith("i"+n)||e.startsWith("r"+n)||e.startsWith("t"+n)||e.startsWith("n"+n))return!0}return!1}},{key:"IsBlacklistedWord",value:function(e){return"xyz"===e||"abc"===e}},{key:"IsTriggyWord",value:function(t,n){t=e.TrimPunctuation(t);for(var r=0;r<e.TriggyWords.length;r++)if(t===e.TriggyWords[r])return!0;if(n)for(var i=0;i<e.VeryTriggyWords.length;i++)if(t===e.VeryTriggyWords[i])return!0;return!1}},{key:"IsWordWithoutVowel",value:function(t){t=e.TrimPunctuation(t).toUpperCase();for(var n=0;n<e.WordsWithNoVowels.length;n++)if(t===e.WordsWithNoVowels[n].toUpperCase())return!0;return!1}},{key:"ContainsFuncName",value:function(e){for(var t=0;t<En.FuncNames.length;t++){var n=En.FuncNames[t];if(e.includes(n))return!0}return!1}},{key:"HasVowel",value:function(e){return(e=e.toUpperCase()).includes("A")||e.includes("E")||e.includes("I")||e.includes("O")||e.includes("U")}},{key:"TrimPunctuation",value:function(e){return e.replace(/^\W+/g,"").replace(/\W+$/g,"")}},{key:"IsBaseType",value:function(e){switch(e){case"number":case"func":case"letter":case"paren":case"factorial":case"matrix":case"unit":case"chemElement":case"placeholder":return!0;default:return!1}}},{key:"GetHexForUnicode",value:function(e){for(var t="",n=0;n<e.length;n++)t+="&#x"+("000"+e.charCodeAt(n).toString(16)).substr(-4)+";";return t}}]),e}();(0,it.Z)(Nn,"UnicodeToHex",{"\xb0":"&#x00b0;","\u2032":"&#x2032;","\u2033":"&#x2033;","*":"&#x22c5;","\u03b1":"&#x03b1;","\u03b2":"&#x03b2;","\u03b3":"&#x03b3;","\u03b4":"&#x03b4;","\u03b5":"&#x03b5;","\u03b6":"&#x03b6;","\u03b7":"&#x03b7;","\u03b8":"&#x03b8;","\u03b9":"&#x03b9;","\u03ba":"&#x03ba;","\u03bb":"&#x03bb;","\u03bc":"&#x03bc;","\u03bd":"&#x03bd;","\u03be":"&#x03be;","\u03bf":"&#x03bf;","\u03c0":"&#x03c0;","\u03c1":"&#x03c1;","\u03c3":"&#x03c3;","\u03c4":"&#x03c4;","\u03c5":"&#x03c5;","\u03c6":"&#x03c6;","\u03c7":"&#x03c7;","\u03c8":"&#x03c8;","\u03c9":"&#x03c9;","\u2192":"&#x2192;","\xf7":"&#x00f7;","\u2264":"&#x2264;","\u2265":"&#x2265;","\u2260":"&#x2260;","<":"&#x003c;",">":"&#x003e;","&":"&#x0026;","\u222a":"&#x222a;","\u2229":"&#x2229;","\xb1":"&#x00b1;","\u222b":"&#x222b;","\u2211":"&#x2211;","\u2220":"&#x2220;","\u2299":"&#x2299;","\u25b3":"&#x25b3;","\u25a1":"&#x25a1;","\u2245":"&#x2245;","\u2225":"&#x2225;","\u27c2":"&#x27c2;"}),(0,it.Z)(Nn,"FunctionApplicationSymbol","&#x2061;"),(0,it.Z)(Nn,"IntegralSymbol","&#x222b;"),(0,it.Z)(Nn,"SummationSymbol","&#x2211;"),(0,it.Z)(Nn,"ZeroWidthNonBreakingSpace","&#xfeff;"),(0,it.Z)(Nn,"PlaceholderString",'<mo class="Placeholder">?</mo>'),(0,it.Z)(Nn,"NameToHex",{degree:"&#x00b0;",minute:"&#x2032;",second:"&#x2033;",mult:"&#x22c5;",alpha:"&#x03b1;",mu:"&#x03bc;",arrow:"&#x2192;",division:"&#x00f7;",lte:"&#x2264;",gte:"&#x2265;",ne:"&#x2260;",lt:"&#x003c;",gt:"&#x003e;",amp:"&#x0026;",union:"&#x222a;",inter:"&#x2229;",plusminus:"&#x00b1;",integral:"&#x222b;",summation:"&#x2211;"}),(0,it.Z)(Nn,"NonBreakingSpace","&#x00a0;"),(0,it.Z)(Nn,"TriggyWords",["second","tangent","seconds","costs","coterminal","single","cosine","sector","send","logarithmic","sent","section","since","sections","sentence","secant","logarithms","logarithm","senior","tangente","costing","cosecant","seniors","tanget","sinusoidal","cotangent","tanque","tangents","logaritmo","sentences","tanks","tanto","sentido","sending","sense","cosines","coseno","logistic","security","costara","sines","cotains","cotton","costos","costado","singers","costumes","costaba","secret","costume","secured","secound","sinus","seccion","senor","sectional","logaritmos","secounds","singing","senora","coterminales","tangency","sinking","sends","cotangente","cosiente","cosecante","singular","secuencia","coterminals","logic","logged"]),(0,it.Z)(Nn,"VeryTriggyWords",["cost","tank","sink","sing"]),(0,it.Z)(Nn,"WordsWithNoVowels",["by","my","cry","dry","fly","fry","glyph","gym","gyms","shy","try","why","sqrt","lcm","gcf","hcf","lcd","hmm","hmmm","hmmmm","btw","ty","np","Im","PC"]);var Zn,Hn,Ln,zn={Char:[["\u03b1","\\alpha","\ud835\udefc"],["\u03b2","\\beta","\ud835\udefd"],["\u03b3","\\gamma","\ud835\udefe"],["\u03b4","\\delta","\u0394","\ud835\udeff"],["\u03b5","\\epsi","\ud835\udf00"],["\u03b5","\\epsilon","\ud835\udf00"],["\u03b6","\\zeta","\ud835\udf01"],["\u03b7","\\eta","\ud835\udf02"],["\u03b8","\\theta","\u0398","\ud835\udf03"],["\u03b9","\\iota","\ud835\udf04"],["\u03ba","\\kappa","\ud835\udf05"],["\u03bb","\\lambda","\ud835\udf06"],["\u03bc","\\mu","\ud835\udf07"],["\u03bd","\\nu","\ud835\udf08"],["\u03be","\\xi","\ud835\udf09"],["\u03bf","\\omicron","\ud835\udf0a"],["\u03c0","\\pi","\u03a0","\ud835\udf0b"],["\u03c1","\\rho","\ud835\udf0c"],["\u03c3","\\sigma","\ud835\udf0e"],["\u03c4","\\tau","\ud835\udf0f"],["\u03c5","\\upsilon","\ud835\udf10"],["\u03c6","\\phi","\u03a6","\ud835\udf11"],["\u03c6","\\varphi","\u03a6","\ud835\udf11"],["\u03c7","\\chi","\ud835\udf12"],["\u03c8","\\psi","\ud835\udf13"],["\u03c9","\\omega","\ud835\udf14"],["\u0391","\\Alpha","\ud835\udee2"],["\u0392","\\Beta","\ud835\udee3"],["\u0393","\\Gamma","\ud835\udee4"],["\u0394","\\Delta","\ud835\udee5"],["\u0395","\\Epsilon","\ud835\udee6"],["\u0396","\\Zeta","\ud835\udee7"],["\u0397","\\Eta","\ud835\udee8"],["\u0398","\\Theta","\ud835\udee9"],["\u0399","\\Iota","\ud835\udeea"],["\u039a","\\Kappa","\ud835\udeeb"],["\u039b","\\Lambda","\ud835\udeec"],["\u039c","\\Mu","\ud835\udeed"],["\u039d","\\Nu","\ud835\udeee"],["\u039e","\\Xi","\ud835\udeef"],["\u039f","\\Omicron","\ud835\udef0"],["\u03a0","\\Pi","\ud835\udef1"],["\u03a1","\\Rho","\ud835\udef2"],["\u03a3","\\Sigma","\ud835\udef4"],["\u03a4","\\Tau","\ud835\udef5"],["\u03a5","\\Upsilon","\ud835\udef6"],["\u03a6","\\Phi","\ud835\udef7"],["\u03a7","\\Chi","\ud835\udef8"],["\u03a8","\\Psi","\ud835\udef9"],["\u03a9","\\Omega","\ud835\udefa"],["\u212b","\\angstrom"],["\u2192","->","\u21a6"],["\xb0","\\deg"],["x\u0304","\\bar{x}"],["x\u0304","\\bar (x)"],["\u0101","\\bar (a)"],["\u221e","\\infty"],["\u221e","\\oo"],["\u2220","\\angle"],["\u2299","\\geocircle"],["\u25b3","\\geotriangle"],["\u25a1","\\geoquad"],["\u2245","\\cong"],["\u2225","\\|"],["\u27c2","\\bot"],["a","a","\ud835\udc4e"],["b","b","\ud835\udc4f"],["c","c","\ud835\udc50"],["d","d","\ud835\udc51"],["e","e","\ud835\udc52"],["f","f","\ud835\udc53","\u0192"],["g","g","\ud835\udc54"],["h","h","\u210e"],["i","i","\ud835\udc56"],["j","j","\ud835\udc57"],["k","k","\ud835\udc58"],["l","l","\ud835\udc59","\u2113"],["m","m","\ud835\udc5a"],["n","n","\ud835\udc5b"],["o","o","\ud835\udc5c"],["p","p","\ud835\udc5d"],["q","q","\ud835\udc5e"],["r","r","\ud835\udc5f"],["s","s","\ud835\udc60"],["t","t","\ud835\udc61"],["u","u","\ud835\udc62"],["v","v","\ud835\udc63"],["w","w","\ud835\udc64"],["x","x","\ud835\udc65"],["y","y","\ud835\udc66"],["z","z","\ud835\udc67"]],Oper:[["\xd7","\\times"],["\u2264","<="],["\u2265",">="],["\u2260","!="],["\xf7","-:"],["\xb1","\\pm"],["\u222a","\\cup"],["\u2229","\\cap"],["-","-","\u2010","\u2011","\u2012","\u2013","\u2014","\u2212","\u23af"],["+","+","\u2064"],["/","/","\\","\u2044"],["*","*","\u2022","\u2062","\xb7","\u22c5","\u2219","\u2217"],["|","|","\u2223"],[",",",","\u201a"]],Root:["\\root",["\\sqrt","\u221a"]],Trig:["arcsinh","arccosh","arccsch","arcsech","arctanh","arccoth","sin","sinh","arcsin","cos","cosh","arccos","tan","tanh","arctan","cot","coth","arccot","sec","sech","arcsec","csc","csch","arccsc"],Func:["log","ln"],TrigLog:["\\sin","\\sinh","\\arcsin","\\cos","\\cosh","\\arccos","\\tan","\\tanh","\\arctan","\\cot","\\coth","\\arccot","\\sec","\\sech","\\arcsec","\\csc","\\csch","\\arccsc","\\log","\\ln"],Lim:["\\lim"],Smiley:[":-)",":-(",";-)",":)",":(",";)",";("],Shape:[["&#xF127;","\\rectangle"],["&#xF126;","\\circle"],["&#xF130;","\\triangle"],["&#xF128;","\\parallelogram"],["&#xF129;","\\trapezoid"],["&#xF131;","\\box"],["&#xF135;","\\sphere"],["&#xF132;","\\cone"],["&#xF133;","\\cylinder"],["&#xF134;","\\pyramid"],["&#xF140;","\\tri"]],PermComb:["\\Perm","\\Comb"],Int:[["\\int"]],Sum:[["\\sum"]],Table:["\\table","\\shapeTable","\\triTable"],EquationTable:["\\equationTable"],NewLine:[[bt,"\n","\r\n","\n\r","\\n"]],PiecewiseClose:[":}"],Accent:["\\overline","\\overrightarrow","\\overleftrightarrow","\\overfrown"],Space:[[" "," ","\u200b","\u200a","\u2009","\xa0","\u2003"]],OpenParen:[["(","(","\u3016","\u2329","\u27e8"]],CloseParen:[[")",")","\u3017","\u232a","\u27e9"]]},Rn=zn.Char.concat(zn.Oper).concat(zn.Shape),Dn=(Zn={},(0,it.Z)(Zn,We.Accent,(function(e,t){return e.accent})),(0,it.Z)(Zn,We.Character,(function(e,t){var n=jn(e);return t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Fraction,(function(e,t){var n="\\{frac}".concat(Un(e.numerator,t),"\\>").concat(Un(e.denominator,t),"\\>");return t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Head,(function(e,t){for(var n=t===e?"\\|":"",r=e.next;r&&r!==e;r=r.next)n+=Un(r,t);return n})),(0,it.Z)(Zn,We.Integral,(function(e,t){var n="\\{int}";return(tn(e.lowerBound)||tn(e.upperBound))&&(n+="\\<\\<",n+=Un(e.lowerBound,t),n+="\\>",n+=Un(e.upperBound,t),n+="\\>"),t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Limit,(function(e,t){for(var n="\\{lim}",r="",i=!1,a="",o=e.contents.next;o&&o!==e.contents;o=o.next)if(i||o.type!==We.Character||"\u2192"!==o.value){var s=Un(o,t);i?a+=s:r+=s}else i=!0,t===o&&(a+="\\|");return n+=r+"\\>"+a+"\\>",t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Matrix,(function(e,t){return"\\{matrix}"})),(0,it.Z)(Zn,We.PermComb,(function(e,t){var n="P"===e.letter?"\\{perm}":"\\{comb}";return n+=Un(e.left,t),n+="\\>",n+=Un(e.right,t),n+="\\>",t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Piecewise,(function(e,t){return"\\{piecewise}"})),(0,it.Z)(Zn,We.Placeholder,(function(e,t){return t===e?"\\|":""})),(0,it.Z)(Zn,We.Radical,(function(e,t){var n="\\{rad}";return tn(e.index)&&(n+="\\<",n+=Un(e.index,t),n+="\\>"),n+=Un(e.radicand,t),n+="\\>",t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.ShapeTable,(function(e,t){return"\\{shapetable}"})),(0,it.Z)(Zn,We.Subscript,(function(e,t){var n="_";return n+=Un(e.contents,t),n+="\\>",t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Summation,(function(e,t){var n="\\{sum}";return(tn(e.lowerBound)||tn(e.upperBound))&&(n+="\\<\\<",n+=Un(e.lowerBound,t),n+="\\>",n+=Un(e.upperBound,t),n+="\\>"),t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Superscript,(function(e,t){var n="^";return n+=Un(e.contents,t),n+="\\>",t===e&&(n+="\\|"),n})),(0,it.Z)(Zn,We.Table,(function(e,t){return"\\{table}"})),(0,it.Z)(Zn,We.EquationTable,(function(e,t){return"".concat(e.label,"\\{equationTable}")})),(0,it.Z)(Zn,We.TrigLog,(function(e,t){var n=e.value;return t===e&&(n+="\\|"),n})),Zn);function Un(e,t){switch(e.type){case We.Accent:case We.Character:case We.Fraction:case We.Head:case We.Integral:case We.Limit:case We.Matrix:case We.PermComb:case We.Piecewise:case We.Placeholder:case We.Radical:case We.ShapeTable:case We.Subscript:case We.Summation:case We.Superscript:case We.Table:case We.EquationTable:case We.TrigLog:return Dn[e.type](e,t)}}var Bn=!1,Fn=(Hn={},(0,it.Z)(Hn,We.Accent,(function(e){return"".concat(e.accent,"{").concat(jn(e.contents),"}")})),(0,it.Z)(Hn,We.Character,(function(e){for(var t=0;t<Rn.length;t++)if(e.value===Rn[t][0]){var n=Rn[t][1];return n.startsWith("\\")&&(n+=" "),n}return e.value===bt?zn.NewLine[0][1]:e.value})),(0,it.Z)(Hn,We.Fraction,(function(e){return"(".concat(jn(e.numerator),")/(").concat(jn(e.denominator),")")})),(0,it.Z)(Hn,We.Head,(function(e){for(var t=e,n="",r=e.next;r!==t&&r&&r.type!==We.Head;){var i,a,o;!0===r.math&&!1===Bn&&(n+='<code class="asciimath">',Bn=!0),n+=jn(r),!0!==r.math||null!==(i=r)&&void 0!==i&&i.next&&!1!==(null===(a=r)||void 0===a||null===(o=a.next)||void 0===o?void 0:o.math)||!0!==Bn||(n+="</code>",Bn=!1),r=r.next}return n})),(0,it.Z)(Hn,We.Integral,(function(e){var t="",n="";return tn(e.lowerBound)&&((t=jn(e.lowerBound)).length>1&&(t="("+t+")"),t="_"+t),tn(e.upperBound)&&((n=jn(e.upperBound)).length>1&&(n="("+n+")"),n="^"+n),"\\int"+t+n+" "})),(0,it.Z)(Hn,We.Limit,(function(e){return"\\lim_(".concat(jn(e.contents),")")})),(0,it.Z)(Hn,We.Matrix,(function(e){for(var t="[",n=0;n<e.numRows;n++){0!==n&&(t+=","),t+="[";for(var r=0;r<e.numCols;r++){0!==r&&(t+=",");var i=jn(e.children[n*e.numCols+r]);-1!==i.indexOf(",")&&(i="("+i+")"),t+=i}t+="]"}return t+="]"})),(0,it.Z)(Hn,We.PermComb,(function(e){return"\\".concat("P"===e.letter?"Perm":"Comb","{").concat(jn(e.left),"}{").concat(jn(e.right),"}")})),(0,it.Z)(Hn,We.Piecewise,(function(e){for(var t="{",n=0;n<e.children.length;n++)0!==n&&(t+=","),t+="("+jn(e.children[n])+")";return t+=":}"})),(0,it.Z)(Hn,We.Placeholder,(function(e){return""})),(0,it.Z)(Hn,We.Radical,(function(e){var t=jn(e.radicand),n="";return tn(e.index)?n+="\\root("+jn(e.index)+")(":n+="\\sqrt(",n+t+")"})),(0,it.Z)(Hn,We.ShapeTable,(function(e){for(var t=[],n=0;n<e.labels.length;n++){var r=jn(e.children[n]);-1!==r.indexOf(",")&&(r="("+r+")"),t.push("["+jn(e.labels[n])+","+r+"]")}var i="shape";return e.shapeType===mt&&(i="tri"),"\\"+i+"Table["+t.join(",")+"]"})),(0,it.Z)(Hn,We.Subscript,(function(e){return"_(".concat(jn(e.contents),")")})),(0,it.Z)(Hn,We.Summation,(function(e){var t="",n="";return tn(e.lowerBound)&&((t=jn(e.lowerBound)).length>1&&(t="("+t+")"),t="_"+t),tn(e.upperBound)&&((n=jn(e.upperBound)).length>1&&(n="("+n+")"),n="^"+n),"\\sum"+t+n+" "})),(0,it.Z)(Hn,We.Superscript,(function(e){return"^(".concat(jn(e.contents),")")})),(0,it.Z)(Hn,We.Table,(function(e){for(var t="\\table[",n=0;n<e.children.length;n++){var r=jn(e.children[n]);-1!==r.indexOf(",")&&(r="("+r+")"),n%2===0?t+="["+r:(t+=","+r+"]",n!==e.children.length-1&&(t+=","))}return t+="]"})),(0,it.Z)(Hn,We.EquationTable,(function(e){for(var t=[],n=0;n<e.variables.length;n++){var r=jn(e.variables[n]),i=jn(e.children[n]);t.push("["+r+","+i+"]")}var a="["+t.join(",")+"]",o=jn(e.equation);return e.label+"\\equationTable {"+o+"}"+a})),(0,it.Z)(Hn,We.TrigLog,(function(e){return"\\".concat(e.value," ")})),Hn);function jn(e){switch(e.type){case We.Accent:case We.Character:case We.Fraction:case We.Head:case We.Integral:case We.Limit:case We.Matrix:case We.PermComb:case We.Piecewise:case We.Placeholder:case We.Radical:case We.ShapeTable:case We.Subscript:case We.Summation:case We.Superscript:case We.Table:case We.EquationTable:case We.TrigLog:return Fn[e.type](e)}}var qn=(Ln={},(0,it.Z)(Ln,We.Accent,(function(e){return"".concat(e.accent,"[").concat(Wn(e.contents),"]")})),(0,it.Z)(Ln,We.Character,(function(e){return e.value===bt?"\\n":e.value})),(0,it.Z)(Ln,We.Fraction,(function(e){return"frac[".concat(Wn(e.numerator),",").concat(Wn(e.denominator),"]")})),(0,it.Z)(Ln,We.Head,(function(e){for(var t=e.next,n=[];t&&t!==e;)n.push(Wn(t)),t=t.next;return"["+n.join(",")+"]"})),(0,it.Z)(Ln,We.Integral,(function(e){return"int[".concat(Wn(e.lowerBound),",").concat(Wn(e.upperBound),"]")})),(0,it.Z)(Ln,We.Limit,(function(e){return"lim[".concat(Wn(e.contents),"]")})),(0,it.Z)(Ln,We.Matrix,(function(e){for(var t=[],n="matrix[",r=0;r<e.numRows;r++){for(var i=[],a=0;a<e.numCols;a++)i.push(Wn(e.children[r*e.numCols+a]));t.push("["+i.join(",")+"]")}return n+=t.join(",")+"]"})),(0,it.Z)(Ln,We.PermComb,(function(e){return"".concat(e.letter,"[").concat(Wn(e.left),",").concat(Wn(e.right),"]")})),(0,it.Z)(Ln,We.Piecewise,(function(e){for(var t="piecewise[",n=[],r=0;r<e.children.length;r++)n.push(Wn(e.children[r]));return t+=n.join(",")+"]"})),(0,it.Z)(Ln,We.Placeholder,(function(e){return"?"})),(0,it.Z)(Ln,We.Radical,(function(e){return"rad[".concat(Wn(e.index),",").concat(Wn(e.radicand),"]")})),(0,it.Z)(Ln,We.ShapeTable,(function(e){for(var t="shapetable[",n=[],r=0;r<e.labels.length;r++)n.push("["+Wn(e.labels[r])+","+Wn(e.children[r])+"]");return t+=n.join(",")+"]"})),(0,it.Z)(Ln,We.Subscript,(function(e){return"[_".concat(Wn(e.contents),"]")})),(0,it.Z)(Ln,We.Summation,(function(e){return"sum[".concat(Wn(e.lowerBound),",").concat(Wn(e.upperBound),"]")})),(0,it.Z)(Ln,We.Superscript,(function(e){return"[^".concat(Wn(e.contents),"]")})),(0,it.Z)(Ln,We.Table,(function(e){for(var t=[],n="table[",r=0;r<e.children.length;r+=2)t.push("["+Wn(e.children[r])+","+Wn(e.children[r+1])+"]");return n+=t.join(",")+"]"})),(0,it.Z)(Ln,We.EquationTable,(function(e){return"equationTable"})),(0,it.Z)(Ln,We.TrigLog,(function(e){return e.value})),Ln);function Wn(e){switch(null===e||void 0===e?void 0:e.type){case We.Accent:case We.Character:case We.Fraction:case We.Head:case We.Integral:case We.Limit:case We.Matrix:case We.PermComb:case We.Piecewise:case We.Placeholder:case We.Radical:case We.ShapeTable:case We.Subscript:case We.Summation:case We.Superscript:case We.Table:case We.EquationTable:case We.TrigLog:return qn[e.type](e)}}var Gn,Kn,Vn,Qn,$n,Xn,Yn={syllabus:"professor content",quiz:"professor content",exam_study_guide:"professor content",lecture_notes:"professor content",exams:"professor content",case_studies:"professor content",lab_notes:"professor content",other:"professor content",textbooks:"textbooks",study:"study",capp:"capp",decks:"decks",learn:"learn",videos:"videos"},Jn=function(e){var t;return e&&null!==(t=Yn[e])&&void 0!==t?t:null},er=function(e){var t="",n=0,r=0;return e.map((function(e){var i=e.type,a=e.subType,o=e.questionId,s="recent searches"===i;return s||(r++,t!==i&&(t=i,n++)),{search_result_id:o,search_result_rank:s?null:r,search_result_type:i||"suggestions",search_result_module_rank:s?null:n,search_result_module_name:Jn(a),search_result_rank_in_module:r,search_result_sub_type:a,is_search_result_cached:!!a||null,search_result_category_exists:null}}))},tr=n(50669),nr=n(59195),rr=(0,nr.ZP)(Gn||(Gn=(0,tr.Z)(["\n  query SearchTypeaheadQuestions($input: SearchTypeaheadInput!) {\n    searchTypeaheadQuestions(searchTypeaheadInput: $input) {\n      questionBody\n      questionPointer\n      questionHighlight\n    }\n  }\n"])));!function(e){e.COULD_NOT_UPLOAD_IMAGE="CouldNotUploadImage",e.COULD_NOT_TRANSCRIBE_IMAGE="CouldNotTranscribeImage",e.COULD_NOT_SEARCH_QUESTION="CouldNotSearchQuestion",e.FILE_SIZE_EXCEEDS_LIMIT="FileSizeExceedsLimit",e.TOO_MANY_FILES_UPLOADED="TooManyFilesUploaded",e.INVALID_FILE_UPLOADED="InvalidFileUploaded",e.UNKNOWN_ERROR="UnknownError",e.SIGHT_API_DOWN="SightApiDown"}(Vn||(Vn={})),function(e){e.COULD_NOT_ROTATE_IMAGE="CouldNotRotateImage",e.SERVER_TIMEDOUT="ServerTimedOut"}(Qn||(Qn={})),function(e){e[e.FAILED_UPLOAD=1001]="FAILED_UPLOAD",e[e.FAILED_TRANSCRIPTION=1002]="FAILED_TRANSCRIPTION",e[e.FAILED_SEARCH=1003]="FAILED_SEARCH",e[e.FAILED_TYPEAHEAD=1004]="FAILED_TYPEAHEAD",e[e.FILE_SIZE_EXCEEDED=1005]="FILE_SIZE_EXCEEDED",e[e.NUMBER_OF_FILES_EXCEEDED=1006]="NUMBER_OF_FILES_EXCEEDED",e[e.INVALID_FILE=1007]="INVALID_FILE",e[e.FAILED_ISBN_SEARCH=1008]="FAILED_ISBN_SEARCH",e[e.UNKNOWN_ERROR=1]="UNKNOWN_ERROR",e[e.COULD_NOT_ROTATE_IMAGE=2001]="COULD_NOT_ROTATE_IMAGE",e[e.MEDIA_API_FAILURE=2002]="MEDIA_API_FAILURE",e[e.SIGHT_API_FAILURE=2003]="SIGHT_API_FAILURE",e[e.CHAR_LIMIT_EXCEEDED=2004]="CHAR_LIMIT_EXCEEDED",e[e.SERVER_TIMEDOUT=2005]="SERVER_TIMEDOUT",e[e.COULD_NOT_RESTORE_UIC_STATE=2006]="COULD_NOT_RESTORE_UIC_STATE"}($n||($n={})),function(e){e.OCR_UPLOAD_IMAGE="OcrFileExplorer",e.OCR_DRAG_AND_DROP="OcrDragAndDrop",e.OCR_IMAGE_CROPPER="OcrImageCropper",e.OCR_MEDIA_API="OcrMediaAPI",e.OCR_SIGHT_API="OcrSightAPI",e.UIC_SUBMIT="UicSubmit",e.UIC_EDITOR="UicEditor"}(Xn||(Xn={}));var ir=(Kn={},(0,it.Z)(Kn,Vn.COULD_NOT_UPLOAD_IMAGE,{title:"Failed to upload image for OCR",message:"Try uploading a different image or try again later.",code:$n.FAILED_UPLOAD}),(0,it.Z)(Kn,Vn.SIGHT_API_DOWN,{title:"Failed to get transcription",message:"Try uploading a different image or try again later.",code:$n.FAILED_UPLOAD}),(0,it.Z)(Kn,Vn.COULD_NOT_TRANSCRIBE_IMAGE,{title:"We couldn't find your question",message:"Would you still like to upload your image? You'll have to enter text manually in order to submit your question.",code:$n.FAILED_TRANSCRIPTION}),(0,it.Z)(Kn,Vn.COULD_NOT_SEARCH_QUESTION,{title:"Something went wrong",message:"We were unable to search the archive. You can still submit your question to experts.",code:$n.FAILED_SEARCH}),(0,it.Z)(Kn,Vn.FILE_SIZE_EXCEEDS_LIMIT,{title:"Please use a smaller image",message:"Images must be under ".concat(Ae/Math.pow(1024,2),"MB"),code:$n.FILE_SIZE_EXCEEDED}),(0,it.Z)(Kn,Vn.TOO_MANY_FILES_UPLOADED,{title:"Please upload a single file only",message:"We only support transcribing one image at a time.",code:$n.NUMBER_OF_FILES_EXCEEDED}),(0,it.Z)(Kn,Vn.INVALID_FILE_UPLOADED,{title:"Invalid or unsupported file",message:"Valid file formats: ".concat(Pe.join(", "),"."),code:$n.INVALID_FILE}),(0,it.Z)(Kn,Vn.UNKNOWN_ERROR,{title:"Unkown Error",message:"An unknown error occurred. Please try after some time.",code:$n.UNKNOWN_ERROR}),Kn);function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function or(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){(0,it.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sr=Object.freeze({REQUEST_FAILED:"Search typeahead request failed: "}),lr=function(e,t,n){var r=(0,l.useRouter)(),i=(0,c.useState)(""),o=(0,a.Z)(i,2),s=o[0],d=o[1];return(0,c.useEffect)((function(){r&&r.pathname&&d(r.pathname)}),[]),(0,u.useLazyQuery)(rr,{ssr:!1,errorPolicy:"all",fetchPolicy:"no-cache",context:(0,it.Z)({headers:or((0,it.Z)({},He,t?"TypeAhead-".concat(t):He),n?(0,it.Z)({},"chegg-search-id",n):null)},ze,!0),variables:e,onError:function(e){return(0,y.O7)({error:new Error("".concat($n.FAILED_TYPEAHEAD).concat(sr.REQUEST_FAILED,":TypeAhead Failed")),location:qe.SEARCH_QUERY,severity:y.zb.ERROR},{initialError:e.message,source:"".concat(s)})}})},cr=n(97032),ur=(0,cr.QS)({typeaheadSearchResults:void 0});function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){(0,it.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pr=function(e,t,n,r,i,o){e=xe(e),e=(0,b.Lm)(e);var s={input:{searchTypeaheadQuery:"<div>".concat(e,"<div>"),searchTypeaheadResultSize:5,questionHighlightSnippetSize:5}},l=(0,c.useState)([]),u=(0,a.Z)(l,2),d=u[0],h=u[1],p=lr(s),m=(0,a.Z)(p,2),v=m[0],f=m[1].data;(0,c.useEffect)((function(){var a=null===f||void 0===f?void 0:f.searchTypeaheadQuestions;if(a){var s=function(t){return t.map((function(t){return{questionId:t.questionPointer,value:t.questionBody,child:c.createElement(b.rP,{suggestion:"".concat(t.questionHighlight.length?t.questionHighlight.join("..."):t.questionBody),query:e})}}))}(a);if(s&&s.length>=5&&(s=s.slice(0,5)),h(s),s.length>0){var l=er(s);ur({typeaheadSearchResults:l}),Xe({type:P.SEARCH_QUERY,data:{search_track_id:r||void 0,search_strack_id:n||void 0,search_id:t||void 0,search_type:C.TYPEAHEAD,search_profile:S.BIGEGG_SUGGEST,search_term:e,search_auto_type:Ce(e,i,o),search_page_number:l.length>0?1:0,search_page_size:l.length>0?5:0,search_match_count:s.length,search_intent:E.STUDY,search_results:l.length>0?l:void 0},eventVersion:4})}}}),[f]);var g=(0,c.useRef)();(0,c.useEffect)((function(){return g.current=!0,function(){g.current=!1}}),[]),(0,c.useEffect)((function(){y(e)}),[e]);var y=(0,c.useCallback)((0,ct.Z)((function(e){g.current&&((0,b.RT)(e)?(e=(0,b.Lm)(e),v({variables:{input:hr(hr({},s.input),{},{searchTypeaheadQuery:"<div>".concat(e,"<div>")})}})):h([]))}),500),[]);return d},mr=n(96535),vr=n(31542),fr=["bannerStyle","id","message","title","key","type","size"],gr=function(e){var t=e.bannerStyle,n=e.id,r=e.message,i=e.title,a=e.key,o=e.type,s=e.size,l=(0,mr.Z)(e,fr);return"small"===s?c.createElement(lt.wn,(0,rt.Z)({},l,{bannerStyle:t,id:n,key:a,message:r,type:o})):c.createElement(lt.Zl,(0,rt.Z)({},l,{bannerStyle:t,id:n,key:a,message:r,title:i,type:o}))},yr=gr,br="notification_id",xr=n(42215),Cr=et.ZP.div.withConfig({componentId:"sc-6nwsa0-0"})(["bottom:",";position:fixed;right:",";z-index:",";@media only screen and (min-width:",") and (max-width:","){bottom:240px;}> *:not(:first-child){}"],(function(e){return e.theme.cuiTheme.spacing.xl9}),(function(e){return e.theme.cuiTheme.spacing.xl}),xr.Z.sledgehammer,(function(e){return e.theme.cuiTheme.breakpoints.sm.min}),(function(e){return e.theme.cuiTheme.breakpoints.sm.max})),Er=["key","onCloseClick"],Sr=(0,c.createContext)({notifications:null,setNotifications:function(){}}),Ir=function(){var e=(0,c.useContext)(Sr),t=e.notifications,n=e.setNotifications;(0,c.useEffect)((function(){if(null!==t&&void 0!==t&&t.some((function(e){return!Boolean(e.timerOptOut)}))){var e=setTimeout((function(){n(null)}),5e3);return function(){clearTimeout(e)}}}),[t]);var r=x.Ax&&document.querySelector("#__next");return!r&&t&&(0,y.O7)({error:new Error("window is not defined"),location:"NotificationsController",severity:y.zb.ERROR},{teamName:Me.GARUDA}),r&&null!==t&&void 0!==t&&t.length?vr.createPortal(c.createElement(Cr,{"aria-live":"polite",role:"alert"},t.slice(0,2).map((function(e,r){var i=e.key,a=e.onCloseClick,o=(0,mr.Z)(e,Er);return c.createElement(yr,(0,rt.Z)({},o,{bannerStyle:"toast",id:"".concat(br,"-").concat(r),key:i||"".concat(br,"-").concat(r),onCloseClick:a?function(){var e=t.findIndex((function(e){return e.key===i}));n([].concat((0,at.Z)(t.slice(0,e)),(0,at.Z)(t.slice(e+1)))),a()}:void 0}))}))),r):null},kr=Ir,wr=function(e){var t=e.allowedFileTypes,n=void 0===t?Pe:t,r=e.maxFileSize,i=void 0===r?Ae:r,o=e.onDragEnter,s=e.onDragLeave,l=e.onDragOver,u=e.onDrop,d=e.sideBottomErrors,h=d.tooManyFilesUploaded,p=d.fileSizeExceedsLimit,m=d.invalidFileUploaded,v=(0,c.useState)(!1),f=(0,a.Z)(v,2),g=f[0],b=f[1],x=(0,c.useState)(!1),C=(0,a.Z)(x,2),E=C[0],S=C[1],I=(0,c.useContext)(Sr),k=I.notifications,T=I.setNotifications;(0,c.useEffect)((function(){var e=function(e){e.preventDefault(),b(!0)},t=function(e){e.preventDefault()},n=function(e){e.preventDefault(),(0===e.screenX||0===e.screenY)&&b(!1)},r=function(e){e.preventDefault(),b(!1)};return window.addEventListener("dragenter",e),window.addEventListener("dragover",t),window.addEventListener("dragleave",n),window.addEventListener("drop",r),function(){window.removeEventListener("dragenter",e),window.removeEventListener("dragover",t),window.removeEventListener("dragleave",n),window.removeEventListener("drop",r)}}),[]);return{isInTarget:E,isInWindow:g,handleDragEnter:function(e){e.preventDefault(),e.stopPropagation(),S(!0),null===o||void 0===o||o(e)},handleDragLeave:function(e){e.preventDefault(),e.stopPropagation(),S(!1),null===s||void 0===s||s(e)},handleDragOver:function(e){e.preventDefault(),e.stopPropagation(),null===l||void 0===l||l(e)},handleDrop:function(e){e.preventDefault();var t,r,a=e.dataTransfer.files;if(a.length){if(a.length>1)return(0,y.O7)({error:"".concat(ir.TooManyFilesUploaded.code,": More than one file was uploaded for transcription"),location:Xn.OCR_DRAG_AND_DROP,severity:y.zb.WARNING},{teamName:Me.GARUDA}),T([].concat((0,at.Z)(null!==k&&void 0!==k?k:[]),[{message:h.message,onCloseClick:function(){},title:h.title,type:lt.j_.Error}])),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:R,message_detail:ir.TooManyFilesUploaded.message}},eventVersion:3}),b(!1),void S(!1);var o=a[0];if(!n.includes(o.type))return r=o.type,(0,y.O7)({error:"".concat(ir.InvalidFileUploaded.code,": An invalid/ unsupported file was uploaded."),location:Xn.OCR_DRAG_AND_DROP,severity:y.zb.ERROR},{uploadedFileType:"(".concat(r," != ").concat(Pe,")"),teamName:Me.GARUDA}),T([].concat((0,at.Z)(null!==k&&void 0!==k?k:[]),[{message:m.message,onCloseClick:function(){},title:m.title,type:lt.j_.Error}])),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:R,message_detail:ir.InvalidFileUploaded.title}},eventVersion:3}),b(!1),void S(!1);if(o.size>i)return t=o.size,(0,y.O7)({error:"".concat(ir.FileSizeExceedsLimit.code,": Uploaded file exceeded max file-size limit."),location:Xn.OCR_DRAG_AND_DROP,severity:y.zb.WARNING},{uploadedFileSize:"(".concat(t," > ").concat(Ae,")"),teamName:Me.GARUDA}),T([].concat((0,at.Z)(null!==k&&void 0!==k?k:[]),[{message:p.message,onCloseClick:function(){},title:p.title,type:lt.j_.Error}])),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:R,message_detail:ir.FileSizeExceedsLimit.message}},eventVersion:3}),b(!1),void S(!1);u(o),b(!1),S(!1)}}}},Tr="click";var Mr,Pr,Ar=function(e,t){var n=function(e){return!!e&&"function"!==typeof e&&!!e.current}(e)?e.current:null;c.useEffect((function(){if(e){var r=function(e){null!==n&&void 0!==n&&n.contains(e.target)||t(e)};return document.addEventListener(Tr,r),function(){document.removeEventListener(Tr,r)}}}),[t,e,n])};!function(e){e.Loading="loading",e.Error="error",e.Ok="ok",e.NotCalled="not-called",e.ApiDown="api-down",e.NetworkError="network-error"}(Mr||(Mr={}));var _r,Or=(0,nr.ZP)(Pr||(Pr=(0,tr.Z)(["\n  query OCRAnalyze($imageUrl: String!) {\n    ocrAnalyze(imageUrl: $imageUrl) {\n      rawHtml\n      transcriptionText\n      transcriptionHtml\n      confidence\n    }\n  }\n"])));!function(e){e.CouldNotTranscribe="COULD_NOT_TRANSCRIBE",e.ApiDown="API_DOWN"}(_r||(_r={}));var Nr,Zr=function(e){var t=(0,u.useLazyQuery)(Or,{errorPolicy:ge.ALL,fetchPolicy:fe.NO_CACHE,context:(0,it.Z)({headers:(0,it.Z)({},He,e?"UIC-".concat(e):Le)},ze,!0)}),n=(0,a.Z)(t,2),r=n[0],i=n[1],o=i.called,s=i.data,l=i.loading,c=i.error,d=function(e){r({variables:{imageUrl:null!==e&&void 0!==e?e:""}})};if(c){if(c.networkError||c.message&&/^50[0-4]\b/.test(c.message))return{fetch:d,metadata:{code:_r.ApiDown},status:Mr.ApiDown}}if(l)return{status:Mr.Loading};if(!o)return{fetch:d,status:Mr.NotCalled};var h=null===s||void 0===s?void 0:s.ocrAnalyze.transcriptionText,p=null===s||void 0===s?void 0:s.ocrAnalyze.rawHtml,m=null===s||void 0===s?void 0:s.ocrAnalyze.transcriptionHtml,v=null===s||void 0===s?void 0:s.ocrAnalyze.confidence;return h?{data:{transcriptionText:h,rawHtml:p,transcriptionHtml:m,confidence:v},fetch:d,status:Mr.Ok}:{fetch:d,metadata:{code:_r.CouldNotTranscribe},status:Mr.Error}},Hr=function(){function e(){(0,dt.Z)(this,e)}return(0,ut.Z)(e,null,[{key:"GetNewId",value:function(){var t=e._id;return e._id++,"EditorElement_".concat(t)}}]),e}();function Lr(e,t){var n={type:We.Accent,contents:Dr(void 0,e,!0),accent:t,math:!0};return n.next=n,n.prev=n,n.contents.parent=n,n.id=Hr.GetNewId(),n}function zr(e,t,n){var r={type:We.Character,next:void 0,prev:void 0,value:e,grey:null!==t&&void 0!==t&&t,math:null!==n&&void 0!==n&&n};return r.next=r,r.prev=r,r.id=Hr.GetNewId(),r}function Rr(e,t){var n={type:We.Fraction,numerator:Dr(void 0,e,!0),denominator:Dr(void 0,t,!0),math:!0};return n.numerator.parent=n,n.denominator.parent=n,n.next=n,n.prev=n,n.id=Hr.GetNewId(),n}function Dr(e,t,n){if(void 0===t&&(t=[]),"string"===typeof t&&(t=[t]),Array.isArray(t)){var r={type:We.Head,next:void 0,prev:void 0,parent:e,math:null!==n&&void 0!==n&&n};r.next=r,r.prev=r;for(var i=0;i<t.length;i++){var a=t[i];"string"===typeof a&&(a=zr(a,void 0,n)),Dt(r,a)}return r.id=Hr.GetNewId(),r}return t}function Ur(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={type:We.Integral,lowerBound:Dr(void 0,e,!0),upperBound:Dr(void 0,t,!0),placeholders:n,math:!0};return r.lowerBound.parent=r,r.upperBound.parent=r,r.next=r,r.prev=r,r.id=Hr.GetNewId(),r}function Br(e){var t={type:We.Limit,contents:Dr(void 0,e,!0),math:!0};return t.contents.parent=t,t.next=t,t.prev=t,t.id=Hr.GetNewId(),t}function Fr(e,t){var n={type:We.Matrix,children:[],numRows:e,numCols:t,math:!0};n.next=n,n.prev=n,n.id=Hr.GetNewId();for(var r=0;r<e;r++)for(var i=0;i<t;i++)n.children.push(Dr(n,void 0,!0));return n}function jr(e,t,n){var r={type:We.PermComb,letter:e,left:Dr(void 0,t,!0),right:Dr(void 0,n,!0),math:!0};return r.left.parent=r,r.right.parent=r,r.next=r,r.prev=r,r.id=Hr.GetNewId(),r}function qr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t={type:We.Piecewise,children:[],math:!0};t.next=t,t.prev=t,t.id=Hr.GetNewId();for(var n=0;n<e;n++)t.children.push(Dr(t,void 0,!0));return t}function Wr(){var e={type:We.Placeholder,math:!0};return e.next=e,e.prev=e,e.id=Hr.GetNewId(),e}function Gr(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={type:We.Radical,index:Dr(void 0,e,!0),radicand:Dr(void 0,t,!0),placeholders:n,hungry:!1,math:!0};return r.index.parent=r,r.radicand.parent=r,r.next=r,r.prev=r,r.id=Hr.GetNewId(),r}function Kr(e){var t={type:We.ShapeTable,shapeType:e?fn(e):null,labels:[],children:[],math:!0};if(t.next=t,t.prev=t,t.id=Hr.GetNewId(),t.shapeType)for(var n=0;n<t.shapeType.labels.length;n++){var r=t.shapeType.labels[n];0!==n&&1!==n||t.shapeType!==pt||(r[1]=Vr(Dr(void 0,[""+(n+1)],!0))),t.labels.push(Dr(t,r,!0)),t.children.push(Dr(t,void 0,!0))}return t}function Vr(e){var t={type:We.Subscript,contents:Dr(void 0,e,!0),math:!0};return t.contents.parent=t,t.next=t,t.prev=t,t.id=Hr.GetNewId(),t}function Qr(e,t){var n={type:We.Summation,lowerBound:Dr(void 0,e,!0),upperBound:Dr(void 0,t,!0),placeholders:!0,math:!0};return n.lowerBound.parent=n,n.upperBound.parent=n,n.next=n,n.prev=n,n.id=Hr.GetNewId(),n}function $r(e){var t={type:We.Superscript,contents:Dr(void 0,e,!0),math:!0};return t.contents.parent=t,t.next=t,t.prev=t,t.id=Hr.GetNewId(),t}function Xr(e,t){var n={type:We.Table,children:[],math:!0};n.next=n,n.prev=n,n.id=Hr.GetNewId(),e&&(e=Dr(n,e,!0),n.children.push(e),e.parent=n),t&&(t=Dr(n,t,!0),n.children.push(t),t.parent=n);for(var r=0;r<6;r++)n.children.push(Dr(n,void 0,!0));return n}function Yr(e,t,n,r){var i={type:We.EquationTable,equation:e,variables:t,summaries:n,children:[],label:"Fill in the given values you have, and we'll solve for the missing variable.",math:!0};i.equation.parent=i;for(var a=0;a<r.length;a++)i.variables[a].parent=i,i.children.push(r[a]),i.children[a].parent=i;return i}function Jr(e){var t={type:We.TrigLog,value:e,math:!0};return t.next=t,t.prev=t,t.id=Hr.GetNewId(),t}function ei(e,t){for(var n,r=[],i=(0,at.Z)(t),a=e.next;a&&a.type!==We.Head;){var o=ti(a,i);r.push(o.node),i=o.mappedNodes,a=a.next}var s=Dr(void 0,r,null===(n=a)||void 0===n?void 0:n.math);return{node:s,mappedNodes:t.map((function(t,n){return t===e?s:i[n]}))}}function ti(e,t){var n,r=(0,at.Z)(t);switch(e.type){case We.Head:return ei(e,r);case We.Character:n=zr(e.value,e.grey,e.math);break;case We.Placeholder:n=Wr();break;case We.TrigLog:n=Jr(e.value);break;case We.Accent:var i=ei(e.contents,r);r=i.mappedNodes,n=Lr(i.node,e.accent);break;case We.Limit:var a=ei(e.contents,r);r=a.mappedNodes,n=Br(a.node);break;case We.Subscript:var o=ei(e.contents,r);r=o.mappedNodes,n=Vr(o.node);break;case We.Superscript:var s=ei(e.contents,r);r=s.mappedNodes,n=$r(s.node);break;case We.Fraction:var l,c,u=ei(e.numerator,r);l=u.node,r=u.mappedNodes;var d=ei(e.denominator,r);c=d.node,r=d.mappedNodes,n=Rr(l,c);break;case We.Integral:var h,p,m=ei(e.lowerBound,r);h=m.node,r=m.mappedNodes;var v=ei(e.upperBound,r);p=v.node,r=v.mappedNodes,n=Ur(h,p,e.placeholders);break;case We.Summation:var f,g,y=ei(e.lowerBound,r);f=y.node,r=y.mappedNodes;var b=ei(e.upperBound,r);g=b.node,r=b.mappedNodes,n=Qr(f,g);break;case We.PermComb:var x,C,E=ei(e.left,r);x=E.node,r=E.mappedNodes;var S=ei(e.right,r);C=S.node,r=S.mappedNodes,n=jr(e.letter,x,C);break;case We.Radical:var I,k,w=ei(e.index,r);I=w.node,r=w.mappedNodes;var T=ei(e.radicand,r);k=T.node,r=T.mappedNodes,(n=Gr(I,k,e.placeholders)).hungry=e.hungry;break;case We.Matrix:case We.Piecewise:case We.ShapeTable:case We.EquationTable:case We.Table:var M=function(e){var t;switch(e.type){case We.Matrix:return Fr(e.numRows,e.numCols);case We.Piecewise:return qr(0);case We.ShapeTable:return Kr(null===(t=e.shapeType)||void 0===t?void 0:t.type);case We.Table:return Xr();case We.EquationTable:return Yr(e.equation,e.variables,e.summaries,[])}}(e);M.children=e.children.map((function(e){var t,n=ei(e,r);return t=n.node,r=n.mappedNodes,t.parent=M,t})),n=M}return{node:n,mappedNodes:t.map((function(t,i){return e===t?n:r[i]}))}}function ni(e,t){for(var n=e,r=t;(n.type!==We.Head||n===e)&&r&&r.type!==We.Head;){var i=r.next;Ft(n,r),n=r,r=i}return n}function ri(e){var t=e.prev,n=e.next;return t&&(t.next=n),n&&(n.prev=t),null!==t&&void 0!==t?t:e}(0,it.Z)(Hr,"_id",0);var ii=(Nr={},(0,it.Z)(Nr,We.Accent,(function(e,t){if(Wt(e))return ri(e);var n=e.prev;e.prev&&ni(e.prev,Jt(e.contents));var r=ri(e);return null!==n&&void 0!==n?n:r})),(0,it.Z)(Nr,We.Character,(function(e,t){return ri(e)})),(0,it.Z)(Nr,We.Fraction,(function(e,t){if(Wt(e))return ri(e);if(t===e.numerator)return Gt(e.numerator);if(t===e.denominator){var n;n=Wt(e.numerator)?Gt(Jt(e.numerator)):Yt(e.numerator);var r=e.prev?ni(e.prev,Jt(e.numerator)):void 0;return r&&ni(r,Jt(e.denominator)),ri(e),n}return null!==t&&void 0!==t?t:e})),(0,it.Z)(Nr,We.Head,(function(e,t){return e.parent?ai(e.parent,e):e})),(0,it.Z)(Nr,We.Integral,(function(e,t){return Wt(e)||!t?ri(e):t===e.upperBound||t===e.lowerBound?Gt(t):t})),(0,it.Z)(Nr,We.Limit,(function(e,t){return Wt(e)||!t?ri(e):t===e.contents?Gt(e.contents):t})),(0,it.Z)(Nr,We.Matrix,(function(e,t){return Wt(e)||!t?ri(e):t.type===We.Head&&e.children.indexOf(t)>0?Gt(t):t})),(0,it.Z)(Nr,We.PermComb,(function(e,t){return t?tn(e.left)||tn(e.right)?t===e.right||t===e.left?Gt(t):t:ri(e):ai(Gt(e))})),(0,it.Z)(Nr,We.Piecewise,(function(e,t){if(Wt(e)||!t)return ri(e);var n;n=e;for(var r=0;r<e.children.length;r++)if(t===e.children[r])return r>0&&(n=Yt(e.children[r-1]),Xt(e.children[r-1],e.children[r])),e.children.splice(r,1),0===e.children.length?ri(e):n;return t})),(0,it.Z)(Nr,We.Placeholder,(function(e,t){return ri(e)})),(0,it.Z)(Nr,We.Radical,(function(e,t){var n;if(Wt(e))return ri(e);var r=null!==(n=e.prev)&&void 0!==n?n:e;return Ft(r,e.radicand),ri(e),r})),(0,it.Z)(Nr,We.ShapeTable,(function(e,t){return t||ri(e)})),(0,it.Z)(Nr,We.Subscript,(function(e,t){if(Wt(e.contents))return ri(e);if(t===e.contents){var n=Gt(e.contents);return ri(e),ni(n,Jt(e.contents)),n}return t||e})),(0,it.Z)(Nr,We.Summation,(function(e,t){return Wt(e)||!t?ri(e):t===e.upperBound||t===e.lowerBound?Gt(t):t})),(0,it.Z)(Nr,We.Superscript,(function(e,t){if(Wt(e.contents))return ri(e);if(t===e.contents){var n=Gt(e.contents);return ri(e),ni(n,Jt(e.contents)),n}return t||e})),(0,it.Z)(Nr,We.Table,(function(e,t){if(Wt(e))return ri(e);var n=(null===t||void 0===t?void 0:t.type)===We.Head?e.children.indexOf(t):-1;if(-1===n||!t)throw"Node not found in table to delete";if(n%2===0){var r=Gt(t);return tn(e.children[n])||tn(e.children[n+1])||e.children.splice(n,2),r}return Gt(t)})),(0,it.Z)(Nr,We.EquationTable,(function(e,t){return t||ri(e)})),(0,it.Z)(Nr,We.TrigLog,(function(e,t){return ri(e)})),Nr);function ai(e,t){switch(e.type){case We.Accent:case We.Character:case We.Fraction:case We.Head:case We.Integral:case We.Limit:case We.Matrix:case We.PermComb:case We.Piecewise:case We.Placeholder:case We.Radical:case We.ShapeTable:case We.Subscript:case We.Summation:case We.Superscript:case We.Table:case We.EquationTable:case We.TrigLog:return ii[e.type](e,t)}}function oi(e,t){if(e===t)return[];for(var n=si(e),r=si(t),i=0;n[i]===r[i];)i++;if(e=n[i],t=r[i],qt(e)!==qt(t))return[n[i-1]];var a=qt(e),o=n.length>i+1;if(an(a,t,e)){var s=e;e=t,t=s,o=r.length>i+1}var l=function(e,t,n){var r;if(t===n)return[n];var i=[],a=null!==(r=e.next)&&void 0!==r?r:e;if(t!==e)for(;a.type!==We.Head&&a!==t;){var o;a=null!==(o=a.next)&&void 0!==o?o:e}if(a.type===We.Head)return[];for(;a.type!==We.Head&&a!==n;){var s;i.push(a),a=null!==(s=a.next)&&void 0!==s?s:e}if(i.push(n),a!==n)throw"Found nodeA but not nodeB in Head.Between";return i}(a,e,t);return o||e.type===We.Head?l:l.slice(1)}function si(e){for(var t=[e],n=e,r=qt(e);r.parent;)r=qt(n=r.parent),t.unshift(n);return t}function li(e,t){if(e.type===We.Placeholder){var n;Ft(e,t);var r=null!==(n=e.next)&&void 0!==n?n:e;return ri(e),r}var i,a;return(null===(i=e.next)||void 0===i?void 0:i.type)===We.Placeholder&&ri(e.next),Ft(e,t),null!==(a=e.next)&&void 0!==a?a:e}function ci(e,t){switch(e.type){case We.Accent:return!(t.type===We.Character)||!(Ct(n=xt(n=t))||Zt(n)||Nt(n)||Lt(n)||"."===n||"-"===n)&&!Et(t);case We.Integral:case We.Summation:return t.type===We.Character?Ht(t)||Ot(t)||Lt(t):t.type===We.ShapeTable||t.type===We.Table;case We.PermComb:return t.type===We.Character&&!Ct(t)&&!Et(t);case We.Piecewise:return t.type===We.Character?Ht(t)||Ot(t):t.type===We.ShapeTable||t.type===We.Table;case We.Head:case We.Limit:case We.Subscript:case We.Superscript:case We.Fraction:case We.Matrix:case We.ShapeTable:case We.Table:case We.EquationTable:case We.Radical:return t.type===We.Character?Ht(t)||Ot(t)||"="===t.value||Tt(t):t.type===We.ShapeTable||t.type===We.Table}var n}function ui(e,t){if(e.type===We.Head){var n,r={x:0,y:0,size:0,elem:e};if(!e.id)return null;var i=1===t.size?t.entries().next().value[1]:t.get(e.id);if(!i)return null;var a=i.top;(null===(n=e.parent)||void 0===n?void 0:n.type)!==We.EquationTable&&(a=i.top-11);var o=i.left,s=i.height;r.y=a+s;var l,c=i.padLeft;if(r.x=o+c,0===s){var u;if(void 0!==(null===(u=e.parent)||void 0===u?void 0:u.id)&&t.has(e.parent.id)){var d=t.get(e.parent.id);r.size=.8*d.fontSize,r.y=d.top+r.size}else if(t.has("root")){var h=t.get("root");r.size=h.fontSize,r.y+=h.height/2+r.size/2}return r}if(tn(e)){var p=Kt(e);if(p.type!==We.Character||!Ht(p)){if(p.parent&&ht(p.parent)){var m=i.fontSize;return r.size=.8*m,r.y=i.top+s/2+r.size/2,r.elem=e,r}if(!(l=ui(p,t)))throw"nextElemPos is null";return l.x=r.x,l}}var v=i.fontSize;return dn(e)||(r.x=o,r.y=a+.8*s),!e.parent||e.parent.type!==We.Summation&&e.parent.type!==We.Integral||e.parent.placeholders&&Wt(e)&&(r.y+=.15*v),r.size=.8*v,r.elem=e,r}var f={x:0,y:0,size:0,elem:e};if(e.id){var g=t.get(e.id);if(g){var y,b;f.x=g.left+g.width;var x=g.height,C=g.top,E=g.left;if((null===(y=e.next)||void 0===y?void 0:y.type)===We.Placeholder&&e.next.id){var S=t.get(e.next.id);S&&(x=S.height,C=S.top)}var I=g.fontSize;if(f.size=.8*I,e.type===We.EquationTable&&(f.size=x),ht(e)?f.y=C+x/2+f.size/2:f.y=C+x,f.elem=e,e.type===We.Limit)f.x+=.2*I,f.y-=.15*I;else if(e.type!==We.Character||Ht(e)||g.isMathChar)if(e.type===We.Character&&Ht(e)){var k;if(f.x=E,3==(null===(k=e.next)||void 0===k?void 0:k.type))f.y-=.25*I;else if(e.next){var w=e.next,T=t.get(w.id);T&&(f.y=T.top+7)}}else e.type===We.Character&&Pt(e)?f.y=C+x/2+f.size/2:e.type===We.Piecewise?(f.x+=.15*I,f.y-=.25*I):e.type===We.Integral?(f.x+=.1*I,f.y-=.36*I):e.type===We.Summation?(f.x+=.1*I,f.y-=.41*I):e.type===We.Placeholder?(f.y+=.05*I,f.y-=.38*I):e.type===We.EquationTable?f.y+=.1*I:e.type===We.Fraction?(f.x+=.03*I,f.y-=.4*I):e.type===We.Matrix?(f.x+=.03*I,f.y-=.27*I):e.type===We.Radical?(f.x+=.03*I,f.y-=.4*I):e.type===We.PermComb?(f.x+=.05*I,f.y-=.4*I):e.type===We.Subscript?(f.x+=.05*I,f.y-=.43*I):e.type===We.Superscript?(f.x+=.05*I,f.y-=.35*I):e.type===We.ShapeTable&&(f.x+=.05*I,f.y-=.4*I);else f.y-=.25*I,f.x-=.05*I;return(null===(b=e.next)||void 0===b?void 0:b.type)===We.Placeholder&&(f.y+=.05*I),f}}return null}function di(e,t,n,r,i){var a=[];e.type===We.Head?(a=en(e)).shift():ht(e)?a=jt(e):e instanceof Array&&(e=(a=e).shift());var o=ui(e,r)||{x:0,y:0,size:0,elem:e},s=o.y-o.size/2;if(o.elem=e,i&&!i(o))o=null;else if(e.type===We.Head&&Wt(e)){var l=t;l=Math.max(o.x,l),l=Math.min(o.x,l),o.distance=Math.pow(t-l,2)+Math.pow(n-s,2)}else o.distance=Math.pow(t-o.x,2)+Math.pow(n-s,2);return a.reduce((function(e,a){var o=e?e.distance:Number.POSITIVE_INFINITY,s=a?di(a,t,n,r,i):{distance:Number.POSITIVE_INFINITY};return(s?s.distance:Number.POSITIVE_INFINITY)<o?s:e}),o)}function hi(e,t,n){return e.children[t*e.numCols+n]}var pi={"F=ma":[{variableAscii:"F",summary:"force"},{variableAscii:"m",summary:"mass"},{variableAscii:"a",summary:"acceleration"}],"\\rho =(m)/(V)":[{variableAscii:"\\rho ",summary:"density"},{variableAscii:"m",summary:"mass"},{variableAscii:"V",summary:"volume"}],"\\overline{a}=(v-v_(0))/(t)":[{variableAscii:"\\overline{a}",summary:"average acceleration"},{variableAscii:"v",summary:"final velocity"},{variableAscii:"v_(0)",summary:"initial velocity"},{variableAscii:"t",summary:"time"}],"V=IR":[{variableAscii:"V",summary:"voltage"},{variableAscii:"I",summary:"current"},{variableAscii:"R",summary:"resistance"}],"K=(1)/(2)mv^(2)":[{variableAscii:"K",summary:"kinetic energy"},{variableAscii:"m",summary:"mass"},{variableAscii:"v",summary:"velocity"}],"P=(W)/(t)":[{variableAscii:"P",summary:"power"},{variableAscii:"W",summary:"work"},{variableAscii:"t",summary:"time"}],"P=VI":[{variableAscii:"P",summary:"power"},{variableAscii:"V",summary:"voltage"},{variableAscii:"I",summary:"current"}],"\\lambda =(v)/(f)":[{variableAscii:"\\lambda ",summary:"wavelength"},{variableAscii:"v",summary:"velocity"},{variableAscii:"f",summary:"frequency"}],"PV=nRT":[{variableAscii:"P",summary:"pressure"},{variableAscii:"V",summary:"volume"},{variableAscii:"n",summary:"number of moles"},{variableAscii:"T",summary:"temperature"}],"x=x_(0)+v_(0)*t+(1)/(2)at^(2)":[{variableAscii:"x",summary:"final displacement"},{variableAscii:"x_(0)",summary:"initial displacement"},{variableAscii:"v_(0)",summary:"initial velocity"},{variableAscii:"t",summary:"time"},{variableAscii:"a",summary:"acceleration"}],"w=m*g":[{variableAscii:"w",summary:"weight"},{variableAscii:"m",summary:"mass"},{variableAscii:"g",summary:"acceleration"}],"\\omega = (\\Delta \\theta )/(t)":[{variableAscii:"\\omega",summary:"angular velocity"},{variableAscii:"\\Delta \\theta",summary:"change in angular rotation"},{variableAscii:"t",summary:"time"}],"a_(c)=(v^(2))/(r)":[{variableAscii:"a_(c)",summary:"centripetal acceleration"},{variableAscii:"v",summary:"velocity"},{variableAscii:"r",summary:"radius"}]};function mi(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return vi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function vi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fi={NewLine:[[bt,"\n","\r\n","\n\r","\\n"]]},gi=function(){function e(){(0,dt.Z)(this,e),(0,it.Z)(this,"isInAbsVal",!1),(0,it.Z)(this,"stopChars",[]),(0,it.Z)(this,"isInMatrix",!1)}return(0,ut.Z)(e,[{key:"IsClosingParen",value:function(e){return _t(e)||this.isInAbsVal&&Mt(e)}},{key:"IsLetter",value:function(e){return!this.IsStopChar(e)&&Et(e)}},{key:"IsStopChar",value:function(e){for(var t=0;t<this.stopChars.length;t++)if(this.stopChars[t]===e)return!0;return!1}}]),e}(),yi=function(){function e(t,n){(0,dt.Z)(this,e),(0,it.Z)(this,"str",void 0),(0,it.Z)(this,"pos",void 0),(0,it.Z)(this,"root",void 0),(0,it.Z)(this,"tokens",void 0),this.str=t,this.pos=null!==n&&void 0!==n?n:0,this.root=Dr(),this.tokens=[]}return(0,ut.Z)(e,[{key:"PreLex",value:function(){this.str=this.str.replace(/\xbd/g,"(1)/(2)").replace(/\u2153/g,"(1)/(3)").replace(/\u2154/g,"(2)/(3)").replace(/\u2026/g,"...").replace(/\xb2/g,"^2").replace(/\xb3/g,"^3").replace(/\u2074/g,"^4").replace(/\u2075/g,"^5").replace(/\u2208/g," in ")}},{key:"Lex",value:function(){this.PreLex();for(var t=0;t<this.str.length;){var n,r=e.LongestToken(this.str,t);if("Smiley"===(null===(n=r)||void 0===n?void 0:n.cat)){var i,a=0===this.tokens.length||"Space"===this.tokens[this.tokens.length-1].cat,o=t+r.orig.length===this.str.length||"Space"===(null===(i=e.LongestToken(this.str,t+r.orig.length))||void 0===i?void 0:i.cat);a&&o||(r=void 0)}if(r)t+=r.orig.length,this.tokens.push(r);else{var s=this.str[t];Et(s)?(this.tokens.push({cat:"Char",str:s}),t++):Nt(s)?(this.tokens.push({cat:"Space",str:" "}),t++):At(s)?(this.tokens.push({cat:"OpenParen",str:s}),t++):_t(s)?(this.tokens.push({cat:"CloseParen",str:s}),t++):It(s)?(this.tokens.push({cat:"Oper",str:s}),t++):kt(s)?(this.tokens.push({cat:"Factorial",str:s}),t++):"\u2061"===s||"\u202c"===s?t++:!function(e,t){var n,r=mi(e);try{for(r.s();!(n=r.n()).done;){if(t===n.value)return!0}}catch(i){r.e(i)}finally{r.f()}return!1}(["\ud83d","\ud83e","\ud83c"],s)?(this.tokens.push({cat:"Char",str:s}),t++):(this.tokens.push({cat:"Smiley",str:this.str[t]+this.str[t+1]}),t+=2)}}}},{key:"NextToken",value:function(){return this.tokens.length<=this.pos?{cat:"",str:"",orig:""}:this.tokens[this.pos]}},{key:"ParseChar",value:function(e){for(var t=Dr(),n=this.NextToken();this.pos<this.tokens.length;)this.pos++,Xt(t,zr(n.str)),n=this.NextToken();if(!e.IsStopChar(n.str))switch(n.cat){case"Char":case"Oper":case"Factorial":case"NewLine":Xt(t,zr(bt)),this.pos++;break;case"Num":var r,i=mi(n.str.split(""));try{for(i.s();!(r=i.n()).done;){Xt(t,zr(r.value))}}catch(a){i.e(a)}finally{i.f()}this.pos++}return t}},{key:"ParseTrigLog",value:function(){var e=this.NextToken();return"TrigLog"===e.cat?(this.pos++,Jr(e.str.substring(1))):null}},{key:"ParseSmiley",value:function(){var e=this.NextToken();return"Smiley"===e.cat?(this.pos++,Dr(void 0,e.str.split(""))):null}},{key:"ParseSuperscript",value:function(t){if("^"===this.NextToken().str){var n;if(this.pos++,"+-".indexOf(this.NextToken().str)>-1){var r=new gi;if(r.isInMatrix=t.isInMatrix,!(n=this.ParseSimpleExpression(r)))return null;if(this.pos<this.tokens.length&&"+-\u2192".indexOf(this.NextToken().str)<0){(r=new gi).isInMatrix=t.isInMatrix;var i=this.ParseSimpleExpression(r);if(!i)return null;Xt(n,i)}}else{var a=new gi;if(a.isInMatrix=t.isInMatrix,!(n=this.ParseSimpleExpression(a)))return null;n=e.RemoveOuterParens(n)}return $r(n||void 0)}return null}},{key:"ParseSubscript",value:function(t){if("_"===this.NextToken().str){this.pos++;var n=new gi;n.isInMatrix=t.isInMatrix;var r=this.ParseSimpleExpression(n);return r?Vr((r=e.RemoveOuterParens(r))||void 0):null}return null}},{key:"ParseAccent",value:function(t){var n=this.NextToken();if("Accent"===n.cat){this.pos++;var r=new gi;r.isInMatrix=t.isInMatrix;var i=this.ParseSimpleExpression(r);return i?Lr((i=e.RemoveOuterParens(i))||void 0,n.str):null}return null}},{key:"ParseUnary",value:function(e){var t=this.NextToken().str;this.pos++;for(var n=Dr(),r=0;r<t.length;r++)Xt(n,zr(t[r]));var i=this.ParseSubscript(e);null!==i&&Xt(n,i);var a=this.ParseSuperscript(e);return null!==a&&Xt(n,a),n}},{key:"ParseRadical",value:function(t){var n,r,i;if("\\sqrt"===this.NextToken().str){this.pos++;var a=new gi;if(a.isInMatrix=t.isInMatrix,!(r=e.RemoveOuterParens(this.ParseSimpleExpression(a))))return null;i=Gr(void 0,r)}else{this.pos++;var o=new gi;if(o.isInMatrix=t.isInMatrix,!(n=e.RemoveOuterParens(this.ParseSimpleExpression(o))))return null;var s=new gi;if(s.isInMatrix=t.isInMatrix,!(r=e.RemoveOuterParens(this.ParseSimpleExpression(s))))return null;i=Gr(n,r)}return i}},{key:"ParseArray",value:function(e,t,n,r){var i=this.pos,a=[],o=this.NextToken().str;if(o===e){for(var s=!0;this.pos<this.tokens.length&&(o===t||s&&o===e);){s=!1,this.pos++;var l=new gi;l.isInMatrix=!!r,l.stopChars.push(t);var c=this.ParseExpression(l);if(!c)return null;a.push(c),o=this.NextToken().str}return o!==n?(this.pos=i,null):(this.pos++,a)}return null}},{key:"ParseTable",value:function(){var e=this.NextToken().str,t=this.pos-1;this.pos++;var n=this.ParseMatrix();if(null===n)return null;switch(e){case"\\table":var r=Xr();r.children=[];for(var i=0;i<n.children.length;i++){var a=n.children[i];r.children.push(a),a.parent=r}return r;case"\\triTable":case"\\shapeTable":if(-1===t)return null;var o=gn(this.tokens[t].str);if(null!==o){for(var s=Kr(o.type),l=0;l<n.numRows&&l<s.children.length;l++)s.children[l]=hi(n,l,1),s.children[l].parent=s;return s}}return null}},{key:"ParseEquationTable",value:function(t){this.pos++;var n=new gi;n.isInMatrix=t.isInMatrix;var r=e.RemoveOuterParens(this.ParseSimpleExpression(n));if(!r)return null;for(;" "===this.NextToken().str;)this.pos++;var i=this.ParseMatrix();if(null===i)return null;for(var a=pi[jn(r)],o=[],s=[],l=[],c=function(e){var t=void 0;if(a){var n=a.find((function(t){return t.variableAscii===jn(hi(i,e,0))}));t=n?n.summary:"?"}else t="?";o.push(hi(i,e,0)),s.push(t),l.push(hi(i,e,1))},u=0;u<i.numRows;u++)c(u);return Yr(r,o,s,l)}},{key:"ParseMatrix",value:function(){var t=this.pos,n=null;if("["===this.NextToken().str){this.pos++;for(var r=!0,i=[],a=!0;a;){if(!r){var o=this.NextToken().str;if(","!==o){if("]"===o){this.pos++;for(var s=i.length,l=0,c=0;c<i.length;c++)l=Math.max(l,i[c].length);n=Fr(s,l);for(var u=0;u<i.length;u++)for(var d=0;d<i[u].length;d++){var h=e.RemoveOuterParens(i[u][d]);if(!h)throw"null cell contents";Xt(hi(n,u,d),h)}a=!1;continue}a=!1;continue}this.pos++}var p=this.ParseArray("[",",","]",!0);null!==p?(i.push(p),r=!1):a=!1}}return null===n&&(this.pos=t),n}},{key:"MakePiecewise",value:function(t){for(var n=cn(t,",",!0),r=qr(n.length),i=0;i<n.length;i++){var a=e.RemoveOuterParens(n[i]);if(!a)throw"null content in piecewise row";Xt(r.children[i],a)}return r}},{key:"ParseLimit",value:function(e){this.pos++;var t=this.ParseSubscript(e),n=Dr();return null!==t&&Xt(n,t.contents),Br(n)}},{key:"ParseIntegral",value:function(e){this.pos++;var t=void 0,n=void 0;if("_"===this.NextToken().str){var r=this.ParseSubscript(e);null!==r&&(t=r.contents)}if("^"===this.NextToken().str){var i=this.ParseSuperscript(e);null!==i&&(n=i.contents)}return" "===this.NextToken().str&&this.pos++,Ur(t,n)}},{key:"ParseSummation",value:function(e){this.pos++;var t=void 0,n=void 0;if("_"===this.NextToken().str){var r=this.ParseSubscript(e);null!==r&&(t=r.contents)}if("^"===this.NextToken().str){var i=this.ParseSuperscript(e);null!==i&&(n=i.contents)}return" "===this.NextToken().str&&this.pos++,Qr(t,n)}},{key:"ParseFunction",value:function(e){if(this.pos>=this.tokens.length)return null;var t=this.ParseUnary(e),n=this.ParseExpression(e);return n?(Xt(t,n),t):null}},{key:"ParseSimpleExpression",value:function(e){if(this.pos>=this.tokens.length)return Dr();var t;return null!==(t=this.ParseChar(e))?t.type===We.Head?t:Xt(Dr(),t):(console.error("parse error: unexpected '"+this.NextToken().str+"' in "+this.str+" at token position "+this.pos),null)}},{key:"ParseShape",value:function(){var e=gn(this.NextToken().str);if(this.pos++,!e)throw"ParseShape on invalid shape type";return zr(e.char)}},{key:"ParsePermComb",value:function(t){var n,r;r="Perm"===(null===(n=this.NextToken().orig)||void 0===n?void 0:n.substring(1))?"P":"C",this.pos++;var i=e.RemoveOuterParens(this.ParseSimpleExpression(t));if(!i)return null;var a=e.RemoveOuterParens(this.ParseSimpleExpression(t));return a?jr(r,i,a):null}},{key:"ParseIntermediateExpression",value:function(e){var t;if(!(t="_"===this.NextToken().str||"^"===this.NextToken().str?Dr():this.ParseSimpleExpression(e)))return null;for(;!(this.pos>=this.tokens.length||":}"===this.NextToken().str||e.IsStopChar(this.NextToken().str));)if("_"===this.NextToken().str){var n=this.ParseSubscript(e);if(!n)return null;Xt(t,n)}else{if("^"!==this.NextToken().str)break;var r=this.ParseSuperscript(e);if(!r)return null;Xt(t,r)}return t}},{key:"ParseExpression",value:function(t){for(var n=Dr();!(this.pos>=this.tokens.length||":}"===this.NextToken().str||t.IsStopChar(this.NextToken().str));){var r=this.ParseIntermediateExpression(t);if(!r)return null;if("/"===this.NextToken().str||"\\"===this.NextToken().str){this.pos++;var i=e.RemoveOuterParens(r),a=this.ParseIntermediateExpression(t);if(!a)return null;Xt(n,Rr(i||void 0,(a=e.RemoveOuterParens(a))||void 0))}else Xt(n,r)}return n}},{key:"Parse",value:function(){this.Lex();var e=this.ParseExpression(new gi);return e||null}}],[{key:"LongestToken",value:function(e,t){var n=void 0;for(var r in fi)if(Object.prototype.hasOwnProperty.call(fi,r)&&fi[r]instanceof Array)for(var i=0;i<fi[r].length;i++){var a=fi[r][i];"string"===typeof a&&(a=[a]);for(var o=a[0],s=0;s<a.length;s++)e.startsWith(a[s],t)&&(!n||n.str.length<a[s].length)&&(n={cat:r,str:o,orig:a[s]})}return n&&n.orig.startsWith("\\")&&t+n.orig.length<e.length&&" "===e[t+n.orig.length]&&(n.orig+=" "),n}},{key:"RemoveOuterParens",value:function(e){if(!e)return null;var t=Jt(e),n=Yt(e);return t.type===We.Character&&n.type===We.Character&&At(t)&&_t(n)&&(ai(t),ai(n)),e}}]),e}();function bi(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return xi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function xi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ci=(0,ut.Z)((function e(){(0,dt.Z)(this,e)}));function Ei(e,t){var n={head:e,curCursor:t};return n=function(e,t){var n=ei(e,t?[t]:[]),r=!1,i={head:n.node,curCursor:t?n.mappedNodes[0]:void 0},a=i.head.next;for(;a&&a.type!==We.Head;){if(ht(a))switch(a.type){case We.Limit:case We.Subscript:case We.Superscript:case We.Accent:var o=Ei(a.contents,i.curCursor);r=r||o.head!==a.contents,a.contents=o.head,o.head.parent=a,i.curCursor=o.curCursor;break;case We.Fraction:var s=Ei(a.numerator,i.curCursor);r=r||s.head!==a.numerator,a.numerator=s.head,s.head.parent=a,i.curCursor=s.curCursor;var l=Ei(a.denominator,i.curCursor);r=r||l.head!==a.denominator,a.denominator=l.head,l.head.parent=a,i.curCursor=l.curCursor;break;case We.Integral:case We.Summation:var c=Ei(a.lowerBound,i.curCursor);r=r||c.head!==a.lowerBound,a.lowerBound=c.head,c.head.parent=a,i.curCursor=c.curCursor;var u=Ei(a.upperBound,i.curCursor);r=r||u.head!==a.upperBound,a.upperBound=u.head,u.head.parent=a,i.curCursor=u.curCursor;break;case We.Matrix:case We.Piecewise:case We.ShapeTable:case We.Table:for(var d=0;d<a.children.length;d++){var h=Ei(a.children[d],i.curCursor);r=r||h.head!==a.children[d],a.children[d]=h.head,h.head.parent=a,i.curCursor=h.curCursor}break;case We.PermComb:var p=Ei(a.left,i.curCursor);r=r||p.head!==a.left,a.left=p.head,p.head.parent=a,i.curCursor=p.curCursor;var m=Ei(a.right,i.curCursor);r=r||m.head!==a.right,a.right=m.head,m.head.parent=a,i.curCursor=m.curCursor;break;case We.Radical:var v=Ei(a.index,i.curCursor);r=r||v.head!==a.index,a.index=v.head,v.head.parent=a,i.curCursor=v.curCursor;var f=Ei(a.radicand,i.curCursor);r=r||f.head!==a.radicand,a.radicand=f.head,f.head.parent=a,i.curCursor=f.curCursor}a=a.next}return r?i:{head:e,curCursor:t}}(n.head,n.curCursor),n=function(e,t){var n={head:e,curCursor:t},r=e.next;for(;r&&r.type!==We.Head;){var i;if(r.type===We.Character){if((null===(i=r.next)||void 0===i?void 0:i.type)===We.Character&&zt(r)&&Rt(r.next)){var o=ei(n.head,[r,r.next,t].filter((function(e){return!!e}))),s=void 0,l=(0,a.Z)(o.mappedNodes,3);r=l[0],s=l[1],n.curCursor=l[2];var c=Wr();n.curCursor!==r&&n.curCursor!==s||(n.curCursor=c),Dt(r,c),ai(s),ai(r),r=c}else if(zt(r)||Rt(r)){var u=ei(n.head,[r,t].filter((function(e){return!!e}))),d=(0,a.Z)(u.mappedNodes,2);r=d[0],n.curCursor=d[1];var h=Wr();n.curCursor===r&&(n.curCursor=h),Dt(r,h),ai(r),r=h}r=r.next}else r=r.next}return n}(n.head,n.curCursor),n=function(e,t){var n={head:e,curCursor:t},r=e.next;for(;r&&r.type!==We.Head;){var i;if(r.type===We.Character&&(null===(i=r.next)||void 0===i?void 0:i.type)===We.Character){var o="-"===r.value&&">"===r.next.value?"\u2192":"<"===r.value&&"="===r.next.value?"\u2264":">"===r.value&&"="===r.next.value?"\u2265":void 0;if(o){var s=Si(n,e,t,[r]);if((r=(0,a.Z)(s,1)[0]).type!==We.Character||!r.next)throw"clone doesn't match original";n.curCursor===r.next&&(n.curCursor=r),ai(r.next),r.value=o}}r=r.next}return n}(n.head,n.curCursor),n=function(e,t){var n={head:e,curCursor:t},r=n.head.next;for(;r&&r.type!==We.Head;){if(r.type===We.Radical&&r.hungry){for(var i,o=r.next;o&&o.type!==We.Head&&(Ii(o)||o.type===We.Character&&At(o));)o=o.type===We.Character&&At(o)?pn(o).next:o.next;var s=Si(n,e,t,[r,null!==(i=o)&&void 0!==i?i:n.head]),l=(0,a.Z)(s,2);if(r=l[0],o=l[1],r.type!==We.Radical)throw"Clone differs from original";if(r.hungry=!1,r.next&&o!==r.next){Xt(r.radicand,ln(n.head,r.next,o.prev));break}}r=r.next}return n}(n.head,n.curCursor),n=function(e,t){function n(e){return"_"===e.value}function r(e){return"^"===e.value}function i(e){return"number"===e||"unit"===e||"letter"===e||"paren"===e||"operator"===e||"factorial"===e}function o(e){return(null===e||void 0===e?void 0:e.type)===We.Character&&(Et(e)||Ct(e)||Pt(e))}var s={head:e,curCursor:t},l=e.next;for(;l&&l.type!==We.Head;){var c,u,d,h,p,m=void 0;if(l.type===We.Character&&(n(l)||r(l))){var v=Si(s,e,t,[l]);if((l=(0,a.Z)(v,1)[0]).type!==We.Character)throw"clone differs from original";var f=Dr();m=n(l)?Vr(f):$r(f);var g=l.next;if(!g)throw"should not happen";s.curCursor===l&&(s.curCursor=f);var y=Nn.RunOnce(g,!1);if(Dt(l,m),ri(l),y&&i(y.type)&&(g.type!==We.Character||!_t(g))){for(var b=g;b!==y.node;){var x=b.next;if(!x)throw"should not happen";ri(b),Xt(f,b),b=x}l=b}l=m}if((l=m?m.next:l.next)&&(null===(c=l.prev)||void 0===c?void 0:c.type)===We.Subscript&&(null===(u=l.prev.prev)||void 0===u?void 0:u.type)===We.Superscript&&(null===(d=l.prev.prev.prev)||void 0===d?void 0:d.type)!==We.Subscript){var C,E=Si(s,e,t,[l]),S=(l=(0,a.Z)(E,1)[0]).prev,I=null===(C=l.prev)||void 0===C?void 0:C.prev;if(!S||!I)throw"clone differs from original";ri(S),Dt(I,S)}if(l&&(null===(h=l.prev)||void 0===h?void 0:h.type)===We.Superscript&&(null===(p=l.prev.prev)||void 0===p?void 0:p.type)===We.Fraction&&o(l.prev.prev.denominator.next)&&m){var k,w,T=Si(s,e,t,[l]),M=(l=(0,a.Z)(T,1)[0]).prev,P=null===(k=l.prev)||void 0===k?void 0:k.prev;if(!M||(null===(w=P)||void 0===w?void 0:w.type)!==We.Fraction)throw"clone differs from original";ri(M),Dt(P.denominator,M)}}return s}(n.head,n.curCursor),n=function(e,t){function n(e){return"!"===e.value}function r(e){return Et(e)||Ct(e)}var i={head:e,curCursor:t},o=e.next;for(;o&&o.type!==We.Head;){var s;if(o.type===We.Fraction)if((null===(s=o.numerator.next)||void 0===s?void 0:s.type)===We.Character&&n(o.numerator.next))for(var l=o.prev,c=o.numerator.next;(null===(u=l)||void 0===u?void 0:u.type)===We.Character&&r(l);){var u,d,h=void 0,p=Si(i,e,t,[o,l,c]),m=(0,a.Z)(p,3);if(o=m[0],l=m[1],(h=m[2]).type!==c.type)throw"clone of Character isnt Character";if(c=h,o.type!==We.Fraction||(null===(d=o.numerator.next)||void 0===d?void 0:d.type)!==We.Character)throw"clone doesnt match original";ri(l),Dt(c,l),c=o.numerator.next,l=o.prev}o=o.next}return i}(n.head,n.curCursor),n=function(e,t){var n={head:e,curCursor:t},r=e.next;for(;r&&r.type!==We.Head;){var i=void 0,o=void 0;if(null!==Ci.PermComb.func(r)){var s=Si(n,e,t,[r]);r=(0,a.Z)(s,1)[0];var l=Ci.NatNum.func(r);if(!l)throw"matched PermComb without NaturalNumber";if(l.type!==We.Character)throw"matched PermComb but NaturalNumber isn't followed by Character";var c=ln(n.head,r),u=ln(c,l);if(!u.next)throw"should not happen";ri(u.next);var d=jr(l.value,c,u);Xt(n.head,d),r=d,n.curCursor===l&&(n.curCursor=u)}else r=null!==(i=Ci.Decimal.func(r))?i:null!==(o=Ci.Variables.func(r))?o:r.next}return n}(n.head,n.curCursor),n=function(e,t){var n={head:e,curCursor:t},r=e.next;for(;r&&r.type!==We.Head;)if(ht(r)){var i,o=bi(jt(r));try{for(o.s();!(i=o.n()).done;)for(var s=i.value,l=!1,c=s.next;c&&c.type!==We.Head;){var u;if(c.type===We.Character&&(null===(u=c.next)||void 0===u?void 0:u.type)===We.Character&&"P"===c.value&&"("===c.next.value&&(l=!0),ci(r,c)&&(!l||c.type!==We.Character||"="!==c.value&&!Tt(c))){var d=void 0,h=void 0,p=Si(n,e,t,[r,s,c]),m=(0,a.Z)(p,3);if(h=m[0],d=m[1],c=m[2],h.type!==r.type||d.type!==s.type)throw"clone has different type";Ft(r=h,ln(s=d,c));break}c=c.next}}catch(v){o.e(v)}finally{o.f()}r=r.next}else r=r.next;return n}(n.head,n.curCursor),n}function Si(e,t,n,r){if(e.head===t){var i=ei(t,n?r.concat([n]):r);return e.head=i.node,e.curCursor=i.mappedNodes[r.length],i.mappedNodes.slice(0,r.length)}return r}function Ii(e){return e.type===We.Character?Et(e)||Ct(e)||St(e):e.type===We.Superscript||e.type===We.Subscript}function ki(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,it.Z)(Ci,"PermComb",En.PermComb()),(0,it.Z)(Ci,"NatNum",En.NaturalNumber()),(0,it.Z)(Ci,"Decimal",En.Decimal()),(0,it.Z)(Ci,"Variables",En.Variable()),(0,it.Z)(Ci,"Operators",En.Oper()),(0,it.Z)(Ci,"FracStr",En.FractionString()),(0,it.Z)(Ci,"FuncScript",En.FuncNameAndScript()),(0,it.Z)(Ci,"Smiley",En.SmileyString());var Ti=function(){function e(){(0,dt.Z)(this,e),(0,it.Z)(this,"isInAbsVal",!1),(0,it.Z)(this,"stopChars",[]),(0,it.Z)(this,"isInMatrix",!1)}return(0,ut.Z)(e,[{key:"IsClosingParen",value:function(e){return _t(e)||this.isInAbsVal&&Mt(e)}},{key:"IsLetter",value:function(e){return!this.IsStopChar(e)&&Et(e)}},{key:"IsStopChar",value:function(e){for(var t=0;t<this.stopChars.length;t++)if(this.stopChars[t]===e)return!0;return!1}}]),e}(),Mi=function(){function e(t,n){(0,dt.Z)(this,e),(0,it.Z)(this,"str",void 0),(0,it.Z)(this,"pos",void 0),(0,it.Z)(this,"root",void 0),(0,it.Z)(this,"tokens",void 0),(0,it.Z)(this,"math",void 0),this.str=t,this.pos=null!==n&&void 0!==n?n:0,this.math=!0,this.root=Dr(void 0,void 0,this.math),this.tokens=[]}return(0,ut.Z)(e,[{key:"PreLex",value:function(){this.str=this.str.replace(/\xbd/g,"(1)/(2)").replace(/\u2153/g,"(1)/(3)").replace(/\u2154/g,"(2)/(3)").replace(/\u2026/g,"...").replace(/\xb2/g,"^2").replace(/\xb3/g,"^3").replace(/\u2074/g,"^4").replace(/\u2075/g,"^5").replace(/\u2208/g," in ")}},{key:"Lex",value:function(){this.PreLex();for(var t=0;t<this.str.length;){var n,r=e.LongestToken(this.str,t);if("Smiley"===(null===(n=r)||void 0===n?void 0:n.cat)){var i,a=0===this.tokens.length||"Space"===this.tokens[this.tokens.length-1].cat,o=t+r.orig.length===this.str.length||"Space"===(null===(i=e.LongestToken(this.str,t+r.orig.length))||void 0===i?void 0:i.cat);a&&o||(r=void 0)}if(r)t+=r.orig.length,this.tokens.push(r);else{var s=this.str[t];if(Et(s))this.tokens.push({cat:"Char",str:s}),t++;else if(Ct(s)){for(var l="";t<this.str.length&&(Ct(this.str[t])||"."===this.str[t]&&-1===l.indexOf("."));)l+=this.str[t],t++;this.tokens.push({cat:"Num",str:l})}else Nt(s)?(this.tokens.push({cat:"Space",str:" "}),t++):At(s)?(this.tokens.push({cat:"OpenParen",str:s}),t++):_t(s)?(this.tokens.push({cat:"CloseParen",str:s}),t++):It(s)?(this.tokens.push({cat:"Oper",str:s}),t++):kt(s)?(this.tokens.push({cat:"Factorial",str:s}),t++):("\u2061"===s||"\u202c"===s||this.tokens.push({cat:"Char",str:s}),t++)}}}},{key:"NextToken",value:function(){return this.tokens.length<=this.pos?{cat:"",str:"",orig:""}:this.tokens[this.pos]}},{key:"ParseChar",value:function(e){for(var t=Dr(void 0,void 0,this.math),n=this.NextToken();this.pos<this.tokens.length&&"Space"===n.cat;)this.pos++,Xt(t,zr(n.str,void 0,this.math)),n=this.NextToken();if(!e.IsStopChar(n.str))switch(n.cat){case"Char":case"Oper":case"Factorial":case"NewLine":Xt(t,zr(n.str,void 0,this.math)),this.pos++;break;case"Num":var r,i=ki(n.str.split(""));try{for(i.s();!(r=i.n()).done;){Xt(t,zr(r.value,void 0,this.math))}}catch(a){i.e(a)}finally{i.f()}this.pos++}return t}},{key:"ParseTrigLog",value:function(){var e=this.NextToken();return"TrigLog"===e.cat?(this.pos++,Jr(e.str.substring(1))):null}},{key:"ParseSmiley",value:function(){var e=this.NextToken();return"Smiley"===e.cat?(this.pos++,Dr(void 0,e.str.split(""),this.math)):null}},{key:"ParseSuperscript",value:function(t){if("^"===this.NextToken().str){var n;if(this.pos++,"+-".indexOf(this.NextToken().str)>-1){var r=new Ti;if(r.isInMatrix=t.isInMatrix,!(n=this.ParseSimpleExpression(r)))return null;if(this.pos<this.tokens.length&&"+-\u2192".indexOf(this.NextToken().str)<0){(r=new Ti).isInMatrix=t.isInMatrix;var i=this.ParseSimpleExpression(r);if(!i)return null;Xt(n,i)}}else{var a=new Ti;if(a.isInMatrix=t.isInMatrix,!(n=this.ParseSimpleExpression(a)))return null;n=e.RemoveOuterParens(n)}return $r(n||void 0)}return null}},{key:"ParseSubscript",value:function(t){if("_"===this.NextToken().str){this.pos++;var n=new Ti;n.isInMatrix=t.isInMatrix;var r=this.ParseSimpleExpression(n);return r?Vr((r=e.RemoveOuterParens(r))||void 0):null}return null}},{key:"ParseAccent",value:function(t){var n=this.NextToken();if("Accent"===n.cat){this.pos++;var r=new Ti;r.isInMatrix=t.isInMatrix;var i=this.ParseSimpleExpression(r);return i?Lr((i=e.RemoveOuterParens(i))||void 0,n.str):null}return null}},{key:"ParseUnary",value:function(e){var t=this.NextToken().str;this.pos++;for(var n=Dr(void 0,void 0,this.math),r=0;r<t.length;r++)Xt(n,zr(t[r],void 0,this.math));var i=this.ParseSubscript(e);null!==i&&Xt(n,i);var a=this.ParseSuperscript(e);return null!==a&&Xt(n,a),n}},{key:"ParseRadical",value:function(t){var n,r,i;if("\\sqrt"===this.NextToken().str){this.pos++;var a=new Ti;if(a.isInMatrix=t.isInMatrix,!(r=e.RemoveOuterParens(this.ParseSimpleExpression(a))))return null;i=Gr(void 0,r)}else{this.pos++;var o=new Ti;if(o.isInMatrix=t.isInMatrix,!(n=e.RemoveOuterParens(this.ParseSimpleExpression(o))))return null;var s=new Ti;if(s.isInMatrix=t.isInMatrix,!(r=e.RemoveOuterParens(this.ParseSimpleExpression(s))))return null;i=Gr(n,r)}return i}},{key:"ParseArray",value:function(e,t,n,r){var i=this.pos,a=[],o=this.NextToken().str;if(o===e){for(var s=!0;this.pos<this.tokens.length&&(o===t||s&&o===e);){s=!1,this.pos++;var l=new Ti;l.isInMatrix=!!r,l.stopChars.push(t);var c=this.ParseExpression(l);if(!c)return null;a.push(c),o=this.NextToken().str}return o!==n?(this.pos=i,null):(this.pos++,a)}return null}},{key:"ParseTable",value:function(){var e=this.NextToken().str,t=this.pos-1;this.pos++;var n=this.ParseMatrix();if(null===n)return null;switch(e){case"\\table":var r=Xr();r.children=[];for(var i=0;i<n.children.length;i++){var a=n.children[i];r.children.push(a),a.parent=r}return r;case"\\triTable":case"\\shapeTable":if(-1===t)return null;var o=gn(this.tokens[t].str);if(null!==o){for(var s=Kr(o.type),l=0;l<n.numRows&&l<s.children.length;l++)s.children[l]=hi(n,l,1),s.children[l].parent=s;return s}}return null}},{key:"ParseEquationTable",value:function(t){this.pos++;var n=new Ti;n.isInMatrix=t.isInMatrix;var r=e.RemoveOuterParens(this.ParseSimpleExpression(n));if(!r)return null;for(;" "===this.NextToken().str;)this.pos++;var i=this.ParseMatrix();if(null===i)return null;for(var a=pi[xe(jn(r))],o=[],s=[],l=[],c=function(e){var t=void 0;if(a){var n=a.find((function(t){return t.variableAscii.trim()===be(jn(hi(i,e,0)))}));t=n?Wt(hi(i,e,1))?n.summary:On(hi(i,e,1)):"?"}else t="?";o.push(hi(i,e,0)),s.push(t),l.push(hi(i,e,1))},u=0;u<i.numRows;u++)c(u);return Yr(r,o,s,l)}},{key:"ParseMatrix",value:function(){var t=this.pos,n=null;if("["===this.NextToken().str){this.pos++;for(var r=!0,i=[],a=!0;a;){if(!r){var o=this.NextToken().str;if(","!==o){if("]"===o){this.pos++;for(var s=i.length,l=0,c=0;c<i.length;c++)l=Math.max(l,i[c].length);n=Fr(s,l);for(var u=0;u<i.length;u++)for(var d=0;d<i[u].length;d++){var h=e.RemoveOuterParens(i[u][d]);if(!h)throw"null cell contents";Xt(hi(n,u,d),h)}a=!1;continue}a=!1;continue}this.pos++}var p=this.ParseArray("[",",","]",!0);null!==p?(i.push(p),r=!1):a=!1}}return null===n&&(this.pos=t),n}},{key:"MakePiecewise",value:function(t){for(var n=cn(t,",",!0),r=qr(n.length),i=0;i<n.length;i++){var a=e.RemoveOuterParens(n[i]);if(!a)throw"null content in piecewise row";Xt(r.children[i],a)}return r}},{key:"ParseLimit",value:function(e){this.pos++;var t=this.ParseSubscript(e),n=Dr(void 0,void 0,this.math);return null!==t&&Xt(n,t.contents),Br(n)}},{key:"ParseIntegral",value:function(e){this.pos++;var t=void 0,n=void 0;if("_"===this.NextToken().str){var r=this.ParseSubscript(e);null!==r&&(t=r.contents)}if("^"===this.NextToken().str){var i=this.ParseSuperscript(e);null!==i&&(n=i.contents)}return" "===this.NextToken().str&&this.pos++,Ur(t,n)}},{key:"ParseSummation",value:function(e){this.pos++;var t=void 0,n=void 0;if("_"===this.NextToken().str){var r=this.ParseSubscript(e);null!==r&&(t=r.contents)}if("^"===this.NextToken().str){var i=this.ParseSuperscript(e);null!==i&&(n=i.contents)}return" "===this.NextToken().str&&this.pos++,Qr(t,n)}},{key:"ParseFunction",value:function(e){if(this.pos>=this.tokens.length)return null;var t=this.ParseUnary(e),n=this.ParseExpression(e);return n?(Xt(t,n),t):null}},{key:"ParseSimpleExpression",value:function(e){if(this.pos>=this.tokens.length)return Dr(void 0,void 0,this.math);var t=null;switch(this.NextToken().cat){case"Trig":case"Func":t=this.ParseFunction(e);break;case"TrigLog":t=this.ParseTrigLog();break;case"Root":t=this.ParseRadical(e);break;case"Table":t=e.isInMatrix?null:this.ParseTable();break;case"EquationTable":t=this.ParseEquationTable(e);break;case"OpenParen":var n=e.isInMatrix?null:this.ParseMatrix();if(null!==n){t=n;break}var r=this.NextToken();this.pos++;var i=new Ti;i.isInAbsVal="|"===r.str,i.isInMatrix=!!e.isInMatrix;var a=this.ParseExpression(i);if(!a)return null;var o=this.NextToken();i.IsClosingParen(o.str)?(this.pos++,t=Dr(void 0,[zr(r.str,void 0,this.math),a,zr(o.str,void 0,this.math)],this.math)):"{"===r.str&&":}"===o.str&&(this.pos++,t=this.MakePiecewise(a));break;case"Lim":t=this.ParseLimit(e);break;case"Int":t=this.ParseIntegral(e);break;case"Sum":t=this.ParseSummation(e);break;case"Char":case"Num":case"Oper":case"Factorial":case"Space":case"NewLine":t=this.ParseChar(e);break;case"Smiley":t=this.ParseSmiley();break;case"Shape":t=this.ParseShape();break;case"PermComb":t=this.ParsePermComb(e);break;case"Accent":t=this.ParseAccent(e)}return null!==t?t.type===We.Head?t:Xt(Dr(void 0,void 0,this.math),t):(console.error("parse error: unexpected '"+this.NextToken().str+"' in "+this.str+" at token position "+this.pos),null)}},{key:"ParseShape",value:function(){var e=gn(this.NextToken().str);if(this.pos++,!e)throw"ParseShape on invalid shape type";return zr(e.char,void 0,this.math)}},{key:"ParsePermComb",value:function(t){var n,r;r="Perm"===(null===(n=this.NextToken().orig)||void 0===n?void 0:n.substring(1))?"P":"C",this.pos++;var i=e.RemoveOuterParens(this.ParseSimpleExpression(t));if(!i)return null;var a=e.RemoveOuterParens(this.ParseSimpleExpression(t));return a?jr(r,i,a):null}},{key:"ParseIntermediateExpression",value:function(e){var t;if(!(t="_"===this.NextToken().str||"^"===this.NextToken().str?Dr(void 0,void 0,this.math):this.ParseSimpleExpression(e)))return null;for(;!(this.pos>=this.tokens.length||e.IsClosingParen(this.NextToken().str)||":}"===this.NextToken().str||e.IsStopChar(this.NextToken().str));)if("_"===this.NextToken().str){var n=this.ParseSubscript(e);if(!n)return null;Xt(t,n)}else{if("^"!==this.NextToken().str)break;var r=this.ParseSuperscript(e);if(!r)return null;Xt(t,r)}return t}},{key:"ParseExpression",value:function(t){for(var n=Dr(void 0,void 0,this.math);!(this.pos>=this.tokens.length||t.IsClosingParen(this.NextToken().str)||":}"===this.NextToken().str||t.IsStopChar(this.NextToken().str));){var r=this.ParseIntermediateExpression(t);if(!r)return null;if("/"===this.NextToken().str||"\\"===this.NextToken().str){this.pos++;var i=e.RemoveOuterParens(r),a=this.ParseIntermediateExpression(t);if(!a)return null;Xt(n,Rr(i||void 0,(a=e.RemoveOuterParens(a))||void 0))}else Xt(n,r)}return n}},{key:"Parse",value:function(){this.Lex();var e=this.ParseExpression(new Ti);return e?e=Ei(e).head:null}}],[{key:"LongestToken",value:function(e,t){var n=void 0;for(var r in zn)if(Object.prototype.hasOwnProperty.call(zn,r)&&zn[r]instanceof Array)for(var i=0;i<zn[r].length;i++){var a=zn[r][i];"string"===typeof a&&(a=[a]);for(var o=a[0],s=0;s<a.length;s++)e.startsWith(a[s],t)&&(!n||n.str.length<a[s].length)&&(n={cat:r,str:o,orig:a[s]})}return n&&n.orig.startsWith("\\")&&t+n.orig.length<e.length&&" "===e[t+n.orig.length]&&(n.orig+=" "),n}},{key:"RemoveOuterParens",value:function(e){if(!e)return null;var t=Jt(e),n=Yt(e);return t.type===We.Character&&n.type===We.Character&&At(t)&&_t(n)&&(ai(t),ai(n)),e}}]),e}(),Pi=function(){function e(t){(0,dt.Z)(this,e),(0,it.Z)(this,"doc",void 0),(0,it.Z)(this,"isSupportedTable",(function(e){return 0===e.replace(/ /g,"").replace(/\[[^,]*,[^,]*\]/g,"").replace(/,/gm,"").length})),this.doc=document.createElement("div"),this.doc.innerHTML=t.replace(/\n/g,"")}return(0,ut.Z)(e,[{key:"Parse",value:function(){return this.ParseChildren(this.doc),this.doc.textContent.replace(/(^|\n)[0-9]*\)\s*/g,"$1")}},{key:"ParseChildren",value:function(e){for(var t=e.childNodes,n=0;n<t.length;n++){var r=t[n];this.ParseNode(r)}}},{key:"ParseNode",value:function(e){switch(e.nodeName.toLowerCase()){case"div":this.ParseDiv(e);break;case"span":this.ParseSpan(e);break;case"asciimath":this.ParseAscii(e);break;case"br":this.ParseBR(e);break;case"ol":this.ParseOl(e);break;case"ul":this.ParseUl(e);break;case"li":this.ParseLi(e);break;case"td":this.ParseTd(e);break;case"tr":this.ParseTr(e);break;case"tbody":this.ParseTbody(e);break;case"table":this.ParseTable(e);break;case"a":this.ParseHref(e);break;case"#text":break;default:var t=e.parentNode;t&&t.removeChild(e)}}},{key:"ParseDiv",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":"\n",n=e.textContent,r=document.createTextNode(t+n);e.parentNode.replaceChild(r,e)}},{key:"ParseOl",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":"\n",n=e.textContent,r=document.createTextNode(t+n);e.parentNode.replaceChild(r,e)}},{key:"ParseUl",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":"\n",n=e.textContent,r=document.createTextNode(t+n);e.parentNode.replaceChild(r,e)}},{key:"ParseSpan",value:function(e){this.ParseChildren(e);var t=e.textContent,n=document.createTextNode(t);e.parentNode.replaceChild(n,e)}},{key:"ParseLi",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":"\n",n=e.textContent,r=document.createTextNode(t+n);e.parentNode.replaceChild(r,e)}},{key:"ParseTd",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":",",n=e.textContent,r=document.createTextNode(t+n);e.parentNode.replaceChild(r,e)}},{key:"ParseTr",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":",",n=e.textContent,r=document.createTextNode(t+"["+n+"]");e.parentNode.replaceChild(r,e)}},{key:"ParseTbody",value:function(e){this.ParseChildren(e);var t=e.textContent,n=document.createTextNode(t);e.parentNode.replaceChild(n,e)}},{key:"ParseTable",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":"\n",n=xe(e.textContent),r=document.createTextNode("".concat(t).concat(this.isSupportedTable(n)?'<code class="asciimath">':"","\\table[").concat(n,"]").concat(this.isSupportedTable(n)?"</code>":""));e.parentNode.replaceChild(r,e)}},{key:"ParseHref",value:function(e){this.ParseChildren(e);var t=null===e.previousSibling?"":"\n",n=e.textContent,r=document.createTextNode(t+n);e.parentNode.replaceChild(r,e)}},{key:"ParseAscii",value:function(t){var n=t.textContent,r=e.CleanMathPixAscii(n),i=document.createTextNode('<code class="asciimath">'.concat(r,"</code>"));t.parentNode.replaceChild(i,t)}},{key:"ParseBR",value:function(e){var t=document.createTextNode("\n");e.parentNode.replaceChild(t,e)}}],[{key:"CleanMathPixAscii",value:function(e){for(var t=this.GetQuoteParts(e),n=e.endsWith(":}"),r=0;r<t.length;r+=2){if(null!==t[r].match(/^\{?\[[^\[\]]*\](,\[[^\[\]]*\])*$/)){var i=1;t[r].startsWith("{")&&(i=2),t[r]=t[r].substring(i,t[r].length-1);var a=t[r].split("],[");t[r]=a.join("\\n")}t[r]=t[r].replace(/\u0393\xf9\u2557/g,"").replace(this.TokenRegx,"\\$1\\space").replace(/\\root\\space/g,"\\root").replace(/\\sqrt\\space/g,"\\sqrt").replace(/uu ?/g,"\\cup\\space").replace(/nn ?/g,"\\cap\\space").replace(/xx ?/g,"\\times ").replace(/(\\)?times ?/g,"\\times\\space").replace(/X/g,"x").replace(/rarr ?/g,"->").replace(/quad ?/g,",").replace(/\s+/g,"").replace(/\\space/g," ").replace(/\^\(@\)/g,"\\deg ").replace(/,,+/g,",").replace(/square/g,"").replace(/\^\(\\arcsec\)/g,'"').replace(/=\?/g,"=").replace(/\/\//g,"/"),n&&(t[r]=t[r].replace(/f\(x\)=\(/,"f(x)={").replace(/^,/g,"").replace(/,$/g,""))}var o=t.join("");return o.startsWith("{")&&o.endsWith(":}")&&(o=o.replace(/\],\[/g,"\n").replace(/^\{:?\[/,"").replace(/\]:\}$/,"")),o}},{key:"GetQuoteParts",value:function(e){for(var t=e.split('"'),n=[],r=0;r<t.length;r++)t[r].endsWith("\\")&&r<t.length-1?(n.push(t[r].substring(0,t[r].length-1)+'"'+t[r+1]),r++):n.push(t[r]);return n}}]),e}();(0,it.Z)(Pi,"TokenRegx",/(root|oo|sqrt|abs|int|sum|lim|alpha|beta|gamma|delta|epsi|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|oo|rho|sigma|tau|upsilon|phi|chi|psi|omega|varphi|bar) ?/gi);var Ai=function(e,t,n){var r=n||0;if(e&&t){var i=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o=i.top>=a.top+r,s=i.left>=a.left,l=i.bottom<=a.bottom-r,c=i.right<=a.right;return o&&s&&l&&c}};function _i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Oi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ni(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Zi,Hi,Li=function(e){return""==e||/[\u0000-\u03FF]|[\u0600-\u077f]|[\u2200-\u22ff]|[\uf000-\uf1ff]|[\ud800-\udbff]|[\udc00-\udfff]|\uf215/g.test(e)},zi=function(){function e(t,n,r,i,a,o,s,l,c,u,d,h,p,m){(0,dt.Z)(this,e),(0,it.Z)(this,"props",void 0),(0,it.Z)(this,"oldProps",void 0),(0,it.Z)(this,"setSelectionState",void 0),(0,it.Z)(this,"setFlatlist",void 0),(0,it.Z)(this,"setInput",void 0),(0,it.Z)(this,"onClickSubmitButton",void 0),(0,it.Z)(this,"isLoading",void 0),(0,it.Z)(this,"setUndoStack",void 0),(0,it.Z)(this,"setPaste",void 0),(0,it.Z)(this,"editorCharacterLimitReached",void 0),(0,it.Z)(this,"setTranscribedContent",void 0),(0,it.Z)(this,"pasteContent",void 0),(0,it.Z)(this,"setPasteContent",void 0),(0,it.Z)(this,"setSearchSubmitType",void 0),(0,it.Z)(this,"searchId",void 0),(0,it.Z)(this,"strackId",void 0),(0,it.Z)(this,"trackId",void 0),(0,it.Z)(this,"isMobile",void 0),(0,it.Z)(this,"enableNewLineOnEnter",void 0),(0,it.Z)(this,"editorId",void 0),(0,it.Z)(this,"EquationTable",(function(e){for(var t=new Mi(e),n=t.Parse(),r=pi[e],i=[],a=[],o=[],s=0;s<r.length;s++){var l=(t=new Mi(r[s].variableAscii)).Parse();i.push(l),a.push(r[s].summary),o.push(Dr(void 0,void 0,!0))}return Yr(n,i,a,o)})),this.oldProps=t,this.props=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ni(Object(n),!0).forEach((function(t){(0,it.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ni(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),this.setSelectionState=t.setSelection,this.setFlatlist=t.setFlatList,this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleKey=this.handleKey.bind(this),this.insertOperation=this.insertOperation.bind(this),this.updateCursorPosition=this.updateCursorPosition.bind(this),this.reflectResponseToEditor=this.reflectResponseToEditor.bind(this),this.removeSelection=this.removeSelection.bind(this),this.renderOCR=this.renderOCR.bind(this),this.clearEditorState=this.clearEditorState.bind(this),n&&(this.onClickSubmitButton=n),r&&(this.isLoading=r),this.setUndoStack=this.props.setUndoStack,this.setPaste=t.setPaste,this.editorCharacterLimitReached=null!==i&&void 0!==i&&i,this.setTranscribedContent=a,this.pasteContent=null!==o&&void 0!==o?o:"",this.setPasteContent=s,this.setSearchSubmitType=l,this.searchId=null!==c&&void 0!==c?c:"",this.strackId=null!==u&&void 0!==u?u:"",this.trackId=null!==d&&void 0!==d?d:"",this.isMobile=h,this.editorId=p,this.enableNewLineOnEnter=m}return(0,ut.Z)(e,[{key:"removeSelection",value:function(){var e,t=_i(en(this.props.flatList));try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.id){var r=this.GetElementById(n.id);null===r||void 0===r||r.classList.remove("highlight"),null===r||void 0===r||r.classList.remove("highlightSubSup")}}}catch(a){t.e(a)}finally{t.f()}var i=nn(this.props.flatList,this.props.selection.start);this.setSelection(i,i),this.dispatchChanges()}},{key:"dispatchChanges",value:function(){var e,t;this.oldProps.selection!==this.props.selection&&(null===(e=this.setSelectionState)||void 0===e||e.call(this,this.props.selection));this.oldProps.flatList!==this.props.flatList&&(null===(t=this.setFlatlist)||void 0===t||t.call(this,this.props.flatList))}},{key:"setSelection",value:function(e,t){e===this.props.selection.start&&t===this.props.selection.end||(this.props.selection={start:e,end:t})}},{key:"insert",value:function(e){if(!this.editorCharacterLimitReached){var t;if(this.props.selection.start!==this.props.selection.end){var n,r=this.DeleteSelected();this.setSelection(r,r),null===(n=this.cursorElem)||void 0===n||n.classList.add("cursor")}var i=this.props.selection.start,o=this.props.mathMode;!1===o&&i&&!0===i.math&&i.next&&!0===(null===i||void 0===i||null===(t=i.next)||void 0===t?void 0:t.math)&&(o=!0);var s=ei(this.props.flatList,[this.props.selection.start]),l=s.node,c=s.mappedNodes,u=(0,a.Z)(c,1)[0];u=li(u,zr(e,void 0,o)),this.setSelection(u,u),this.props.flatList=l}}},{key:"insertObject",value:function(e){var t,n,r,i,o,s,l,c,u,d=e.id,h=e.type;if(!this.editorCharacterLimitReached){if(this.props.selection.start!==this.props.selection.end){var p,m=this.DeleteSelected();this.setSelection(m,m),null===(p=this.cursorElem)||void 0===p||p.classList.add("cursor")}var v,f=ei(this.props.flatList,[this.props.selection.start]),g=f.node,y=f.mappedNodes,b=(0,a.Z)(y,1)[0];switch(d){case"shape":var x=Kr(h);b=li(b,v=Dr(void 0,[zr(null===(t=x.shapeType)||void 0===t?void 0:t.char,void 0,!0),x],!0)),b=v.prev.children[0],this.setSelection(b,b),this.props.flatList=g;break;case"equationTable":b=li(b,v=this.EquationTable(h)),b=v.children[0],this.setSelection(b,b),this.props.flatList=g;break;case"matrix":b=li(b,v=Fr(null!==(n=e.row)&&void 0!==n?n:4,null!==(r=e.col)&&void 0!==r?r:4)),b=v.children[0],this.setSelection(b,b),this.props.flatList=g;break;case"muXBar":b=li(b,v=Dr(void 0,["\u03bc",Vr("x\u0304")],!0)),b=v.prev,this.setSelection(b,b),this.props.flatList=g;break;case"sigmaXBar":li(b,v=Dr(void 0,["\u03c3",Vr("x\u0304")],!0)),b=v.prev,this.setSelection(b,b),this.props.flatList=g;break;case"combination":case"permutation":var C=jr("permutation"===d?"P":"C");b=li(b,C),b=C.left,this.setSelection(b,b),this.props.flatList=g;break;case"log":var E=Jr("log");b=li(b,Dr(void 0,[E,Wr()],!0)),b=E,this.setSelection(b,b),this.props.flatList=g;break;case"positiveIon":var S=Dr(void 0,[Wr(),$r(Dr(void 0,["+"],!0))],!0);b=li(b,S),b=null===(i=S.next)||void 0===i?void 0:i.prev,this.setSelection(b,b),this.props.flatList=g;break;case"negativeIon":var I=Dr(void 0,[Wr(),$r(Dr(void 0,["-"],!0))],!0);b=li(b,I),b=null===(o=I.next)||void 0===o?void 0:o.prev,this.setSelection(b,b),this.props.flatList=g;break;case"defIntegral":case"indefIntegral":var k=Ur(Dr(void 0,void 0,!0),Dr(void 0,void 0,!0),"defIntegral"===d);b=li(b,k),b=null===(s=k.prev)||void 0===s?void 0:s.next,this.setSelection(b,b),this.props.flatList=g;break;case"summation":var w=Qr(Dr(void 0,void 0,!0),Dr(void 0,void 0,!0));b=li(b,w),b=null===(l=w.prev)||void 0===l?void 0:l.next,this.setSelection(b,b),this.props.flatList=g;break;case"sqrt":var T=Gr();T.hungry=!0,b=li(b,T),b=T.radicand,this.setSelection(b,b),this.props.flatList=g;break;case"nthrt":var M=Gr(void 0,void 0,!0);M.hungry=!0,b=li(b,M),b=M.index,this.setSelection(b,b),this.props.flatList=g;break;case"table":var P=Xr("x","y");b=li(b,P),b=P.children[2],this.setSelection(b,b),this.props.flatList=g;break;case"xPxTable":var A=Xr("x","P(x)");b=li(b,A),b=A.children[2],this.setSelection(b,b),this.props.flatList=g;break;case"lim":var _=Br(Dr(void 0,[Wr(),"\u2192",Wr()],!0));b=li(b,_),b=_.contents,this.setSelection(b,b),this.props.flatList=g;break;case"scientific":var O=Dr(void 0,[Wr(),"\xd7","1","0",$r()],!0);b=li(b,O),b=null===(c=O.next)||void 0===c?void 0:c.prev,this.setSelection(b,b),this.props.flatList=g;break;case"nlog":var N=Dr(void 0,void 0,!0);b=li(b,Dr(void 0,[Jr("log"),Vr(N),Wr()],!0)),b=N,this.setSelection(b,b),this.props.flatList=g;break;case"point":var Z="set_open"===d?"]":")";b=li(b,Dr(void 0,["set_close"===d?"[":"(",Wr(),",",Wr(),Z],!0)),this.setSelection(b,b),this.props.flatList=g;break;case"fraction":var H=Rr();b=li(b,H),b=H.numerator,this.setSelection(b,b),this.props.flatList=g;break;case"mixed":var L=Dr(void 0,[Wr(),Rr()],!0);b=li(b,L),b=null===(u=L.next)||void 0===u?void 0:u.prev,this.setSelection(b,b),this.props.flatList=g;break;case"piecewise":var z=qr(2);b=li(b,Dr(void 0,[z],!0)),b=z.children[0],this.setSelection(b,b),this.props.flatList=g;break;case"pow":var R=$r();b=li(b,Dr(void 0,[Wr(),R],!0)),this.setSelection(b,b),this.props.flatList=g;break;case"sub":var D=Vr();b=li(b,Dr(void 0,[Wr(),D],!0)),this.setSelection(b,b),this.props.flatList=g;break;case"function":var U=Dr(void 0,["f","(","x",")"],!0);b=li(b,U),b=U.prev,this.setSelection(b,b),this.props.flatList=g;break;case"trig":case"ln":var B=e.name.match(/^([a-z]*)([^a-z]*)$/);if(B){var F,j,q=B[1],W=B[2],G=W.split("");if("^"===W)G=[$r()];G.unshift(Jr(q));var K=Dr(void 0,G,!0);li(b,K),b="^"===W?null===(F=K.prev)||void 0===F||null===(j=F.contents)||void 0===j?void 0:j.next:K.prev,this.setSelection(b,b),this.props.flatList=g}break;case"element":var V=Dr(void 0,e.symbol.split(""),!0);li(b,V),b=V.prev,this.setSelection(b,b),this.props.flatList=g;break;case"accent":var Q=Lr(Dr(void 0,void 0,!0),"\\"+e.name);li(b,Q),b=Q.contents}}}},{key:"insertOperation",value:function(e){switch(e.id){case"backspace":this.Backspace();break;case"erase":un(this.props.flatList),this.setSelection(this.props.flatList,this.props.flatList);break;case"left_arrow":this.MoveCursor(!1,Gt(this.props.selection.start));break;case"right_arrow":this.MoveCursor(!1,Kt(this.props.selection.start))}this.dispatchChanges()}},{key:"submit",value:function(){this.onClickSubmitButton&&this.onClickSubmitButton(C.ENTER_SUBMIT)}},{key:"handleMouseDown",value:function(e){var t;if(this.props.prefix&&(null===(t=document)||void 0===t?void 0:t.getElementById(this.props.prefix+this.editorId))){var n=this.makeFlatlistMap(),r=this.MakeElementDataMap(),i=this.MakeLineElementMapOnDOM(n);this.props.setLineElementMap&&this.props.setLineElementMap(i);var a=0,o=0,s=Number.MAX_VALUE;i.forEach((function(t,n){e.clientY>t.boundary.minHeight&&e.clientY<t.boundary.maxHeight&&(a=n);var r=Math.min(Math.abs(e.clientY-t.boundary.minHeight),Math.abs(e.clientY-t.boundary.maxHeight));s>r&&(s=r,o=n)})),0==a&&(a=o),this.props.setCurrentLine(a);var l=i.get(a);if(l){var c=this.FindNearestNodeInLine(e.clientX,e.clientY,r,l.nodes),u=/[(<{,\\/|\u201d":;?&@#$^*.=-_+*!%^~\u21b5`)>\-}]/i;if(e.detail>=2){for(var d=c,h=c;null!==d;){var p,m,v,f;if(" "===(null===(p=d)||void 0===p?void 0:p.value)||void 0===(null===(m=d)||void 0===m?void 0:m.value)||u.test(null===(v=d)||void 0===v?void 0:v.value)&&!/[a-zA-Z]/.test(null===(f=d)||void 0===f?void 0:f.value))break;d=d.next}for(;null!==h;){var g,y,b,x;if(" "==(null===(g=h)||void 0===g?void 0:g.value)||void 0==(null===(y=h)||void 0===y?void 0:y.value)||u.test(null===(b=h)||void 0===b?void 0:b.value)&&!/[a-zA-Z]/.test(null===(x=h)||void 0===x?void 0:x.value))break;h=h.prev}this.setSelection(h,d.prev),this.dispatchChanges()}else this.setSelection(c,c),0==e.button&&this.dispatchChanges()}}}},{key:"getTrimmedContent",value:function(e){if(this.props.input){var t=5e3-this.props.input.length;return t<=0?"":e.slice(0,t)}return e.slice(0,5e3)}},{key:"renderOCR",value:function(e){var t,n=e;n=new Pi(e).Parse(),n=this.getTrimmedContent(n),null===(t=this.setTranscribedContent)||void 0===t||t.call(this,n);var r=document.createElement("div");r.innerHTML=n;var i,a="",o=_i(r.childNodes);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.nodeType===Node.TEXT_NODE?a+="<p>".concat(s.textContent,"</p>"):s.nodeType===Node.ELEMENT_NODE&&(a+=s.outerHTML)}}catch(l){o.e(l)}finally{o.f()}a="<div>".concat(a,"</div>"),this.handleReconstruct(a),this.dispatchChanges()}},{key:"reflectResponseToEditorInput",value:function(e){var t=new yi(e);if(this.props.selection.start===this.props.selection.end){var n=t.Parse();if(null!==n&&void 0!==n&&n.prev){var r=n.prev;li(this.props.selection.start,n),this.setSelection(r,r)}}}},{key:"reflectResponseToEditor",value:function(e,t){Li(e)&&(e=String(e),t?(e=e.replace(/^\s+|\s+$/g,""),this.reflectResponseToEditorInput(e)):this.reflectResponseToEditorInput(e))}},{key:"handleMouseMove",value:function(e){if(1===e.buttons&&(this.props.prefix&&document.getElementById(this.props.prefix+this.editorId))){var t=this.MakeElementDataMap(),n=this.FindNearestNode(e.clientX,e.clientY,t);this.setSelection(this.props.selection.start,n)}this.dispatchChanges()}},{key:"handleCopy",value:function(){var e=oi(this.props.selection.start,this.props.selection.end);if(e.length){var t="";e.map((function(e){t=(t+=jn(e)).replace(/<code class="asciimath">|<\/code>/g,"")})),navigator.clipboard.writeText(t).then((function(){console.log("Text copied to clipboard",t)})).catch((function(e){console.error("Failed to copy text: ",e)}))}else console.error("no selected input")}},{key:"FindNearestNodeInLine",value:function(e,t,n,r){var i,a,o=this.props.flatList,s=Number.MAX_VALUE,l=1,c=r[0],u=_i(r);try{for(u.s();!(a=u.n()).done;){var d=a.value,h=ui(d,n);if(h){var p=Math.pow(e-h.x,2)+Math.pow(t-h.y,2);p<s&&(o=d,s=p),1==l&&(i=h)}l+=1}}catch(y){u.e(y)}finally{u.f()}if(null!==c&&void 0!==c&&c.id){var m=document.getElementById(c.id),v=null===m||void 0===m?void 0:m.getBoundingClientRect().x;if(v&&i&&e<=v){var f=ui(o,n),g=ui(o.prev,n);return g&&f&&g.x>f.x&&this.props&&this.props.setCursorAdjustmentNeed(!0),o.prev}}return o}},{key:"FindNearestNode",value:function(e,t,n){var r,i=this.props.flatList,a=Number.MAX_VALUE,o=_i(en(this.props.flatList));try{for(o.s();!(r=o.n()).done;){var s=r.value,l=ui(s,n);if(l){var c=Math.pow(e-l.x,2)+Math.pow(t-l.y,2);c<a&&(i=s,a=c)}}}catch(u){o.e(u)}finally{o.f()}return i}},{key:"handleKey",value:function(e){var t,n,r=!1,i=null===(t=document)||void 0===t?void 0:t.querySelector(".mathContainer".concat(this.editorId?"-":"").concat(this.editorId)),a=null===(n=document)||void 0===n?void 0:n.getElementById("editor01-"+this.editorId+"-cursor"),o=function(e,t){var n=Ai(a,i,24);e?function(e){if("undefined"!==typeof window)if("ArrowDown"==e||"ArrowRight"==e)setTimeout((function(){var e,t,n=null===(e=document)||void 0===e?void 0:e.getElementsByClassName("highlight"),r=null===n||void 0===n?void 0:n.length;(null===n||void 0===n?void 0:n.length)>1&&!Ai(n[r-1],i,24)&&(null===(t=n[r-1])||void 0===t||t.scrollIntoView({behavior:"auto",block:"nearest",inline:"start"}))}),0);else if("ArrowUp"==e||"ArrowLeft"==e){var t,n=null===(t=document)||void 0===t?void 0:t.getElementsByClassName("highlight");(null===n||void 0===n?void 0:n.length)>1&&!Ai(n[0],i,24)&&setTimeout((function(){var e;null===(e=n[0])||void 0===e||e.scrollIntoView({behavior:"auto",block:"nearest",inline:"start"})}),0)}}(t):!n&&i&&a&&!e&&setTimeout((function(){null===a||void 0===a||a.scrollIntoView({behavior:"auto",block:"nearest",inline:"start"})}),0)};switch(e.key){case"Backspace":this.Backspace(),r=!0;break;case"Enter":if(e.shiftKey||e.ctrlKey){var s=this.MakeLineElementMapOnDOM(this.makeFlatlistMap());this.props.setLineElementMap(s),this.insert(bt)}else if(this.isMobile)this.insert(bt);else{var l;if(!be(this.props.input)||this.editorCharacterLimitReached||this.enableNewLineOnEnter||this.isLoading)this.enableNewLineOnEnter&&this.insert(bt);else null===(l=this.setSearchSubmitType)||void 0===l||l.call(this,C.ENTER_SUBMIT),this.submit()}r=!0;break;case"End":this.MoveCursor(e.shiftKey,nn(this.props.flatList,this.props.selection.start)),r=!0;break;case"Home":this.MoveCursor(e.shiftKey,rn(this.props.flatList,this.props.selection.start)),r=!0;break;case"ArrowLeft":this.MoveCursor(e.shiftKey,Gt(this.props.selection.start)),o(e.shiftKey,e.key),r=!0;break;case"ArrowUp":this.MoveCursor(e.shiftKey,this.FindUp(this.props.selection.start)),o(e.shiftKey,e.key),r=!0;break;case"\t":case"ArrowRight":this.props.selection.start!==this.props.selection.end&&an(this.props.flatList,this.props.selection.start,this.props.selection.end)?this.MoveCursor(e.shiftKey,Kt(this.props.selection.end)):this.MoveCursor(e.shiftKey,Kt(this.props.selection.start)),o(e.shiftKey,e.key),r=!0;break;case"ArrowDown":this.MoveCursor(e.shiftKey,this.FindDown(this.props.selection.start)),o(e.shiftKey,e.key),r=!0;break;case"Delete":this.Delete(),r=!0;break;case"a":case"A":e.ctrlKey||e.metaKey?(this.setSelection(this.props.flatList,Yt(this.props.flatList)),this.Select()):this.insert(e.key),r=!0;break;case"/":case"'":e.shiftKey&&this.props.isFirefox?r=!1:(this.insert(e.key),r=!0);break;case"x":e.ctrlKey||e.metaKey?this.handleCtrlX():this.insert(e.key),r=!0;break;case"v":e.ctrlKey||e.metaKey?(this.handlePaste(),this.setPaste&&this.setPaste(!0)):this.insert(e.key),r=!0;break;case"c":e.ctrlKey||e.metaKey?this.handleCopy():this.insert(e.key),r=!0;break;case"r":e.ctrlKey||e.metaKey?window.location.reload():this.insert(e.key),r=!0;break;case"z":e.ctrlKey||e.metaKey?this.handleUndo():this.insert(e.key),r=!0;break;default:/[a-zA-Z0-9]{2,}/.test(e.key)?e.key&&this.isMobile&&229!=e.keyCode&&16!=e.keyCode&&20!=e.keyCode&&91!=e.keyCode&&17!=e.keyCode&&224!=e.keyCode&&9!=e.keyCode&&18!=e.keyCode&&27!=e.keyCode&&93!=e.keyCode?(this.reflectResponseToEditor(e.key),r=!0):r=!1:(this.insert(e.key),r=!0)}r&&(e.stopPropagation(),e.preventDefault()),this.dispatchChanges()}},{key:"handleMobileKey",value:function(e){var t=!1;switch(e.data){case"Backspace":this.Backspace(),t=!0;break;case"Enter":if(e.shiftKey||e.ctrlKey){var n=this.MakeLineElementMapOnDOM(this.makeFlatlistMap());this.props.setLineElementMap(n),this.insert(bt)}else be(this.props.input)&&!this.editorCharacterLimitReached&&this.submit();t=!0;break;case"End":this.MoveCursor(e.shiftKey,nn(this.props.flatList,this.props.selection.start)),t=!0;break;case"Home":this.MoveCursor(e.shiftKey,rn(this.props.flatList,this.props.selection.start)),t=!0;break;case"ArrowLeft":this.MoveCursor(e.shiftKey,Gt(this.props.selection.start)),t=!0;break;case"ArrowUp":this.MoveCursor(e.shiftKey,this.FindUp(this.props.selection.start)),t=!0;break;case"\t":case"ArrowRight":this.props.selection.start!==this.props.selection.end&&an(this.props.flatList,this.props.selection.start,this.props.selection.end)?this.MoveCursor(e.shiftKey,Kt(this.props.selection.end)):this.MoveCursor(e.shiftKey,Kt(this.props.selection.start)),t=!0;break;case"ArrowDown":this.MoveCursor(e.shiftKey,this.FindDown(this.props.selection.start)),t=!0;break;case"Delete":this.Delete(),t=!0;break;case"a":case"A":e.ctrlKey||e.metaKey?(this.setSelection(this.props.flatList,Yt(this.props.flatList)),this.Select()):this.insert(e.data),t=!0;break;case"/":case"'":e.shiftKey&&this.props.isFirefox?t=!1:(this.insert(e.data),t=!0);break;case"x":e.ctrlKey||e.metaKey?this.handleCtrlX():this.insert(e.data),t=!0;break;case"v":e.ctrlKey||e.metaKey?(this.handlePaste(),this.setPaste&&this.setPaste(!0)):this.insert(e.data),t=!0;break;case"c":e.ctrlKey||e.metaKey?this.handleCopy():this.insert(e.data),t=!0;break;case"r":e.ctrlKey||e.metaKey?window.location.reload():this.insert(e.data),t=!0;break;case"z":e.ctrlKey||e.metaKey?this.handleUndo():this.insert(e.data),t=!0;break;default:/[a-zA-Z0-9]{2,}/.test(e.data)?e.data&&229!=e.keyCode?(this.reflectResponseToEditor(e.data),t=!0):t=!1:(this.insert(e.data),t=!0)}t&&(e.stopPropagation(),e.preventDefault()),this.dispatchChanges()}},{key:"handleCtrlX",value:function(e,t){var n=e||this.props.selection.start,r=t||this.props.selection.end,i=oi(n,r),a={operation:Ue,start:n,end:r,nodes:i};if(this.setUndoSelectionRange(a),this.handleCopy(),i.length){var o=ei(this.props.flatList,i);i=o.mappedNodes,this.props.flatList=o.node;var s,l=r,c=_i(i);try{for(c.s();!(s=c.n()).done;){l=ri(s.value)}}catch(u){c.e(u)}finally{c.f()}this.setSelection(l,l)}this.dispatchChanges()}},{key:"handleCut",value:function(e,t){var n=sn(this.props.flatList,t,e),r=n.startNode,i=n.endNode,a=oi(r,i);this.setSelection(r,i);var o={operation:Ue,start:r,end:i,nodes:a};if(this.setUndoSelectionRange(o),a.length){var s=ei(this.props.flatList,a);a=s.mappedNodes,this.props.flatList=s.node;var l,c=this.props.selection.end,u=_i(a);try{for(u.s();!(l=u.n()).done;){c=ri(l.value)}}catch(d){u.e(d)}finally{u.f()}this.setSelection(c,c)}this.dispatchChanges()}},{key:"handleSelect",value:function(e,t){var n=sn(this.props.flatList,t,e),r=n.startNode,i=n.endNode;this.setSelection(r,i),this.Select()}},{key:"handlePaste",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";navigator.clipboard.readText?navigator.clipboard.readText().then((function(t){e.setPasteContent&&e.setPasteContent(t),e.reflectPastedContentToEditor(t)})).catch((function(e){console.error("Failed to read clipboard data:",e)})):this.reflectPastedContentToEditor(t)}},{key:"reflectPastedContentToEditor",value:function(e){if(Li(e)){e=String(e),e=(e=this.getTrimmedContent(e)).replace(/^\s+|\s+$/g,"");var t=new yi(e);if(this.props.selection.start!==this.props.selection.end){var n,r=this.DeleteSelected();this.setSelection(r,r),null===(n=this.cursorElem)||void 0===n||n.classList.add("cursor"),this.dispatchChanges()}var i=t.Parse();if(null!==i&&void 0!==i&&i.prev){var a=i.prev;li(this.props.selection.start,i),this.setSelection(a,a),this.dispatchChanges()}}}},{key:"clearEditorState",value:function(){this.props.selection.start!==this.props.selection.end&&this.handleCopy(),un(this.props.flatList),this.setSelection(this.props.flatList,this.props.flatList)}},{key:"Backspace",value:function(){if(this.props.selection.start===this.props.selection.end)if(function(e){var t,n,r,i,a,o,s,l;return e.type===We.Head?(null===(t=e.parent)||void 0===t?void 0:t.type)===We.Fraction?e.parent.numerator===e&&!Wt(e):(null===(n=e.parent)||void 0===n?void 0:n.type)===We.Table?e.parent.children.indexOf(e)%2===1&&!Wt(e.parent):(null===(r=e.parent)||void 0===r?void 0:r.type)===We.Piecewise?0===e.parent.children.indexOf(e)&&!Wt(e.parent):((null===(i=e.parent)||void 0===i?void 0:i.type)===We.Limit||(null===(a=e.parent)||void 0===a?void 0:a.type)===We.Integral||(null===(o=e.parent)||void 0===o?void 0:o.type)===We.Summation||(null===(s=e.parent)||void 0===s?void 0:s.type)===We.PermComb||(null===(l=e.parent)||void 0===l?void 0:l.type)===We.Matrix)&&!Wt(e.parent):e.type===We.Character?Pt(e)&&e.grey:e.type===We.Superscript||e.type===We.Subscript?!Wt(e.contents):e.type!==We.Placeholder&&e.type!==We.ShapeTable&&e.type!==We.TrigLog&&!!ht(e)&&!Wt(e)}(this.props.selection.start)){var e=Gt(this.props.selection.start);this.setSelection(e,e)}else{var t,n=this.props.selection.start,r=ei(this.props.flatList,[n]);n=r.mappedNodes[0],this.props.flatList=r.node;var i={operation:Be,start:this.props.selection.start,end:this.props.selection.end,nodes:[n]};this.setUndoSelectionRange(i),n=n.type===We.TrigLog&&"log"===n.value&&(null===(t=n.next)||void 0===t?void 0:t.type)===We.Placeholder?ai(n.next):ai(n),this.setSelection(n,n)}else{var a,o=this.DeleteSelected();this.setSelection(o,o),null===(a=this.cursorElem)||void 0===a||a.classList.add("cursor")}}},{key:"Delete",value:function(){if(this.props.selection.start===this.props.selection.end){var e=Kt(this.props.selection.start);if(function(e){var t,n,r,i,a,o,s,l;return e.type===We.Head?(null===(t=e.parent)||void 0===t?void 0:t.type)===We.Fraction?e.parent.numerator===e&&!Wt(e.parent):(null===(n=e.parent)||void 0===n?void 0:n.type)===We.Table?e.parent.children.indexOf(e)%2===1&&!Wt(e.parent):(null===(r=e.parent)||void 0===r?void 0:r.type)===We.Piecewise?0===e.parent.children.indexOf(e)&&!Wt(e.parent):((null===(i=e.parent)||void 0===i?void 0:i.type)===We.Limit||(null===(a=e.parent)||void 0===a?void 0:a.type)===We.Integral||(null===(o=e.parent)||void 0===o?void 0:o.type)===We.Summation||(null===(s=e.parent)||void 0===s?void 0:s.type)===We.PermComb||(null===(l=e.parent)||void 0===l?void 0:l.type)===We.Matrix)&&!Wt(e.parent):e.type===We.Character?Pt(e)&&e.grey:e.type===We.Superscript||e.type===We.Subscript?!Wt(e.contents):e.type!==We.Placeholder&&e.type!==We.ShapeTable&&e.type!==We.TrigLog&&!!ht(e)&&!Wt(e)}(e))this.setSelection(e,e);else if(e!==this.props.selection.start){var t=ei(this.props.flatList,[e]);this.props.flatList=t.node;var n=ai(t.mappedNodes[0]);this.setSelection(n,n)}}else{var r,i=this.DeleteSelected();this.setSelection(i,i),null===(r=this.cursorElem)||void 0===r||r.classList.add("cursor")}}},{key:"MoveCursor",value:function(e,t){e?(this.setSelection(t,this.props.selection.end),this.ReSelect()):this.setSelection(t,t)}},{key:"cursorElem",get:function(){return this.GetElementById(this.props.prefix+(this.editorId||"")+"-cursor")}},{key:"FindUpOrDown",value:function(e,t){var n,r=this.MakeElementDataMap(),i=ui(e,r)||{x:0,y:0,size:0,elem:e},a="";a=t?"denominator":"numerator";var o,s=i.size/4,l=function(e,t){for(var n=qt(e);;){if(!n.parent)return null;if(n.parent.type===We.Fraction&&Object.prototype.hasOwnProperty.call(n.parent,t)&&n.parent[t]===n)return n.parent;n=qt(n.parent)}}(e,a),c=function(e){for(var t=qt(e);;){if(!t.parent)return null;if(t.parent.type===We.Piecewise){var n={obj:t.parent},r=t.parent.children.indexOf(t);return n.above=r<1?null:t.parent.children[r-1],n.below=r>t.parent.children.length-2?null:t.parent.children[r+1],n}if(t.parent.type===We.Table){var i={obj:t.parent},a=t.parent.children.indexOf(t);return i.above=a<2?null:t.parent.children[a-2],i.below=a>t.parent.children.length-3?null:t.parent.children[a+2],i}t=qt(t.parent)}}(e),u=qt(e),d=function(t){return t.elem!==e&&i.y-t.y>s&&5*(i.y-t.y)>Math.abs(i.x-t.x)},h=function(t){return t.elem!==e&&t.y-i.y>s&&5*(t.y-i.y)>Math.abs(i.x-t.x)};if(l)u=t?l.numerator:l.denominator;else if(c)u=t?c.above?c.above:u:c.below?c.below:u;else{if(on(this.props.flatList)){var p=function(e,t){for(var n=[],r={index:-1},i=[],a=e.next,o=en(e),s=0;s<o.length;s++)a=o[s],i.push(a),a===t&&(r.index=n.length);return n.push(i),r.array=n,r}(this.props.flatList,e),m=p.array,v=p.index;return-1!==v&&(t&&v>0?u=m[v-1]:!t&&v<m.length-1&&(u=m[v+1]),o=di(u,i.x,i.y,r,t?d:h)),o?o.elem:e}u.parent&&ht(null===(n=u)||void 0===n?void 0:n.parent)&&(u=u.parent,d=function(t){return t.elem!==e&&t.elem!==u&&i.y-t.y>s&&5*(i.y-t.y)>Math.abs(i.x-t.x)},h=function(t){return t.elem!==e&&t.elem!==u&&t.y-i.y>s&&5*(t.y-i.y)>Math.abs(i.x-t.x)})}return(o=di(u,i.x,i.y,r,t?d:h))?o.elem:e}},{key:"FindUp",value:function(e){return this.FindUpOrDown(e,!0)}},{key:"FindDown",value:function(e){return this.FindUpOrDown(e,!1)}},{key:"GetElementById",value:function(e){var t;return null!==(t=document.getElementById(e))&&void 0!==t?t:void 0}},{key:"Select",value:function(){var e,t,n,r,i=_i(oi(this.props.selection.start,this.props.selection.end));try{for(i.s();!(e=i.n()).done;){var a,o=e.value,s=void 0;s=o.type===We.Subscript||o.type===We.Superscript?"highlightSubSup":"highlight",o.type===We.Character&&Ht(o)||null===(a=this.GetElementById("#"+o.id))||void 0===a||a.classList.add(s)}}catch(l){i.e(l)}finally{i.f()}this.props.selection.start!==this.props.selection.end?(null===(t=this.cursorElem)||void 0===t||t.classList.remove("cursorBlinking"),null===(n=this.cursorElem)||void 0===n||n.classList.remove("cursor")):null===(r=this.cursorElem)||void 0===r||r.classList.add("cursor");this.dispatchChanges()}},{key:"ReSelect",value:function(){var e,t=_i(oi(this.props.selection.start,this.props.selection.end));try{for(t.s();!(e=t.n()).done;){var n,r,i=e.value;null===(n=this.GetElementById("#"+this.props.prefix+"elem"+i.id))||void 0===n||n.classList.remove("highlight"),null===(r=this.GetElementById("#"+this.props.prefix+"elem"+i.id))||void 0===r||r.classList.remove("highlightSubSup")}}catch(a){t.e(a)}finally{t.f()}this.Select()}},{key:"DeleteSelected",value:function(){var e,t=oi(this.props.selection.start,this.props.selection.end),n={operation:Ue,start:this.props.selection.start,end:this.props.selection.end,nodes:t};if(this.setUndoSelectionRange(n),0===t.length)return this.props.flatList;var r=t[0].prev;t.includes(this.props.flatList)&&(r=this.props.flatList);for(var i=0;i<t.length;i++)ri(t[i]);return t=[],null===(e=this.cursorElem)||void 0===e||e.classList.add("cursor"),r}},{key:"SelectedNodes",value:function(){var e=[];if(this.props.selection.start===this.props.selection.end)return e;var t,n=[this.props.selection.start,this.props.selection.end],r=!1,i=_i(en(this.props.flatList));try{for(i.s();!(t=i.n()).done;){var a=t.value;if(r&&e.push(a),n.includes(a)){if(r)return e.push(a),e;r=!0}}}catch(o){i.e(o)}finally{i.f()}throw"Selection node not found"}},{key:"updateCursorPosition",value:function(){var e,t,n,r=this,i=this.SelectedNodes(),a=_i(en(this.props.flatList));try{for(a.s();!(e=a.n()).done;){var o=e.value;if(o.id){var s=this.GetElementById(o.id);if(i.includes(o)){var l=void 0;l=o.type===We.Subscript||o.type===We.Superscript?"highlightSubSup":"highlight",o.type===We.Character&&Ht(o)||null===s||void 0===s||s.classList.add(l)}else null===s||void 0===s||s.classList.remove("highlight"),null===s||void 0===s||s.classList.remove("highlightSubSup")}}}catch(u){a.e(u)}finally{a.f()}if(this.props.selection.start!==this.props.selection.end)null===(t=this.cursorElem)||void 0===t||t.classList.remove("cursor");else if(null===(n=this.cursorElem)||void 0===n||n.classList.add("cursor"),this.props.prefix&&this.props.selection.start.id){var c=this.props.prefix+this.editorId+"-cursor";window.requestAnimationFrame((function(){for(var e=r.MakeElementDataMap(),t=0,n=Object.keys(e);t<n.length;t++){var i,a=n[t];null===(i=r.GetElementById(a))||void 0===i||i.classList.remove("highlight")}var o,s,l=ui(r.props.selection.start,e),u=document.getElementById(c);if(l&&u&&(null===(o=r.cursorElem)||void 0===o||o.classList.add("cursor"),r.props.prefix&&(s=document.getElementById(r.props.prefix+r.editorId)),null!=s)){if(r.props.cursorAdjustmentNeed){if(r.props.selection.start){var d=r.props.selection.start.next,h=ui(d,e);if(h){var p=null===d||void 0===d?void 0:d.id;if(p){var m,v=null===(m=document.getElementById(p))||void 0===m?void 0:m.getBoundingClientRect().width;v&&(u.style.left=h.x-v-s.getBoundingClientRect().left+"px",u.style.top=h.y-l.size-s.getBoundingClientRect().top+"px")}}r.props.setCursorAdjustmentNeed(!1)}}else u.style.left=l.x-s.getBoundingClientRect().left+"px",u.style.top=l.y-l.size-s.getBoundingClientRect().top+"px";u.style.height=l.size+"px"}}))}}},{key:"makeFlatlistMap",value:function(){var e,t=new Map,n=_i(en(this.props.flatList));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.id&&t.set(r.id,r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"MakeElementDataMap",value:function(){var e,t=new Map,n=_i(en(this.props.flatList));try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.id){var i=document.getElementById(r.id);i&&t.set(r.id,this.ElementDataFromElement(i))}}}catch(o){n.e(o)}finally{n.f()}if(this.props.prefix){var a=document.getElementById("EditorElement_0");a&&t.set("root",this.ElementDataFromElement(a))}return t}},{key:"MakeLineElementMapOnDOM",value:function(e){var t,n=0,r=1,i=0,a=0,o=0,s=null===(t=document.getElementById("MathDisplayContainer"))||void 0===t?void 0:t.getBoundingClientRect().width,l=new Map,c=document.getElementById("MathJaxSpan-"+this.editorId);if(c&&s)for(var u=c.childNodes,d=[],h=0;h<u.length;h++){var p=u[h];if(p.childNodes)for(var m=0;m<p.childNodes.length;m++){var v=p.childNodes[m],f=0,g=0,y=0;if(p.childNodes[m+1]){var b=p.childNodes[m+1];f=b.getBoundingClientRect().width,g=b.getBoundingClientRect().x,y=v.getBoundingClientRect().x}if(v&&"#text"!=v.nodeName){var x,C,E,S=v.getBoundingClientRect().width;i+=1,n+=S;var I=v.getBoundingClientRect().top;1==i&&(a=I),a>I&&0!=(null===(x=v.textContent)||void 0===x?void 0:x.trim().length)&&(a=I);var k=v.getBoundingClientRect().bottom;if(o<k&&0!=(null===(C=v.textContent)||void 0===C?void 0:C.trim().length)&&(o=k),e.get(v.id)&&d.push(e.get(v.id)),"math"==v.nodeName||"equationTableOuter"==v.className){var w=[];this.recurseChildNodes(v,w);for(var T=0;T<w.length;T++){var M=w[T];e.get(M.id)&&d.push(e.get(M.id))}}var P={lineWidth:n,boundary:{minHeight:a,maxHeight:o},nodes:d};l.set(r,P),(y>g&&0!=f||0==S&&0==(null===(E=v.textContent)||void 0===E?void 0:E.trim().length)&&0!=m&&1!=i||m+1==p.childNodes.length)&&(l.set(r,P),r+=1,n=0,a=o,o=0,d=[])}}}return l}},{key:"recurseChildNodes",value:function(e,t){if(e&&e.childNodes)for(var n=0;n<e.childNodes.length;n++){var r=null===e||void 0===e?void 0:e.childNodes[n];t.push(r),this.recurseChildNodes(r,t)}}},{key:"ElementDataFromElement",value:function(e){var t,n,r=e.getBoundingClientRect(),i=30,a=0;return e&&null!==(t=e.style)&&void 0!==t&&t.fontSize&&(i=parseFloat(e.style.fontSize)),e&&null!==(n=e.style)&&void 0!==n&&n.paddingLeft&&(a=parseFloat(e.style.paddingLeft)),{left:r.left,top:r.top+12,width:r.width,height:r.height,fontSize:i,padLeft:a,isMathChar:e.className.startsWith("mjx")}}},{key:"handleReconstruct",value:function(e){try{for(var t=(new DOMParser).parseFromString(e,"text/html").documentElement.getElementsByTagName("DIV"),n=0;n<t.length;n++)this.handle(t[n]);this.updateCursorPosition(),this.dispatchChanges()}catch(r){(0,y.O7)({error:"".concat($n.COULD_NOT_RESTORE_UIC_STATE,": Unable to restore UIC state."),location:Xn.UIC_EDITOR,severity:y.zb.ERROR},{inputHtml:e,teamName:Me.GARUDA})}}},{key:"handle",value:function(e){if(e.hasChildNodes())for(var t=0,n=Array.from(e.children);t<n.length;t++){var r=n[t];this.handle(r)}e.textContent&&e.className.toLowerCase()=="asciimath".toLowerCase()?this.handleAscii(e.textContent):e.textContent&&"p"==e.tagName.toLowerCase()&&this.handleText(e.textContent)}},{key:"handleAscii",value:function(e){e=e.replace(Ge,"");var t=new Mi(e).Parse();if(null!==t&&void 0!==t&&t.prev){var n=t.prev;li(this.props.selection.start,t),this.setSelection(n,n)}}},{key:"handleText",value:function(e){var t=new yi(e).Parse();if(null!==t&&void 0!==t&&t.prev){var n=t.prev;li(this.props.selection.start,t),this.setSelection(n,n)}}},{key:"extractImageUrl",value:function(e){var t=[];if(e&&e.length>0){var n=(new DOMParser).parseFromString(e,"text/html").getElementsByTagName("img");Array.from(n).forEach((function(e){return t.push(e.src)}))}return t.length>0?t:[]}},{key:"handleUndo",value:function(){if(this.props.undoStack.length<1)console.warn("Nothing in undo stack");else{var e=this.props.undoStack[this.props.undoStack.length-1];if(e.operation===Ue){for(var t=0;t<e.nodes.length;t++){var n=li(this.props.selection.start,e.nodes[t]);this.setSelection(n,n)}this.props.undoStack.pop()}else if(e.operation===Be){var r=li(this.props.selection.start,e.nodes[0]);this.setSelection(r,r),this.props.undoStack.pop()}this.updateCursorPosition()}}},{key:"setUndoSelectionRange",value:function(e){this.setUndoStack&&this.setUndoStack([].concat((0,at.Z)(this.props.undoStack),[e]))}}],[{key:"insertAndDispatch",value:function(t,n,r){var i=new e(t,void 0,!0);n&&i.insert(n),r.id&&i.insertObject(r),i.dispatchChanges()}}]),e}(),Ri=zi,Di=Dr(),Ui={flatList:Di,selection:{start:Di,end:Di},prefix:"editor01-",isFirefox:!1,currentLine:0,lineElementMap:new Map,cursorAdjustmentNeed:!1,setLineElementMap:Function,setCurrentLine:Function,setCursorAdjustmentNeed:Function,input:"",isOpen:!1,undoStack:[],isPaste:!1,isAndroid:!1,isSafari:!1,mathMode:!1},Bi=(0,c.createContext)(Ui),Fi=Ri.insertAndDispatch,ji=function(e){var t=e.children,n=(0,c.useState)(Ui.flatList),r=(0,a.Z)(n,2),i=r[0],o=r[1],s=(0,c.useState)(Ui.undoStack),l=(0,a.Z)(s,2),u=l[0],d=l[1],h=(0,c.useState)(Ui.selection),p=(0,a.Z)(h,2),m=p[0],v=p[1],f=(0,c.useState)(Ui.prefix),g=(0,a.Z)(f,2),y=g[0],b=g[1],x=(0,c.useState)(Ui.isFirefox),C=(0,a.Z)(x,2),E=C[0],S=C[1],I=(0,c.useState)(Ui.mathMode),k=(0,a.Z)(I,2),w=k[0],T=k[1],M=(0,c.useState)(Ui.cursorAdjustmentNeed),P=(0,a.Z)(M,2),A=P[0],_=P[1],O=(0,c.useState)(Ui.lineElementMap),N=(0,a.Z)(O,2),Z=N[0],H=N[1],L=(0,c.useState)(Ui.currentLine),z=(0,a.Z)(L,2),R=z[0],D=z[1],U=(0,c.useState)(Ui.input),B=(0,a.Z)(U,2),F=B[0],j=B[1],q=(0,c.useState)(Ui.isOpen),W=(0,a.Z)(q,2),G=W[0],K=W[1],V=(0,c.useState)(Ui.isPaste),Q=(0,a.Z)(V,2),$=Q[0],X=Q[1],Y=(0,c.useState)(Ui.isAndroid),J=(0,a.Z)(Y,2),ee=J[0],te=J[1],ne=(0,c.useState)(Ui.isSafari),re=(0,a.Z)(ne,2),ie=re[0],ae=re[1],oe=(0,c.useMemo)((function(){return{flatList:i,selection:m,prefix:y,isFirefox:E,cursorAdjustmentNeed:A,lineElementMap:Z,currentLine:R,input:F,setFlatList:o,setSelection:v,setPrefix:b,setIsFirefox:S,setLineElementMap:H,setCursorAdjustmentNeed:_,setCurrentLine:D,setInput:j,isOpen:G,setOpen:K,undoStack:u,setUndoStack:d,isPaste:$,setPaste:X,isAndroid:ee,setIsAndroid:te,isSafari:ie,setIsSafari:ae,mathMode:w,setMathMode:T}}),[i,m,y,E,G,ie,F,u]);return oe.insert=function(e){return Fi(oe,e,{})},oe.insertObject=function(e){return Fi(oe,"",e)},c.createElement(Bi.Provider,{value:oe},t)},qi=function(e,t){var n="<div>",r=(e=Wi(e,"\n","<br />")).split(/(<code class="asciimath">.*?<\/code>)/).reduce((function(e,t){return t&&t.match('<code class="asciimath">')?e+t:t?e+"<p>".concat(t,"</p>"):e}),""),i="</div>",a="";if(t&&t.length>0){for(var o=0;o<t.length;o++)a+=t[o]?"<img src='".concat(t[o].toString(),"' />"):"";a=n+a+i}var s=n+r+i+a;return s=Wi(s,"<br />","\n")},Wi=function(e,t,n){return e?e.split(t).join(n):""},Gi=function(e){if(e){var t=e.split("/");if(t.length>0)return t[t.length-1]}return""},Ki=(0,cr.QS)({latestImageUrl:""}),Vi=n(84018),Qi=n(71134);!function(e){e.DESKTOP="DESKTOP",e.LAPTOP="LAPTOP",e.TABLET="TABLET",e.PHONE="PHONE"}(Hi||(Hi={}));var $i,Xi=function(e){return Number.parseInt(e)},Yi=(Zi={},(0,it.Z)(Zi,Hi.DESKTOP,Xi(Vi.Z.xl.min)),(0,it.Z)(Zi,Hi.LAPTOP,Xi(Vi.Z.lg.min)),(0,it.Z)(Zi,Hi.TABLET,Xi(Vi.Z.md.min)),(0,it.Z)(Zi,Hi.PHONE,Xi(Vi.Z.sm.min)),Zi),Ji=function(){var e=(0,Qi.useMediaQuery)({minWidth:Yi.DESKTOP}),t=(0,Qi.useMediaQuery)({minWidth:Yi.LAPTOP}),n=(0,Qi.useMediaQuery)({minWidth:Yi.TABLET});(0,Qi.useMediaQuery)({minWidth:Yi.PHONE});switch(!0){case e:return Hi.DESKTOP;case t:return Hi.LAPTOP;case n:return Hi.TABLET;default:return Hi.PHONE}},ea=n(15512),ta=n(15030),na=n.n(ta),ra=n(29180),ia=n(96266),aa=n(31067),oa=n(25104),sa=Math.PI/180,la=function(){var e=(0,i.Z)(s().mark((function e(t,n,r){var i,a,o,l,c,u,d,h,p,m,v,f,g,y,b,x,C,E,S,I=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=I.length>3&&void 0!==I[3]?I[3]:1,a=I.length>4&&void 0!==I[4]?I[4]:0,o=I.length>5?I[5]:void 0,l=I.length>6?I[6]:void 0,c=I.length>7?I[7]:void 0,u=document.createElement("canvas"),d=u.getContext("2d")){e.next=9;break}throw new Error("No 2d context");case 9:for(h=r!==De?t.naturalWidth/t.width:t.naturalWidth/100,p=r!==De?t.naturalHeight/t.height:t.naturalHeight/100,m=window.devicePixelRatio,u.width=Math.floor(r.width*h*m),u.height=Math.floor(r.height*p*m),d.scale(m,m),d.imageSmoothingQuality="high",v=r.x*h,f=r.y*p,g=a*sa,y=t.naturalWidth/2,b=t.naturalHeight/2,d.save(),d.translate(-v,-f),d.translate(y,b),d.rotate(g),d.scale(i,i),d.translate(-y,-b),d.drawImage(t,0,0,t.naturalWidth,t.naturalHeight,0,0,t.naturalWidth,t.naturalHeight),x=262144,C=1,E=u.toDataURL("image/jpeg",C),S=E.length;S<x&&C>.1;S--)C-=.1,E=u.toDataURL("image/jpeg",C);l&&l.length&&(1===l.length?c([E]):c((function(e){return null===e||void 0===e?void 0:e.map((function(e,t){return t===o?E:e}))}))),d.restore();case 34:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),ca=n(75383),ua=n(95999),da=(0,et.iv)(["width:100%;margin:0 ",";"],(function(e){return e.theme.cuiTheme.spacing.md})),ha=et.ZP.div.withConfig({componentId:"t3mib7-0"})(["display:flex;"]),pa=(0,et.ZP)(ca.SecondaryButton).withConfig({componentId:"t3mib7-1"})(["",""],da),ma=(0,et.ZP)(ca.Button).withConfig({componentId:"t3mib7-2"})(["",""],da),va=et.ZP.div.withConfig({componentId:"t3mib7-3"})(["background:rgba(34,34,34,0.4);text-align:center;padding:"," 0;margin:"," 0;"],(function(e){return e.theme.cuiTheme.spacing.md}),(function(e){return e.theme.cuiTheme.spacing.md})),fa=et.ZP.button.withConfig({componentId:"t3mib7-4"})(["background:none;border:none;position:relative;background-color:",";color:",";width:",";height:",";border-radius:",";margin:0 ",";cursor:pointer;svg{padding:0 ",";}"],(function(e){return e.theme.cuiTheme.colors.secondary.darker}),(function(e){return e.theme.cuiTheme.colors.primary.light}),(function(e){return e.theme.cuiTheme.spacing.xl3}),(function(e){return e.theme.cuiTheme.spacing.xl3}),(function(e){return e.theme.cuiTheme.radius.circle}),(function(e){return e.theme.cuiTheme.spacing.xxs}),(function(e){return e.theme.cuiTheme.spacing.xxs})),ga=et.ZP.div.withConfig({componentId:"t3mib7-5"})(["text-align:end;margin-top:0px;margin-right:20px;"]),ya=et.ZP.div.withConfig({componentId:"t3mib7-6"})(["display:none;"]),ba=et.ZP.canvas.withConfig({componentId:"t3mib7-7"})(["border:'1px solid black';objectfit:'contain';width:",";height:",";"],(function(e){return e.completedCrop.width}),(function(e){return e.completedCrop.height})),xa=et.ZP.div.withConfig({componentId:"t3mib7-8"})(["display:flex;align-items:center;background-color:",";padding:5px 20px;border-radius:8px;"],p.Z.red100),Ca=et.ZP.p.withConfig({componentId:"t3mib7-9"})(["font-size:16px;font-weight:700;line-height:16px;"]),Ea=et.ZP.p.withConfig({componentId:"t3mib7-10"})(["font-size:14px;line-height:130%;"]),Sa=et.ZP.div.withConfig({componentId:"t3mib7-11"})(["margin-left:10px;"]),Ia=et.ZP.div.withConfig({componentId:"t3mib7-12"})(["display:flex;align-items:center;background-color:",";padding:"," ",";border-radius:",";@media screen and (max-width:","){padding:"," ",";}@media screen and (max-width:","){align-items:flex-start;}"],p.Z.orange050,Ye.Z.px32,Ye.Z.px16,Ye.Z.px8,Vi.Z.lg.max,Ye.Z.px24,Ye.Z.px16,Vi.Z.sm.max),ka=et.ZP.div.withConfig({componentId:"t3mib7-13"})(["display:flex;flex-basis:100%;justify-content:space-between;align-items:center;margin-left:",";@media screen and (max-width:","){margin-left:",";}@media screen and (max-width:","){flex-direction:column;align-items:flex-start;}"],Ye.Z.px32,Vi.Z.lg.max,Ye.Z.px16,Vi.Z.sm.max),wa=et.ZP.div.withConfig({componentId:"t3mib7-14"})(["padding-right:",";@media screen and (max-width:","){padding-right:0;margin-bottom:",";}"],Ye.Z.px8,Vi.Z.sm.max,Ye.Z.px16),Ta=(0,et.ZP)(Ca).withConfig({componentId:"t3mib7-15"})(["font-size:",";margin:0 0 8px;line-height:130%;@media screen and (max-width:","){letter-spacing:0.35px;}@media only screen and (max-width:","){font-size:",";}"],ua.Z.size.px22,Vi.Z.md.max,Vi.Z.sm.max,ua.Z.size.px16),Ma=(0,et.ZP)(Ea).withConfig({componentId:"t3mib7-16"})(["margin:0;"]),Pa=et.ZP.div.withConfig({componentId:"t3mib7-17"})(["min-width:",";@media only screen and (max-width:","){a{font-size:",";}svg{height:14px;width:14px;min-height:14px;min-width:14px;}}"],Ye.Z.px112,Vi.Z.sm.max,ua.Z.size.px14),Aa=et.ZP.img.withConfig({componentId:"t3mib7-18"})(["width:4.25rem;height:3.625rem;object-fit:contain;margin-right:",";margin-left:",";cursor:pointer;transform:scale(1);transition:all 0.3s ease 0s;max-height:100px;box-shadow:",";border-radius:",";border:",";@media only screen and (max-width:","){width:2.875rem;height:2.5rem;margin-right:",";}"],Ye.Z.px12,Ye.Z.px4,(function(e){return e.theme.cuiTheme.boxShadow.elevation100}),Ye.Z.px4,(function(e){return e.activeThumbnail?"2px solid ".concat(p.Z.cheggOrange):"none"}),Vi.Z.md.max,Ye.Z.px4),_a="keys-wrapper",Oa="subject-dropdown",Na="image-cropper",Za="canvas-modal",Ha="zoom-in",La="zoom-out",za="rotation",Ra="crop-button",Da="reset-button",Ua="canvas-preview",Ba="tooltip-container",Fa="tooltip-content",ja="cancel-tooltip",qa="dont-show-this-msg-again-checkbox",Wa="get-the-app-cta-button",Ga="get-the-app-section",Ka={PAQ:"desktop-to-app-paq-modal",UIC:"desktop-to-app-uic-modal",MWEB_TO_APP_SIGN_IN:"mWeb-to-app-sign-in-modal"},Va=function(){var e=(0,i.Z)(s().mark((function e(t,n){var r,i,a,o,l,c,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rotate,i=n.maxWidth,a=n.quality,e.next=3,eo(t);case 3:return o=e.sent,e.next=6,Ya();case 6:if(l=e.sent,c=l.canvas,u=l.ctx,!i){e.next=20;break}if(Ja({img:o,canvas:c,ctx:u,maxWidth:i}),!r){e.next=20;break}return e.t0=eo,e.next=16,Xa(c);case 16:return e.t1=e.sent,e.next=19,(0,e.t0)(e.t1);case 19:o=e.sent;case 20:return r&&Qa({img:o,canvas:c,ctx:u,rotate:r}),e.abrupt("return",Xa(c,a));case 22:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Qa=function(e){var t=e.img,n=e.canvas,r=e.ctx,i=e.rotate;n.width=t.naturalWidth,n.height=t.naturalHeight,-270!==i&&-90!==i||(n.width=t.naturalHeight,n.height=t.naturalWidth),r.save(),r.translate(n.width/2,n.height/2),r.rotate($a(i)),180===i?r.translate(-n.width/2,-n.height/2):r.translate(-n.height/2,-n.width/2),r.drawImage(t,0,0),r.restore()},$a=function(e){return e*(Math.PI/180)},Xa=function(e,t){return new Promise((function(n){return n(e.toDataURL("image/jpeg",null!==t&&void 0!==t?t:1))}))},Ya=function(){return new Promise((function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d");if(null===r)return t(new Error("Context creation failed"));e({canvas:n,ctx:r})}))},Ja=function(e){var t=e.img,n=e.canvas,r=e.ctx,i=e.maxWidth,a=e.maxHeight,o=function(e){return e.naturalHeight/e.naturalWidth}(t),s=t.naturalWidth,l=t.naturalHeight;i&&(l=(s=Math.min(t.naturalWidth,i))*o),a&&(s=(l=Math.min(t.naturalHeight,a))/o),n.width=s,n.height=l,r.drawImage(t,0,0,s,l)},eo=function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=function(){n(new Error("Image creation failed"))},r.src=e}))},to=function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))},no=n(30816).lW,ro=function(){var e=(0,i.Z)(s().mark((function e(t,n){var r,i,o,l,c,u,d,h,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.split(","),i=(0,a.Z)(r,2),o=i[0],l=i[1],c=no.from(l,"base64"),u=o.replace(";base64","").replace("data:",""),d=n?n.name:"question-image",h=n?n.type:u,p=new Blob([c],{type:h}),e.abrupt("return",new File([p],d,{type:h}));case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Error converting base64 to File: "+e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),io=n(88830),ao=n(62044),oo=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=ir.CouldNotUploadImage.message,a=function(){var a=(0,i.Z)(s().mark((function i(a){var o,l,c;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=io.Z.CancelToken.source(),o=(0,ao.getConfig)("mediaAPIConfig"),(l=new FormData).append("file",a),l.append("clientId",null!==e&&void 0!==e?e:""),l.append("autoOrient",n?"true":"false"),i.next=8,io.Z.post(o.fileUpload,l,{cancelToken:t.token}).then((function(e){return null===e||void 0===e?void 0:e.data})).catch((function(t){"ECONNABORTED"===t.code&&(0,y.O7)({error:"".concat($n.MEDIA_API_FAILURE,": Server is taking too long to respond, please try again after sometime.[clientId: ").concat(e,"]"),location:Xn.OCR_MEDIA_API,severity:y.zb.ERROR},{teamName:Me.GARUDA})}));case 8:if(null===(c=i.sent)||void 0===c||!c.result.uri){i.next=11;break}return i.abrupt("return",{success:!0,imageUrl:c.result.uri});case 11:return i.abrupt("return",{success:!1,error:r});case 12:case"end":return i.stop()}}),i)})));return function(e){return a.apply(this,arguments)}}(),o=function(){t&&(t.cancel(),t=void 0)};return{uploadImage:a,abortUpload:o}};!function(e){e.PAQ="PAQ",e.UIC="UIC",e.MWEB_TO_APP_SIGN_IN="MWEB_TO_APP_SIGN_IN"}($i||($i={}));var so={UICModal:"Get expert help in a snap",PAQModal:"Scan the QR code and get the app",MWebToAppSignIn:{variation_1:"Study easier, with the app",variation_2:"Get better tools, with the app"}},lo={UICModal:"Use your phone to snap a picture of your question with the Chegg Study app.",PAQModal:"Make sure to turn on notifications to stay up to date on all your questions.",MWebToAppSignIn:{variation_1:"Make study time a breeze with easier-to-use study tools, available only on the app.",variation_2:"Make study time a breeze with a camera, keyboard, and study experience that\u2019s easier to use\u2014available only on the app."}},co="Continue on desktop",uo="Try the app",ho="Snap a picture and get expert help fast",po="Use your phone to snap a picture of your question with the Chegg Study app.",mo="Get the app",vo={type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:le,type:A.LINK,region_name:z}}},eventVersion:3},fo={type:P.CLICKSTREAM_COMPONENT_VIEW,data:{component_view:{component:{name:ce,type:A.BANNER,region_name:ue,text:ho,value:"English"}}},eventVersion:3},go=n(1835),yo=n(60020),bo=function(){var e=(0,ao.getConfig)("branchDeepLinks").desktopToApp.uicSIHP.dragAndDropFlow;return c.createElement(Ia,{"data-test":Ga},c.createElement(yo.Z,{"aria-hidden":!0,svgColor:p.Z.orange900,size:"large"}),c.createElement(ka,null,c.createElement(wa,null,c.createElement(Ta,null,ho),c.createElement(Ma,null,po)),c.createElement(Pa,null,c.createElement(go.SO,{href:e,target:"blank",onClick:function(){Xe(vo)}},mo))))},xo=function(e){var t,n=e.uicClientId,r=e.uploadedImageFileObj,o=e.onImageUrlChange,l=e.setBlobDisplayFileObj,u=e.transcriptionError,d=e.setTranscriptionError,h=e.transcriptionLoading,m=e.setTranscriptionLoading,v=e.clearRef,f=e.ocrLocalisationData,g=e.sideBottomErrors,b=e.mtcConversationId,x=e.isUicAtBottom,C=e.enableDesktopToAppUICExperiment,E=e.isDraggedImage,S=e.multipleImages,I=e.setMultipleImage,k=e.multipleImageSupport,T=void 0!==k&&k,M=e.singleImage,O=e.draggedImage,Z=e.setDraggedImage,H=e.setImageCounter,L=(0,c.useRef)(null),z=(0,c.useState)([De]),R=(0,a.Z)(z,2),D=R[0],F=R[1],j=(0,c.useState)([]),q=(0,a.Z)(j,2),W=q[0],G=q[1],K=(0,c.useState)([]),V=(0,a.Z)(K,2),Q=V[0],$=V[1],X=(0,c.useRef)(null),Y=(0,c.useState)(!1),J=(0,a.Z)(Y,2),te=J[0],ne=J[1],re=(0,c.useState)([]),ae=(0,a.Z)(re,2),se=ae[0],le=ae[1],ce=(0,c.useState)(!1),ue=(0,a.Z)(ce,2),ve=ue[0],fe=ue[1],ge=(0,c.useState)(!0),ye=(0,a.Z)(ge,2),be=ye[0],xe=ye[1],Ce=(0,c.useState)(!1),Ee=(0,a.Z)(Ce,2),Se=Ee[0],Ie=Ee[1],ke=(0,c.useState)(!1),we=(0,a.Z)(ke,2),Te=we[0],Pe=we[1],Ae=(0,c.useState)(""),_e=(0,a.Z)(Ae,2),Oe=_e[0],Ne=_e[1],Ze=(null===C||void 0===C?void 0:C())&&E,He=(0,c.useState)(0),Le=(0,a.Z)(He,2),ze=Le[0],Re=Le[1],Ue=(0,c.useState)(!1),Be=(0,a.Z)(Ue,2),Fe=Be[0],je=Be[1],qe=(0,c.useState)(!1),We=(0,a.Z)(qe,2),Ge=We[0],Ke=We[1],Ve=f,Qe=Ve.buttons,$e=Ve.errorMessages.couldNotTranscribeImage,Ye=g.couldNotUploadImage,Je=(0,c.useState)([]),et=(0,a.Z)(Je,2),tt=et[0],nt=et[1],rt=(0,c.useContext)(Sr),it=rt.notifications,st=rt.setNotifications,ut=oo(n).uploadImage,dt=function(){var e=(0,i.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,to(t);case 2:return n=e.sent,e.abrupt("return","string"===typeof n?n:null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){vt()}),[null===S||void 0===S?void 0:S.counter]),(0,c.useEffect)((function(){O&&Oe&&vt()}),[O,Oe]);var ht,pt,mt,vt=function(){var e=Array(r.length).fill(De),t=Array(r.length).fill(""),n=Array(r.length).fill(void 0);G(n),nt(t),F(e);var i=Array(r.length).fill(1);$(i),le([])};(0,c.useEffect)((function(){Pe(!0)}),[(null===tt||void 0===tt?void 0:tt[ze])||se[ze]]),(0,c.useEffect)((function(){r.length&&(1===r.length?dt(r[0]).then((function(e){le([e])})):r.map((function(e,t){dt(e).then((function(e){se[t]=e,le((0,at.Z)(se))}))}))),fe(!1),d(!0),ne(!0)}),[r[0]]),(0,c.useEffect)((function(){ve&&!u&&ne(!1)}),[ve,u]),ht=(0,i.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==(t=W[ze])&&void 0!==t&&t.width&&L.current&&X.current&&la(L.current,X.current,t,Q[ze],0,ze,tt,nt);case 2:case"end":return e.stop()}}),e)}))),pt=100,mt=[W[ze]],(0,c.useEffect)((function(){var e=function(){},t=setTimeout((function(){ht()}),pt);return mt&&(e=function(){clearTimeout(t)}),e}),mt);var ft=function(e,t){return e((function(e){return e.map((function(e,n){return n===ze?t:e}))}))},gt=function(e){ft(F,De),ft($,1),dt(r[ze]).then((function(e){ft(le,e),ft(nt,"")})),T&&e&&Et(pe)},yt=function(){gt(!1),l([]),O||o(null),le([]),ne(!1),v(),xe(!1),Ie(!1),Pe(!1)};(0,c.useEffect)((function(){u&&ve&&!h&&be&&Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:ee,message_detail:ir.CouldNotTranscribeImage.message},content:b?{metadata:{multi_turn_chat:{conversation_id:b}}}:void 0},eventVersion:3})}),[u,ve,h,be]),(0,c.useEffect)((function(){Ze&&Xe(fo)}),[]);var bt=function(){var e=r.map((function(e,t){return ro(null!==tt&&void 0!==tt&&tt.length&&tt[t]&&W[t]!==De?tt[t]:se[t],e).then((function(e){return ut(e)})).then((function(t){var n;if(t.success){if(T&&!M&&!O&&S&&(null===S||void 0===S?void 0:S.counter)<5){var i=[{imagePreview:t.imageUrl||"",fileName:e.name}];S.imageData=S.imageData.filter((function(e){return""!==e.imagePreview})),S.imageData=[].concat((0,at.Z)(S.imageData),i),null===H||void 0===H||H(S.counter+1),S.counter=S.counter+1,null===I||void 0===I||I(S),Ke(!1)}else if(T&&Se&&!Te){var a=Bo({multipleImages:S,uploadedImageFileObj:r,imageUrl:Oe,multipleImageSupport:T,setImageCounter:H});null===I||void 0===I||I(a),Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:B,type:A.BUTTON,region_name:de}}},eventVersion:3})}}else st([].concat((0,at.Z)(null!==it&&void 0!==it?it:[]),[{message:Ye.message,onCloseClick:function(){},title:Ye.title,type:lt.j_.Error}])),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:ee,message_detail:ie},content:b?{metadata:{multi_turn_chat:{conversation_id:b}}}:void 0},eventVersion:3}),(0,y.O7)({error:"".concat(ir.CouldNotUploadImage.code,": Error uploading file to Media API"),location:Xn.OCR_MEDIA_API,severity:y.zb.ERROR},{teamName:Me.GARUDA}),m(!1);return null!==(n=t.imageUrl)&&void 0!==n?n:""}))}));Promise.all(e).then((function(e){je(!1);var t=e[0];!T||M||O?(Ne(t),o(t),fe(!0),Z(null)):(fe(!0),yt())})).catch((function(e){je(!1),st([].concat((0,at.Z)(null!==it&&void 0!==it?it:[]),[{message:Ye.message,onCloseClick:function(){},title:Ye.title,type:lt.j_.Error}]))}))},xt=function(){return 1===r.length||ze+1===r.length?Qe.done:Qe.next},Ct=(0,c.useCallback)((0,ct.Z)((function(){xt()===Qe.next?(Re((function(e){return e+1})),Et(he)):(Ke(!0),T&&Et(me),je(!0),bt())}),300),[xt,Re,je,bt]),Et=function(e){var t,n;Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:e,type:A.BUTTON,region_name:de,value:null===(t=r.length)||void 0===t?void 0:t.toString(),text:null===(n=ze+1)||void 0===n?void 0:n.toString()}}},eventVersion:3})};return c.createElement(ea.Modal,{id:Na,key:Na,"data-test":Na,isOpen:te,onClose:yt,focusFirstActiveElement:!0,title:f.heading||"Adjust the frame around one question",shouldCloseOnClickOutside:!1,children:c.createElement(c.Fragment,null,c.createElement("span",null,r.length>1&&se.map((function(e,t){return c.createElement(Aa,{src:null===e||void 0===e?void 0:e.toString(),alt:"image-preview-"+t,activeThumbnail:ze===t,onClick:function(){return function(e){Re(e)}(t)}})}))),c.createElement(va,null,Fe?c.createElement(ot.Z,null):c.createElement(na(),{crop:D[ze],onChange:function(e){1===r.length?F([e]):ft(F,e)},onComplete:function(e){1===r.length?G([e]):ft(G,e)}},c.createElement("img",{id:"image",src:null===(t=se[ze])||void 0===t?void 0:t.toString(),alt:Ua,ref:L,style:{transform:"scale(".concat(Q[ze],")"),transition:"all 0.3s",maxHeight:"300px"}})),!!W[ze]&&c.createElement(ya,null,c.createElement(ba,{ref:X,"data-test":Za,completedCrop:W[ze]})),c.createElement(ga,null,c.createElement(fa,{onClick:function(){se[ze]&&Va(se[ze].toString(),{rotate:-90}).then((function(e){e&&(1===r.length?(le([e.toString()]),nt([e.toString()])):(ft(le,e.toString()),ft(nt,e.toString())))})).catch((function(e){(0,y.O7)({error:"".concat($n.COULD_NOT_ROTATE_IMAGE,": Failed to rotate image in cropper (").concat(e.message,")."),location:Xn.OCR_IMAGE_CROPPER,severity:y.zb.ERROR},{teamName:Me.GARUDA})}))},"data-test":za,"aria-label":"leftRotation"},c.createElement(ra.Z,null)),c.createElement(fa,{onClick:function(){$((function(e){return e.map((function(e,t){return t===ze?e+.1:e}))}))},"data-test":Ha,"aria-label":"zoomIn"},c.createElement(ia.Z,null)),c.createElement(fa,{onClick:function(){$((function(e){return e.map((function(e,t){return t===ze?Math.max(e-.1,.2):e}))}))},"data-test":La,"aria-label":"zoomOut"},c.createElement(aa.Z,null)))),c.createElement(ha,null,c.createElement(pa,{variant:"outlined",onClick:function(){return gt(!0)},"data-test":Da},Qe.resetButton),c.createElement(ma,{"data-test":Ra,isLoading:Fe,disabled:Ge,onClick:!T||M||O?function(){Se&&!Te&&(Ki({latestImageUrl:Oe}),yt(),T||Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:B,type:A.BUTTON,region_name:x?oe:N}},content:b?{metadata:{multi_turn_chat:{conversation_id:b}}}:void 0},eventVersion:3})),Ie(!0),Pe(!1),m(!0),bt(),Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:U,type:A.BUTTON,region_name:T?de:x?oe:N}},content:b?{metadata:{multi_turn_chat:{conversation_id:b}}}:void 0},eventVersion:3})}:Ct},!T||M||O?Qe.continue:xt()))),notifBanner:c.createElement(c.Fragment,null,u&&ve&&!h&&be&&c.createElement(xa,null,c.createElement(oa.Z,{"aria-hidden":!0,svgColor:p.Z.errorRed,iconFill:"circlefill",size:"medium"}),c.createElement(Sa,null,c.createElement(Ca,null,$e.title),c.createElement(Ea,null,$e.message))),Ze?c.createElement(bo,null):c.createElement(c.Fragment,null))})},Co=xo,Eo=Vi.Z.md,So=et.ZP.img.withConfig({componentId:"sc-1epi062-0"})(["object-fit:cover;"," "," "," ",""],(function(e){var t=e.height;return t&&(0,et.iv)(["height:",";"],t)}),(function(e){var t=e.maxHeight;return t&&(0,et.iv)(["max-height:",";"],t)}),(function(e){var t=e.maxWidth;return t&&(0,et.iv)(["max-width:",";"],t)}),(function(e){var t=e.width;return t&&(0,et.iv)(["width:",";"],t)})),Io=et.ZP.button.withConfig({componentId:"sc-1epi062-1"})(["background:none;border:none;cursor:pointer;padding:0;"," "," border-radius:",";box-shadow:",";"],(function(e){var t=e.height,n=e.isUicAtBottom;return t&&(0,et.iv)(["height:",";"],n?"2.75rem":t)}),(function(e){var t=e.width,n=e.isUicAtBottom;return t&&(0,et.iv)(["width:",";"],n?"2.75rem":t)}),(function(e){return e.theme.cuiTheme.radius.sm}),(function(e){return e.theme.cuiTheme.boxShadow.elevation100})),ko=et.ZP.div.withConfig({componentId:"sc-1epi062-2"})(["display:flex;position:relative;left:",";",""],(function(e){return e.isUicAtBottom?"-8px":"unset"}),(function(e){var t=e.isMobile,n=e.multipleImageSupport;return!t&&n&&(0,et.iv)(["margin-right:5px;"])})),wo=et.ZP.button.withConfig({componentId:"sc-1epi062-3"})(["align-items:center;background-color:",";border:",";border-radius:",";cursor:pointer;display:flex;height:",";justify-content:center;margin:",";width:",";@media only screen and (max-width:","){&{height:",";right:-",";top:-",";width:",";}}"],p.Z.grey900,Ye.Z.px8,(function(e){return e.theme.cuiTheme.radius.circle}),Ye.Z.px16,(function(e){return e.isUicAtBottom?"-8px -9px":"0px -7px"}),Ye.Z.px16,Eo.max,Ye.Z.px32,Ye.Z.px16,Ye.Z.px16,Ye.Z.px32),To=et.ZP.p.withConfig({componentId:"sc-1epi062-4"})(["overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;width:60%;font-size:",";"],(function(e){return e.theme.cuiTheme.font.size.xs})),Mo=et.ZP.div.withConfig({componentId:"sc-1epi062-5"})(["display:flex;justify-content:space-between;padding:0px 9px;align-items:center;width:100%;"]),Po=n(70807),Ao=function(e){var t=e["data-test"],n=e.disabled,r=e.onClick,i=e.isUicAtBottom;return c.createElement(wo,{"aria-label":"Remove Image","data-test":t,disabled:n,onClick:r,isUicAtBottom:i},c.createElement(Po.Z,{"aria-hidden":!0,size:"xsmall",svgColor:n?p.Z.grey600:p.Z.white}))},_o=et.ZP.img.withConfig({componentId:"pm5e6x-0"})(["box-shadow:",";max-height:80vh;max-width:100%;"],(function(e){return e.theme.cuiTheme.boxShadow.elevation100})),Oo=et.ZP.div.withConfig({componentId:"pm5e6x-1"})(["align-items:center;display:flex;justify-content:center;"]),No=function(e){var t=e["data-test"],n=e.alt,r=e.image,i=e.isOpen,a=e.onClose,o=(0,h.createTheme)({},h.themes.horizon);return c.createElement(et.f6,{theme:o},c.createElement(ea.Modal,{"aria-label":"Enlarged view of image",contentOverflow:!1,"data-test":t,id:"image-preview-modal",isOpen:i,onClose:a,shouldCloseOnClickOutside:!0},c.createElement(Oo,{"data-test":t&&"".concat(t,"-image-container")},c.createElement(_o,{alt:n,src:r}))))},Zo=n(82816),Ho=function(e){var t=e.fileName,n=e.children,r=e.onRemoveClick,i=e.image;return c.createElement(Mo,null,n,c.createElement(To,null,t),c.createElement(wo,{onClick:function(e){e.stopPropagation(),e.preventDefault(),r&&r(i)}},c.createElement(Zo.Z,{"aria-hidden":!0,size:"xsmall",svgColor:p.Z.white})))},Lo=function(e){var t=e.alt,n=void 0===t?"Upload preview":t,r=e["data-test"],i=e.image,o=e.height,s=e.maxHeight,l=e.maxWidth,u=e.onRemoveClick,d=e.width,h=e.isUicAtBottom,p=e.isMultiple,m=e.imageDimensions,v=e.fileName,f=e.isMobile,g=e.multipleImageSupport,y=e.mtcConversationId,b=(0,c.useState)(!1),x=(0,a.Z)(b,2),C=x[0],E=x[1],S=(0,c.useRef)(!1),I=function(){E(!0)};return(0,c.useEffect)((function(){i&&!S.current&&(S.current=!0,Xe(function(e){return{type:P.CLICKSTREAM_SUCCESS,data:{name:j,content:e?{metadata:{multi_turn_chat:{conversation_id:e}}}:void 0},eventVersion:3}}(y)))}),[]),c.createElement(ko,{"data-test":r,isMobile:f,multipleImageSupport:g,isUicAtBottom:h},c.createElement(No,{alt:"",image:i,isOpen:C,onClose:function(){E(!1)}}),p&&f?c.createElement(Ho,{image:i,fileName:v,onRemoveClick:u},c.createElement(Io,{height:null===m||void 0===m?void 0:m.height,width:null===m||void 0===m?void 0:m.width,onClick:I,isUicAtBottom:h},c.createElement(So,{alt:n,height:o,maxHeight:s,maxWidth:l,width:d,src:i}))):c.createElement(Io,{width:"68px",height:"58px",onClick:I,isUicAtBottom:h},c.createElement(So,{alt:n,height:o,maxHeight:s,maxWidth:l,width:d,src:i})),!p&&u&&c.createElement(Ao,{"data-test":r&&"".concat(r,"-remove-button"),onClick:u}))},zo=et.ZP.input.withConfig({componentId:"sc-17eqh7c-0"})(["",""],(function(e){return e.hide&&(0,et.iv)(["display:none;"])})),Ro=et.ZP.div.withConfig({componentId:"sc-17eqh7c-1"})([""," flex-wrap:wrap;gap:10px;",""],(function(e){return e.isUicAtBottom&&(0,et.iv)(["margin-left:",";"],Ye.Z.px16)}),(function(e){return!e.isMobile&&(0,et.iv)(["display:flex;"])}));function Do(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Do(Object(n),!0).forEach((function(t){(0,it.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Do(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Bo=function(e){var t,n=e.multipleImages,r=e.uploadedImageFileObj,i=e.imageUrl,a=e.multipleImageSupport,o=e.setImageCounter;if(a&&n&&n.imageData&&""===n.imageData[0].imagePreview)null===o||void 0===o||o(n.counter+1),n.counter=n.counter+1,n.imageData[0].imagePreview=i,n.imageData[0].fileName=r&&r[0]?null===(t=r[0])||void 0===t?void 0:t.name:null;else if(a&&n){var s;null===o||void 0===o||o(n.counter+1),n.counter=(null===n||void 0===n?void 0:n.counter)+1,n.imageData.push({imagePreview:i,fileName:r&&r[0]?null===(s=r[0])||void 0===s?void 0:s.name:null})}return n},Fo=(0,c.forwardRef)((function(e,t){var n=e["data-test"],r=e.uicClientId,a=e.hideImageInput,o=void 0===a||a,l=e.imageUrl,u=e.onImageUrlChange,d=e.transcriptionError,h=e.setTranscriptionError,p=e.transcriptionLoading,m=e.setTranscriptionLoading,v=e.setBackButtonImage,f=e.uploadedImageFileObj,g=e.setUploadedImageFileObj,b=e.updateCursorPos,x=e.draggedImage,C=e.setDraggedImage,E=e.ocrLocalisationData,S=e.sideBottomErrors,I=e.mtcConversationId,k=e.isUicAtBottom,T=e.enableDesktopToAppUICExperiment,M=e.isMultiple,O=e.imageDimension,Z=e.multipleImageSupport,H=void 0!==Z&&Z,L=e.singleImage,z=e.isMobile,U=e.multipleImages,B=e.setMultipleImage,j=e.setImageCounter,q=(0,c.useContext)(Sr),W=q.notifications,G=q.setNotifications,K=H?5:1,V=S.fileSizeExceedsLimit,Q=S.imageLimitReached,$=function(){G([].concat((0,at.Z)(null!==W&&void 0!==W?W:[]),[{message:1===K?Q.message1:Q.message5,title:"",type:lt.j_.Error,size:"small",onCloseClick:function(){}}]))};(0,c.useEffect)((function(){x&&((null===U||void 0===U?void 0:U.counter)===K&&($(),C(null)),g([x]))}),[x]);var X=function(){var e=(0,i.Z)(s().mark((function e(t){var n,r,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==(n=t.target.files)&&void 0!==n&&n.length&&(r=5-((null===U||void 0===U?void 0:U.counter)||0),i=Array.from(n).filter((function(e){return e.size<=Ae})),a=n.length!==i.length,!H||n.length<=r?J(a,i):$(),Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:te,type:A.ICON,region_name:H?de:k?oe:N}},content:I?{metadata:{multi_turn_chat:{conversation_id:I}}}:void 0},eventVersion:3}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){t&&"current"in t&&t.current&&(t.current.value="")},J=function(e,t){e&&(G([].concat((0,at.Z)(null!==W&&void 0!==W?W:[]),[{message:V.message,onCloseClick:function(){},title:V.title,type:lt.j_.Error}])),Y(),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:R,message_detail:D},content:I?{metadata:{multi_turn_chat:{conversation_id:I}}}:void 0},eventVersion:3}),(0,y.O7)({error:"".concat(ir.FileSizeExceedsLimit.code,": Uploaded file size exceeded limit: > ").concat(Ae),location:Xn.OCR_UPLOAD_IMAGE,severity:y.zb.WARNING},{teamName:Me.GARUDA})),t.length&&(g(t),C(null))},ee=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0;u(null),g([]),C(null),Ki({latestImageUrl:""}),v(null),b(),Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:F,type:A.ICON,region_name:H?de:k?oe:N,value:H?null===U||void 0===U||null===(e=U.counter)||void 0===e?void 0:e.toString():void 0,text:H&&void 0!=r?null===(t=r+1)||void 0===t?void 0:t.toString():void 0}},content:I?{metadata:{multi_turn_chat:{conversation_id:I}}}:void 0},eventVersion:3}),ne(n)},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||l;if(U){var n=U.counter,r=U.imageData;n>1?r=U.imageData.filter((function(e){return e.imagePreview!==t})):1===n&&(r=U.imageData.map((function(e){return e.imagePreview===t?Uo(Uo({},e),{},{imagePreview:"",fileName:null}):e}))),n=n>1?r.length:0,null===B||void 0===B||B(Uo(Uo({},U),{},{imageData:r,counter:n})),null===j||void 0===j||j(n)}};return c.createElement("div",{"data-test":n},c.createElement(zo,{accept:Pe.join(","),"data-test":n&&"".concat(n,"-image-input"),hide:o,key:l,onChange:X,ref:t,type:"file"}),c.createElement(Ro,{isMobile:z,isUicAtBottom:k},H&&U&&(null===U||void 0===U?void 0:U.counter)>0&&(null===U||void 0===U?void 0:U.imageData.map((function(e,t){return e.imagePreview&&c.createElement(Lo,{"data-test":n&&"".concat(n,"-image-preview"),maxHeight:M?null===O||void 0===O?void 0:O.height:k?"44px":"58px",maxWidth:M?null===O||void 0===O?void 0:O.width:k?"44px":"68px",onRemoveClick:H?function(){return ee(e.imagePreview,t)}:void 0,image:e.imagePreview,imageDimensions:O,isMultiple:M,fileName:e.fileName,isMobile:z,multipleImageSupport:H,isUicAtBottom:k})})))),!!l&&!H&&c.createElement(Lo,{"data-test":n&&"".concat(n,"-image-preview"),maxHeight:k?"44px":"58px",maxWidth:k?"44px":"68px",onRemoveClick:function(){return ee()},image:l,imageDimensions:O,isMultiple:M,multipleImageSupport:H,isUicAtBottom:k}),f&&f.length&&U&&(null===U||void 0===U?void 0:U.counter)<5?c.createElement(Co,{uicClientId:r,uploadedImageFileObj:f,onImageUrlChange:u,setBlobDisplayFileObj:g,transcriptionError:d,setTranscriptionError:h,transcriptionLoading:p,setTranscriptionLoading:m,clearRef:Y,ocrLocalisationData:E,sideBottomErrors:S,mtcConversationId:I,isUicAtBottom:k,enableDesktopToAppUICExperiment:T,isDraggedImage:!!x,multipleImageSupport:H,singleImage:L,multipleImages:U,setMultipleImage:B,draggedImage:x,setDraggedImage:C,setImageCounter:j}):"")})),jo=Fo,qo=n(22374),Wo=function(){return"".concat((0,ao.getConfig)("mathStaticContentCdnBaseUrl"),"/font/MathwaySymbols.otf")},Go=(0,et.F4)(["0%{opacity:1;}50%{opacity:0;}100%{opacity:1;}"]),Ko=(0,et.iv)(["@font-face{font-family:'Mathway';src:url(",");}"],Wo()),Vo=(0,et.iv)(["position:absolute;z-index:",";right:1%;top:50%;transform:translate(0%,-50%);"],xr.Z.chat),Qo=et.ZP.div.withConfig({componentId:"bzyl94-0"})(["border:"," solid "," !important;border-radius:8px;"],(function(e){return e.isUicAtBottom?"1px":"2px"}),(function(e){var t=e.isBorderOrange,n=e.isErrorBoxEnabled;return"".concat(n?p.Z.errorRed:t?p.Z.orange800:p.Z.grey300)})),$o=et.ZP.div.withConfig({componentId:"bzyl94-1"})(["color:#000;overflow-x:hidden;overflow-y:auto;max-height:",";"," .hide-cursor{display:none;}"," .cursor{position:absolute;color:",";font-style:normal;pointer-events:none;border-left:1px solid ",";height:"," !important;z-index:",";opacity:0;animation:"," 1s ease infinite;}.emptyText{color:",";display:inline-block;}#paste-capture-parent{z-index:-500;width:0;height:0;overflow:'hidden';position:'fixed';}#paste-capture-area{-webkit-user-select:auto !important;}.editorLine{word-wrap:break-word;user-select:none;min-height:1.5rem;}mtext{display:inline-block !important;}mi{display:inline-block !important;}mn{display:inline-block !important;}.fraction{font-size:medium;}.matrix{box-sizing:unset;}.tableMtd{border-right:solid 0.063rem;}.tableMtr{border-bottom:dashed 0.031rem;}.fontItalic{font-style:italic;}table{display:table;}tr{display:table-row;}@keyframes cursorAnimation{0%{opacity:1;}50%{opacity:0;}100%{opacity:1;}}@-o-keyframes cursorAnimation{0%{opacity:1;}50%{opacity:0;}100%{opacity:1;}}@-moz-keyframes cursorAnimation{0%{opacity:1;}50%{opacity:0;}100%{opacity:1;}}@-webkit-keyframes cursorAnimation{0%{opacity:1;}50%{opacity:0;}100%{opacity:1;}}.editor{"," position:relative;font-size:"," !important;line-height:"," !important;cursor:text;float:left;width:100%;z-index:",";outline:none !important;font-family:",";min-height:",";padding:",";}[data-placeholder]:empty:before{content:attr(data-placeholder);color:",";}#MathJaxSpan{outline:none;}.editable{caret-color:transparent;}.rectangle,.circle,.triangle,.parallelogram,.trapezoid,.box,.sphere,.cone,.pyramid,.cylinder,.tri{display:inline-block;font-family:'Mathway';font-size:400%;line-height:9.375rem;padding:",";}.shapeTable{display:inline-block;vertical-align:text-bottom !important;top:20px;}.equationTableOuter{padding:0 5px;display:inline-block;}.equationTableInstruction{display:block;}.equationTableEquation{display:inline-block;}.equationTableInner{td{padding-right:5px;}}.radical{padding-top:4px;padding-bottom:0.125rem;}.EquationTablePlaceholder{color:",";background-color:rgba(246,245,255,1);border-bottom:1px dashed rgba(71,39,195,1);padding:1px;padding-top:0px;cursor:text;display:inline-block;margin-bottom:"," !important;}.highlight{background:",";}.highlightSubSup > span{background:#9bc7ee;}.greyParen{color:",";}.Placeholder{color:",";background-color:",";padding:2px;padding-top:0px;cursor:text;}@media screen and (max-width:","){max-height:",";}&.renderer{max-height:none;.Placeholder{display:none;}.editorLine{user-select:auto;}}"],(function(e){var t=e.isSlimmerVersion;return e.isUicAtBottom?"8.375rem":t?"10rem":"15rem"}),Ko,(function(e){return e.isUicAtBottom&&!e.multipleImageSupport&&"\n    &:hover {\n      box-shadow: 0px 2px 8px 0px rgba(13, 13, 15, 0.20);;\n      transition-timing-function: ".concat(qo.Z.easeOut,";\n    }\n  ")}),p.Z.grey600,p.Z.grey600,(function(e){return e.theme.cuiTheme.spacing.lg}),xr.Z.dropdown,Go,p.Z.grey600,Ko,(function(e){return e.theme.cuiTheme.font.size.sm}),(function(e){return e.theme.cuiTheme.spacing.xl}),xr.Z.layout,ua.Z.family.aspira,(function(e){var t=e.isSlimmerVersion,n=e.isImageUrl,r=e.isUicAtBottom,i=e.theme;return r?"3.5rem":"".concat(t&&!n?i.cuiTheme.spacing.xl3:i.cuiTheme.spacing.xl5)}),(function(e){var t=e.theme;return e.isUicAtBottom?"".concat(t.cuiTheme.spacing.md," 1.25rem ").concat(t.cuiTheme.spacing.md," 1.25rem"):"".concat(t.cuiTheme.spacing.xs," ").concat(t.cuiTheme.spacing.sm)}),p.Z.grey700,(function(e){return e.theme.cuiTheme.spacing.xs}),p.Z.dark,(function(e){return e.theme.cuiTheme.spacing.xs}),(function(e){return e.isMobile?" #9bc7ee00 ":"#9bc7ee"}),p.Z.grey600,p.Z.white,p.Z.blue700,(function(e){return e.theme.cuiTheme.breakpoints.sm.max}),(function(e){var t=e.isSlimmerVersion,n=e.isMobile;return e.isUicAtBottom&&n?"7.5rem":t?"20rem":"15rem"})),Xo=et.ZP.div.withConfig({componentId:"bzyl94-2"})(["width:",";"],(function(e){var t=e.ocr,n=e.multipleImageSupport;return t&&!n?"calc(100% - 93px)":"100%"})),Yo=(0,et.ZP)(ea.Modal).withConfig({componentId:"bzyl94-3"})(["align-items:center;border:1px solid ",";border-radius:",";text-align:center;z-index:",";"],p.Z.grey700,Ye.Z.px8,xr.Z.modal),Jo=(0,et.ZP)(Yo).withConfig({componentId:"bzyl94-4"})([""]),es=et.ZP.div.withConfig({componentId:"bzyl94-5"})(["",""],(function(e){return e.multipleImageSupport?(0,et.iv)(["padding:0 0 "," ",";display:flex;"],Ye.Z.px8,Ye.Z.px8):Vo})),ts=et.ZP.div.withConfig({componentId:"bzyl94-6"})(["align-items:center;background-color:",";border:1px solid ",";border-radius:",";bottom:0;display:flex;flex-direction:column;flex-grow:1;justify-content:center;left:0;min-height:",";position:absolute;right:0;text-align:center;top:0;z-index:",";"],p.Z.white,p.Z.grey700,Ye.Z.px8,Ye.Z.px80,xr.Z.layout),ns=(0,et.ZP)(ts).withConfig({componentId:"bzyl94-7"})(["color:",";font-weight:",";",""],p.Z.grey800,ua.Z.weight.bold,(function(e){return e.isInTarget&&(0,et.iv)(["border:1px dashed ",";"],p.Z.grey600)})),rs=n(83083),is=n(61248),as=n(61965),os=n(59673),ss=et.ZP.div.withConfig({componentId:"x66lsb-0"})(["position:absolute;left:","px;top:","px;display:",";background-color:#fff;border:1px solid "," !important;border-radius:",";padding:",";box-shadow:0 2px 4px rgba(0,0,0,0.2);z-index:301;outline:none !important;min-width:140px;div{padding:1px;cursor:pointer;&:hover{background-color:",";}}span{padding-left:",";vertical-align:super;}.hidden{display:none;}"],(function(e){return e.left||0}),(function(e){return e.top||0}),(function(e){return e.isVisible?"block":"none"}),p.Z.grey300,(function(e){return e.theme.cuiTheme.spacing.xs}),(function(e){return e.theme.cuiTheme.spacing.xxs}),p.Z.grey300,(function(e){return e.theme.cuiTheme.spacing.xs})),ls=[{label:"Paste",action:"paste",icon:c.createElement(is.Z,null)},{label:"Copy",action:"copy",icon:c.createElement(as.Z,null)},{label:"Cut",action:"cut",icon:c.createElement(os.Z,null)}],cs=function(e){var t=e.isVisible,n=e.position,r=e.onMenuItemClick,i=e["data-test"],a=e.isFirefox,o=void 0!==a&&a;return c.createElement(ss,{left:null===n||void 0===n?void 0:n.x,top:null===n||void 0===n?void 0:n.y,isVisible:t,"data-test":i||"context-menu"},ls.map((function(e,t){return c.createElement("div",{key:t,onClick:function(){return r(e.action)},onKeyPress:function(t){"Enter"===t.key&&r(e.action)},role:"menuitem",tabIndex:0,className:"Paste"===e.label&&o?"hidden":""},e.icon,c.createElement("span",null,e.label))})))},us=n(64734),ds=et.ZP.div.withConfig({componentId:"sc-156rg44-0"})(["padding:0 0 "," ",";"],Ye.Z.px8,Ye.Z.px8),hs=et.ZP.img.withConfig({componentId:"sc-156rg44-1"})(["object-fit:cover;box-shadow:",";"," "," "," ",""],(function(e){return e.theme.cuiTheme.boxShadow.elevation100}),(function(e){var t=e.height;return t&&(0,et.iv)(["height:",";"],t)}),(function(e){var t=e.maxHeight;return t&&(0,et.iv)(["max-height:",";"],t)}),(function(e){var t=e.maxWidth;return t&&(0,et.iv)(["max-width:",";"],t)}),(function(e){var t=e.width;return t&&(0,et.iv)(["width:",";"],t)})),ps=et.ZP.div.withConfig({componentId:"sc-156rg44-2"})(["max-width:16.25rem;width:15.625rem;padding:"," 1px;"],Ye.Z.px8),ms=et.ZP.span.withConfig({componentId:"sc-156rg44-3"})(["color:",";padding-left:10px;font-size:",";"],p.Z.violet700,(function(e){return e.theme.cuiTheme.font.size.xs})),vs=et.ZP.div.withConfig({componentId:"sc-156rg44-4"})(["display:flex;align-items:center;padding-left:5px;"]),fs=et.ZP.button.withConfig({componentId:"sc-156rg44-5"})(["background:none;border:none;cursor:pointer;padding:0;"," "," border-radius:",";box-shadow:",";"],(function(e){var t=e.height;return t&&(0,et.iv)(["height:",";"],t)}),(function(e){var t=e.width;return t&&(0,et.iv)(["width:",";"],t)}),(function(e){return e.theme.cuiTheme.radius.sm}),(function(e){return e.theme.cuiTheme.boxShadow.elevation100}));function gs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ys,bs,xs=function(e){var t,n=e.ocrData,r=e.multipleImages,i=e.isMobile,a=e.children;(0,c.useEffect)((function(){if(0===(null===r||void 0===r?void 0:r.counter)){var e=document.getElementById("container");null===e||void 0===e||e.click()}}),[null===r||void 0===r?void 0:r.counter]);var o=c.createElement(vs,null,r&&i&&r.counter>0?c.createElement(c.Fragment,null,c.createElement(fs,{width:"24px",height:"24px"},c.createElement(hs,{maxHeight:"24px",maxWidth:"24px",src:r.imageData[0].imagePreview})),c.createElement(ms,null,"".concat(r.counter," ").concat(null===n||void 0===n||null===(t=n.popover)||void 0===t?void 0:t.heading))):null);return c.createElement(ds,{id:"container"},c.createElement(us.Popover,{showBeak:!0,targetElement:o,width:"auto","data-test":"popover",closeOnPaneClick:!1,position:"top"},c.createElement(ps,null,c.cloneElement(a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gs(Object(n),!0).forEach((function(t){(0,it.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({isMultiple:!0,isMobile:i,imageDimension:{height:"32px",width:"32px"}},a)))))},Cs=function(e){var t,n,r,i=e["data-test"],o=e.className,s=e.uicClientId,u=e.editorRef,d=e.editorId,h=void 0===d?"":d,p=e.enableAutoSuggest,m=void 0===p||p,v=e.imageBlobDisplayRef,f=e.value,g=e.onChange,b=void 0===g?x.ZT:g,k=e.onChangeInternal,M=e.editorInput,O=e.clearEditorState,Z=e.onClearEditorState,H=void 0===Z?x.ZT:Z,L=e.imageUrl,z=e.onImageUrlChange,R=void 0===z?x.ZT:z,D=e.placeholder,U=e.keyPressValue,B=e.setKeyPressValue,F=e.onClickSubmitButton,j=e.isLoading,q=e.isBorderOrange,V=e.handleShowKeyboard,Q=e.populateHtml,$=e.backButtonImage,X=e.setBackButtonImage,te=void 0===X?x.ZT:X,ne=e.editorCharacterLimitExceeded,re=e.isSlimmerVersion,ie=e.clearState,se=void 0!==ie&&ie,le=e.transcribedContent,ce=e.setTranscribedContent,ue=e.isInsideClicked,de=e.setIsInsideClicked,he=e.searchId,pe=e.strackId,me=e.trackId,ve=e.nativeMathMode,fe=void 0!==ve&&ve,ge=e.pasteContent,ye=e.setPasteContent,Se=e.defaultFocus,Ie=void 0===Se||Se,ke=e.handlePaste,we=e.setSearchSubmitType,Te=e.isErrorBoxEnabled,Pe=void 0!==Te&&Te,Ae=e.tryMsg,_e=e.setTryMsg,Oe=e.hideTypeahead,Ne=e.ocrLocalisationData,He=void 0===Ne?je.ocrData:Ne,Le=e.sideBottomErrors,ze=void 0===Le?je.sideBottomErrors:Le,De=e.setLegacyIds,Ue=e.enableNewLineOnEnter,Be=e.mtcConversationId,Fe=e.isUicAtBottom,qe=e.hideAutoSuggestOnFirstLoad,Ge=e.enableDesktopToAppUICExperiment,Ke=e.multipleImageSupport,Ve=e.singleImage,Qe=e.multipleImages,$e=e.setMultipleImage,Ye=e.setImageCounter,Je=e.setTypeaheadClickedValue,et=(0,c.useContext)(Bi),tt=(0,c.useState)(null),nt=(0,a.Z)(tt,2),ut=nt[0],dt=nt[1],ht=(0,c.useState)(null),pt=(0,a.Z)(ht,2),mt=pt[0],vt=pt[1],ft=(0,c.useState)(!1),gt=(0,a.Z)(ft,2),yt=gt[0],bt=gt[1],xt=(0,c.useState)(!1),Ct=(0,a.Z)(xt,2),Et=Ct[0],St=Ct[1],It=wr({onDrop:function(e){e&&dt(e)},sideBottomErrors:ze}),kt=It.isInTarget,wt=It.isInWindow,Tt=It.handleDragEnter,Mt=It.handleDragLeave,Pt=It.handleDragOver,At=It.handleDrop,_t=ze.sightApiDown,Ot=new Set([Hi.PHONE,Hi.TABLET]),Nt=Ji(),Zt=Ot.has(Nt);(0,c.useEffect)((function(){bt(!!Zt)}),[Zt]);var Ht=(0,l.useRouter)(),Lt=function(e){var t,n,r,i,a,o,s,l,c,u,d,h,p,m,v,f,g,y,b,x,C,E,S,I,k,w,T,M,P,A,_,O,N,Z,H,L,z,R,D,U,F,j,q,W,G,K,V,Q,$,X,Y,J,ee,te,re,ie,ae,oe,se,le,ce,ue,de,he,pe,me,ve,fe,ge,ye,be,xe,Ce,Ee,Se,Ie,ke,we=e;if((void 0!==(null===we||void 0===we?void 0:we.id)||void 0!==(null===we||void 0===we?void 0:we.character))&&!ne){switch(we.id){case"infinity":null===(t=et.insert)||void 0===t||t.call(et,"\u221e");break;case"pi":null===(n=et.insert)||void 0===n||n.call(et,"\u03c0");break;case"division":null===(r=et.insert)||void 0===r||r.call(et,"\xf7");break;case"intersect":null===(i=et.insert)||void 0===i||i.call(et,"\u2229");break;case"union":null===(a=et.insert)||void 0===a||a.call(et,"\u222a");break;case"degree":null===(o=et.insert)||void 0===o||o.call(et,"\xb0");break;case"xBar":null===(s=et.insert)||void 0===s||s.call(et,"x\u0304");break;case"gte":null===(l=et.insert)||void 0===l||l.call(et,"\u2265");break;case"lte":null===(c=et.insert)||void 0===c||c.call(et,"\u2264");break;case"arrow":null===(u=et.insert)||void 0===u||u.call(et,"\u2192");break;case"sub":null===(d=et.insertObject)||void 0===d||d.call(et,{id:"sub",type:""});break;case"pow":null===(h=et.insertObject)||void 0===h||h.call(et,{id:"pow",type:""});break;case"alpha":null===(p=et.insert)||void 0===p||p.call(et,"\u03b1");break;case"beta":null===(m=et.insert)||void 0===m||m.call(et,"\u03b2");break;case"gamma":null===(v=et.insert)||void 0===v||v.call(et,"\u03b3");break;case"delta":null===(f=et.insert)||void 0===f||f.call(et,"\u03b4");break;case"epsilon":null===(g=et.insert)||void 0===g||g.call(et,"\u03b5");break;case"zeta":null===(y=et.insert)||void 0===y||y.call(et,"\u03b6");break;case"eta":null===(b=et.insert)||void 0===b||b.call(et,"\u03b7");break;case"theta":null===(x=et.insert)||void 0===x||x.call(et,"\u03b8");break;case"iota":null===(C=et.insert)||void 0===C||C.call(et,"\u03b9");break;case"kappa":null===(E=et.insert)||void 0===E||E.call(et,"\u03ba");break;case"lambda":null===(S=et.insert)||void 0===S||S.call(et,"\u03bb");break;case"mu":null===(I=et.insert)||void 0===I||I.call(et,"\u03bc");break;case"nu":null===(k=et.insert)||void 0===k||k.call(et,"\u03bd");break;case"xi":null===(w=et.insert)||void 0===w||w.call(et,"\u03be");break;case"omicron":null===(T=et.insert)||void 0===T||T.call(et,"\u03bf");break;case"rho":null===(M=et.insert)||void 0===M||M.call(et,"\u03c1");break;case"sigma":null===(P=et.insert)||void 0===P||P.call(et,"\u03c3");break;case"tau":null===(A=et.insert)||void 0===A||A.call(et,"\u03c4");break;case"upsilon":null===(_=et.insert)||void 0===_||_.call(et,"\u03c5");break;case"phi":null===(O=et.insert)||void 0===O||O.call(et,"\u03c6");break;case"chi":null===(N=et.insert)||void 0===N||N.call(et,"\u03c7");break;case"psi":null===(Z=et.insert)||void 0===Z||Z.call(et,"\u03c8");break;case"omega":null===(H=et.insert)||void 0===H||H.call(et,"\u03c9");break;case"Alpha":null===(L=et.insert)||void 0===L||L.call(et,"\u0391");break;case"Beta":null===(z=et.insert)||void 0===z||z.call(et,"\u0392");break;case"Gamma":null===(R=et.insert)||void 0===R||R.call(et,"\u0393");break;case"Delta":null===(D=et.insert)||void 0===D||D.call(et,"\u0394");break;case"Epsilon":null===(U=et.insert)||void 0===U||U.call(et,"\u0395");break;case"Zeta":null===(F=et.insert)||void 0===F||F.call(et,"\u0396");break;case"Eta":null===(j=et.insert)||void 0===j||j.call(et,"\u0397");break;case"Theta":null===(q=et.insert)||void 0===q||q.call(et,"\u0398");break;case"Iota":null===(W=et.insert)||void 0===W||W.call(et,"\u0399");break;case"Kappa":null===(G=et.insert)||void 0===G||G.call(et,"\u039a");break;case"Lambda":null===(K=et.insert)||void 0===K||K.call(et,"\u039b");break;case"Mu":null===(V=et.insert)||void 0===V||V.call(et,"\u039c");break;case"Nu":null===(Q=et.insert)||void 0===Q||Q.call(et,"\u039d");break;case"Xi":null===($=et.insert)||void 0===$||$.call(et,"\u039e");break;case"Omicron":null===(X=et.insert)||void 0===X||X.call(et,"\u039f");break;case"Pi":null===(Y=et.insert)||void 0===Y||Y.call(et,"\u03a0");break;case"Rho":null===(J=et.insert)||void 0===J||J.call(et,"\u03a1");break;case"Sigma":null===(ee=et.insert)||void 0===ee||ee.call(et,"\u03a3");break;case"Tau":null===(te=et.insert)||void 0===te||te.call(et,"\u03a4");break;case"Upsilon":null===(re=et.insert)||void 0===re||re.call(et,"\u03a5");break;case"Phi":null===(ie=et.insert)||void 0===ie||ie.call(et,"\u03a6");break;case"Chi":null===(ae=et.insert)||void 0===ae||ae.call(et,"\u03a7");break;case"Psi":null===(oe=et.insert)||void 0===oe||oe.call(et,"\u03a8");break;case"Omega":null===(se=et.insert)||void 0===se||se.call(et,"\u03a9");break;case"angstrom":null===(le=et.insert)||void 0===le||le.call(et,"\u212b");break;case"circle":case"triangle":case"tri":case"rectangle":case"parallelogram":case"trapezoid":case"sphere":case"cylinder":case"cone":case"pyramid":case"box":null===(ce=et.insertObject)||void 0===ce||ce.call(et,{id:"shape",type:we.id});break;case"PhysicsEquations":null===(ue=et.insertObject)||void 0===ue||ue.call(et,{id:"equationTable",type:we.AsciiMath});break;case"matrix":null===(de=et.insertObject)||void 0===de||de.call(et,{id:"matrix",type:"",row:we.row,col:we.col});break;case"muXBar":case"sigmaXBar":case"combination":case"permutation":case"log":case"positiveIon":case"negativeIon":case"arrow":case"defIntegral":case"indefIntegral":case"summation":case"sqrt":case"nthrt":case"table":case"xPxTable":case"lim":case"scientific":case"nlog":case"point":case"fraction":case"mixed":case"piecewise":case"function":null===(he=et.insertObject)||void 0===he||he.call(et,{id:we.id,type:""});break;case"ln":null===(pe=et.insertObject)||void 0===pe||pe.call(et,{id:"ln",type:"",name:"ln"});break;case"element":null===(me=et.insertObject)||void 0===me||me.call(et,{id:"element",symbol:we.symbol});break;case"accent":null===(ve=et.insertObject)||void 0===ve||ve.call(et,{id:"accent",type:""});break;case"sin":null===(fe=et.insertObject)||void 0===fe||fe.call(et,{id:"trig",name:"sin"});break;case"cos":null===(ge=et.insertObject)||void 0===ge||ge.call(et,{id:"trig",name:"cos"});break;case"tan":null===(ye=et.insertObject)||void 0===ye||ye.call(et,{id:"trig",name:"tan"});break;case"trig":null===(be=et.insertObject)||void 0===be||be.call(et,{id:"trig",type:"",name:we.name});break;case"x":case"y":case"z":null===(xe=et.insert)||void 0===xe||xe.call(et,we.id);break;case"euler":null===(Ce=et.insert)||void 0===Ce||Ce.call(et,"e");break;case"asterisk":null===(Ee=et.insert)||void 0===Ee||Ee.call(et,"*");break;case"imaginary":null===(Se=et.insert)||void 0===Se||Se.call(et,"i");break;case"space":null===(Ie=et.insert)||void 0===Ie||Ie.call(et," ");break;case"backspace":case"erase":case"left_arrow":case"right_arrow":ln.insertOperation({id:we.id});break;default:null===(ke=et.insert)||void 0===ke||ke.call(et,we.character)}B(null)}};(0,c.useEffect)((function(){return Lt(U)}),[U]),(0,c.useEffect)((function(){M&&(ln.clearEditorState(),ln.reflectResponseToEditor(M),ln.dispatchChanges(),ln.updateCursorPosition())}),[M]),(0,c.useEffect)((function(){O&&(R(null),vt([]),Ki({latestImageUrl:""}),te(null),ln.clearEditorState(),ln.dispatchChanges(),ln.updateCursorPosition(),H(!1))}),[O]),(0,c.useEffect)((function(){var e;Ae&&(ln.clearEditorState(),ln.reflectResponseToEditor(Ae.slice(0,-3),!1),ln.dispatchChanges(),ln.updateCursorPosition(),null===_e||void 0===_e||_e(null),null===cn||void 0===cn||null===(e=cn.current)||void 0===e||e.focus())}),[Ae]);(0,c.useEffect)((function(){et.setMathMode&&et.setMathMode(V||!1)}),[V]);var zt=(0,c.useState)(null),Rt=(0,a.Z)(zt,2),Dt=Rt[0],Ut=Rt[1],Bt=(0,c.useState)(null),Ft=(0,a.Z)(Bt,2),jt=Ft[0],qt=Ft[1],Wt=(0,c.useContext)(Sr),Gt=Wt.notifications,Kt=Wt.setNotifications;(0,c.useEffect)((function(){ln.updateCursorPosition()}),[null===Qe||void 0===Qe?void 0:Qe.counter]);var Vt=(0,c.useState)(!1),Qt=(0,a.Z)(Vt,2),$t=Qt[0],Xt=Qt[1],Yt=wt&&!$t?"Drop images here or upload from your computer":D||Ee,Jt=(null===(t=et.flatList.prev)||void 0===t?void 0:t.type)===We.Head&&(null===(n=et.flatList.next)||void 0===n?void 0:n.type)===We.Head,en="";en=Jt&&et.input.length<1?'<div id=\'EditorElement_0\' className="editorLine" data-placeholder="'.concat(Yt,"\" contenteditable data-Test='placeholder'></div>"):On(et.flatList,!1);var tn=!1,nn=(0,c.useState)(!0),rn=(0,a.Z)(nn,2),an=rn[0],on=rn[1];(0,c.useEffect)((function(){qe&&on(!1)}),[]);var sn=pr(m&&an?et.input:"",null!==he&&void 0!==he?he:"",null!==pe&&void 0!==pe?pe:"",null!==me&&void 0!==me?me:"",null!==le&&void 0!==le?le:"",null!==ge&&void 0!==ge?ge:""),ln=new Ri(et,F,j,ne,ce,ge,ye,we,he,pe,me,Zt,h,Ue),cn=c.useRef(null),un=(0,c.useRef)(!0),dn=function(){document.body.style.userSelect="none",null===de||void 0===de||de(!0),null===on||void 0===on||on(!0)},hn=function(){mn(),dn(),cn.current&&Zt&&!1===fe&&(cn.current.setAttribute("contentEditable","true"),cn.current.setAttribute("autocapitalize","none"),cn.current.setAttribute("autocorrect","on"),cn.current.setAttribute("spellcheck","true"),cn.current.setAttribute("autocomplete","on"),cn.current.focus(),Ie&&cn.current.focus())};(0,c.useEffect)((function(){var e=document.getElementById("editor01-"+h);return e&&e.addEventListener("input",(function(t){if(t.preventDefault(),t.stopPropagation(),e.childNodes)for(var n=0;n<e.childNodes.length;n++){var r;if(e.childNodes[n]&&e.childNodes[n].nodeName&&("#text"==e.childNodes[n].nodeName||"BR"==e.childNodes[n].nodeName))null===(r=e.childNodes[n])||void 0===r||r.remove()}"insertFromPaste"!=t.inputType&&"insertLineBreak"!=t.inputType&&"insertParagraph"!=t.inputType&&Ut(t)})),function(){null===e||void 0===e||e.removeEventListener("input",(function(){}))}}),[]);var pn=function(e){b(e),k(e)};(0,c.useEffect)((function(){var e;ue&&An&&f&&""!==be(f)&&(Xe({type:P.CLICKSTREAM_INTERACTION,data:{content:{metadata:{search:{auto_type:Ce(f,null!==le&&void 0!==le?le:"",null!==ge&&void 0!==ge?ge:""),experience:/Mobile/.test(null===(e=navigator)||void 0===e?void 0:e.userAgent)?I.MOBILE:I.DESKTOP,profile:S.BIGEGG_SUGGEST,term:xe(f),type:C.TYPEAHEAD,strack_id:pe||void 0,track_id:me||void 0,search_id:he||void 0},multi_turn_chat:Be?{conversation_id:Be}:void 0}},eventname:G,interaction:{type:_.START,element:{name:K,type:A.TEXT,value:xe(f),region_name:Fe?oe:N}}},eventVersion:3}),_n(!1))}),[f]),(0,c.useEffect)((function(){cn.current&&ue&&Ie&&setTimeout((function(){var e;return null===(e=cn.current)||void 0===e?void 0:e.focus()}),0),cn.current&&Zt&&V&&(cn.current.setAttribute("contentEditable","false"),cn.current.blur())}),[ue,V,U]),(0,c.useEffect)((function(){jt&&(ln.handlePaste(),qt(null))}),[jt]),(0,c.useEffect)((function(){f&&(ln.clearEditorState(),ln.reflectResponseToEditor(f),ln.updateCursorPosition(),ln.dispatchChanges())}),[]),(0,c.useEffect)((function(){navigator.userAgent.indexOf("Firefox")>0&&et.setIsFirefox&&cn.current&&(et.setIsFirefox(!0),cn.current.setAttribute("contentEditable","true"))}),[]),(0,c.useEffect)((function(){if(navigator.userAgent&&/android/i.test(navigator.userAgent)&&et.setIsAndroid){var e=document.getElementById("editor01-"+h+"-cursor"),t=document.getElementById("MathDisplayContainer"),n=document.getElementById("MathJax"),r=document.getElementById("MathJaxSpan-"+h);e&&t&&n&&r&&(null===e||void 0===e||e.setAttribute("contentEditable","false"),null===t||void 0===t||t.setAttribute("contentEditable","true"),null===n||void 0===n||n.setAttribute("contentEditable","true"),null===r||void 0===r||r.setAttribute("contentEditable","true")),et.setIsAndroid(!0)}else if(navigator.userAgent&&/iPad|iPhone|iPod/.test(navigator.userAgent)){var i=document.getElementById("editor01-"+h+"-cursor");i&&(null===i||void 0===i||i.setAttribute("contentEditable","false"))}}),[]),(0,c.useEffect)((function(){sn&&et.setOpen&&et.setOpen(!1)}),[sn]);Ar(cn,(function(e){!et.isOpen&&e&&e.currentTarget&&cn.current!==e.currentTarget&&et.setOpen&&et.setOpen(!0)})),(0,c.useEffect)((function(){un.current?un.current=!1:dn()}),[U,V]),(0,c.useEffect)(ln.updateCursorPosition,[et.prefix,et.flatList,et.selection]);var mn=function(){sn&&sn.length>0&&et.setOpen&&et.setOpen(!1)},vn=Zr(),fn=(0,c.useState)(!0),gn=(0,a.Z)(fn,2),yn=gn[0],bn=gn[1],xn=(0,c.useState)(null),Cn=(0,a.Z)(xn,2),En=Cn[0],Sn=Cn[1],In=(0,c.useState)(!1),kn=(0,a.Z)(In,2),wn=kn[0],Tn=kn[1],Mn=(0,c.useState)(!0),Pn=(0,a.Z)(Mn,2),An=Pn[0],_n=Pn[1],Nn=(0,c.useRef)(null),Zn=ur(),Hn=(0,c.useState)(null),Ln=(0,a.Z)(Hn,2),zn=Ln[0],Rn=Ln[1];(0,c.useEffect)((function(){wn&&F&&(F(C.TYPEAHEAD,zn),Tn(!1))}),[f]),(0,c.useEffect)((function(){if(L&&vn.status===Mr.Ok&&vn.data.transcriptionText){var e=vn.data.transcriptionHtml,t=vn.data.transcriptionText;ce&&ce(t);var n=Bo({multipleImages:Qe,uploadedImageFileObj:mt,imageUrl:L,multipleImageSupport:Ke,setImageCounter:Ye});if(null===$e||void 0===$e||$e(n),Qe&&null!==Qe&&void 0!==Qe&&Qe.imageData&&(null===Qe||void 0===Qe?void 0:Qe.imageData.length)>=1&&(null===Qe||void 0===Qe?void 0:Qe.imageData.length)<5&&Ke){ln.reflectResponseToEditor(" ");var r=document.querySelector(".mathContainer".concat(h?"-":"").concat(h));Fn(r)}ln.renderOCR(e||"<div></div>"),pn("".concat(f," ").concat(t)),Ke||Ki({latestImageUrl:L}),bn(!1),Xt(!1),Ie&&(null===de||void 0===de||de(!0)),Xe({type:P.CLICKSTREAM_SUCCESS,data:{name:W,content:Be?{metadata:{multi_turn_chat:{conversation_id:Be}}}:void 0},eventVersion:3})}else if(vn.status===Mr.Error){var i;null===(i=vn.metadata)||void 0===i||i.code,_r.CouldNotTranscribe,bn(!0),Xt(!1),Ie&&(null===de||void 0===de||de(!0))}else vn.status===Mr.ApiDown&&(console.log("sight API down",vn),bn(!1),Xt(!1),R(null),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:ee,message_detail:ae}},eventVersion:3}),(0,y.O7)({error:"".concat($n.SIGHT_API_FAILURE,": Unable to process image, failed to connect to Sight API"),location:Xn.OCR_SIGHT_API,severity:y.zb.ERROR},{teamName:Me.GARUDA}),Kt([].concat((0,at.Z)(null!==Gt&&void 0!==Gt?Gt:[]),[{message:_t.message,onCloseClick:function(){},title:_t.title,type:lt.j_.Error}])))}),[vn.status]),(0,c.useEffect)((function(){L&&vn.status!==Mr.Loading&&vn.fetch(L)}),[L]);(0,c.useEffect)((function(){var e=document.getElementById("paste-capture-area-"+h);e&&e.addEventListener("paste",(function(e){e.preventDefault(),cn.current&&cn.current.focus();var t=e.clipboardData.getData("text");Sn(t)}))}),[]),(0,c.useEffect)((function(){cn.current&&Zt&&!1===fe&&(cn.current.setAttribute("contentEditable","true"),cn.current.setAttribute("autocapitalize","none"),cn.current.setAttribute("autocorrect","on"),cn.current.setAttribute("spellcheck","true"),cn.current.setAttribute("autocomplete","on"),cn.current.focus(),Ie&&cn.current.focus())}),[]),(0,c.useEffect)((function(){En&&(ln.handlePaste(En),Sn(null))}),[En]),(0,c.useEffect)((function(){Dt&&(ln.handleMobileKey(Dt),Ut(null))}),[Dt]),(0,c.useEffect)((function(){var e=document.getElementById("editor01-"+h);e&&e.addEventListener("paste",(function(e){if(e.preventDefault(),e&&e.clipboardData&&Zt){var t=e.clipboardData.getData("Text");qt(t)}else if(e&&e.clipboardData){var n=e.clipboardData.getData("Text");Sn(n)}}))}),[]),(0,c.useEffect)((function(){/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&et.setIsSafari&&cn.current&&et.setIsSafari(!0)}),[]);(0,c.useImperativeHandle)(u,(function(){return{onKeyPress:function(e){return ln.handleKey(e)},onSpecialKeyPress:function(e){return Lt(e)},onGetHtmlValue:function(){if(et.input)return qi(et.input)},onGetText:function(){return f},onRenderOCR:function(e){return ln.renderOCR(e)},onClearEditorState:function(){ln.clearEditorState(),ln.dispatchChanges()},toggleKeyboard:function(e){return function(e){cn.current&&Zt&&(e?hn():cn.current.blur())}(e)},onKeyPressAndroid:function(e){return ln.handleMobileKey(e)}}})),(0,c.useEffect)((function(){ue||ln.removeSelection()}),[ue]);var Dn=function(e){ln.handleReconstruct(e);var t=ln.extractImageUrl(e);if(t&&t.length>0&&te&&te(t[0].trim()),Ke&&null!==Qe&&void 0!==Qe&&Qe.imageData&&""===Qe.imageData[0].imagePreview&&t.length>0){for(var n=0;n<t.length;n++)null===Ye||void 0===Ye||Ye(Qe.counter+1),Qe.counter=Qe.counter+1,0==n?(Qe.imageData[n].imagePreview=t[n],Qe.imageData[n].fileName=Gi(t[n])):Qe.imageData.push({imagePreview:t[n],fileName:Gi(t[n])});$e&&$e(Qe)}ln.updateCursorPosition(),ln.dispatchChanges()},Un=function(){return"false"===sessionStorage.getItem(Re)||se},Bn=function(){if(ln.clearEditorState(),R(null),ln.dispatchChanges(),Un())sessionStorage.removeItem(Re);else{var e=sessionStorage.getItem(Ze);if(e&&e.length>0){var t=JSON.parse(e).htmlQuery;ln.clearEditorState(),R(null),ln.dispatchChanges(),Dn(t)}}},Fn=function(e){!et.isPaste&&e&&(e.scrollTop=e.scrollHeight)};(0,c.useEffect)((function(){var e=null===Ht||void 0===Ht?void 0:Ht.asPath,t=sessionStorage.getItem("curr_path");if(t!==e&&$e&&$e({counter:0,imageData:[{imagePreview:"",fileName:null}]}),"/chat"!==t&&null!==Ht&&void 0!==Ht&&Ht.query.q&&("/"==e||e.startsWith("/?"))){var n=new URL(window.location.href),r=new URLSearchParams(n.search),i=r.get("q"),a=r.get("searchid"),o=r.get("strackid"),s=r.get("trackid");a&&o&&s&&(null===De||void 0===De||De({legacyStrackId:o,legacyTrackId:s,legacySearchId:a})),i&&(ln.clearEditorState(),ln.reflectResponseToEditor(i),ln.dispatchChanges(),ln.updateCursorPosition())}else t&&sessionStorage.setItem("prev_path",t),sessionStorage.setItem("curr_path",e),"/chat"!=t||"/"!=e&&!e.startsWith("/?")?(ln.clearEditorState(),R(null),ln.dispatchChanges()):Bn()}),[Ht]),(0,c.useEffect)((function(){Q&&Dn(Q)}),[Q]),(0,c.useEffect)((function(){var e;("send-to-expert"===h||"search"===h||h.includes("mtc-send-to-expert"))&&(null===(e=et.insert)||void 0===e||e.call(et," "))}),[]),(0,c.useEffect)((function(){var e=document.querySelector(".mathContainer".concat(h?"-":"").concat(h)),t=document.getElementById("editor01-"+h+"-cursor");!tn&&et.isPaste?(tn=!1,function(e){e&&et.setPaste&&(setTimeout((function(){return e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}),0),et.setPaste(!1))}(t)):setTimeout((function(){Ai(t,e)||Fn(e)}),0)}),[en]);var qn=function(e){"Backspace"==e.key&&(ln.Backspace(),ln.dispatchChanges(),e.stopPropagation(),e.preventDefault())},Wn=(0,c.useState)(!1),Gn=(0,a.Z)(Wn,2),Kn=Gn[0],Vn=Gn[1],Qn=(0,c.useState)({x:0,y:0}),Yn=(0,a.Z)(Qn,2),Jn=Yn[0],er=Yn[1];(0,c.useEffect)((function(){var e=function(){Vn(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]);var tr=(r={},(0,it.Z)(r,"data-test",i?"".concat(i,"-image-blob-display"):void 0),(0,it.Z)(r,"uicClientId",s),(0,it.Z)(r,"imageUrl",L||$),(0,it.Z)(r,"onImageUrlChange",R),(0,it.Z)(r,"transcriptionError",yn),(0,it.Z)(r,"setTranscriptionError",bn),(0,it.Z)(r,"transcriptionLoading",$t),(0,it.Z)(r,"setTranscriptionLoading",Xt),(0,it.Z)(r,"setBackButtonImage",te),(0,it.Z)(r,"uploadedImageFileObj",mt),(0,it.Z)(r,"setUploadedImageFileObj",vt),(0,it.Z)(r,"updateCursorPos",ln.updateCursorPosition),(0,it.Z)(r,"draggedImage",ut),(0,it.Z)(r,"setDraggedImage",dt),(0,it.Z)(r,"ocrLocalisationData",He),(0,it.Z)(r,"sideBottomErrors",ze),(0,it.Z)(r,"mtcConversationId",Be),(0,it.Z)(r,"isUicAtBottom",Fe),(0,it.Z)(r,"multipleImageSupport",Ke),(0,it.Z)(r,"singleImage",Ve),(0,it.Z)(r,"multipleImages",Qe),(0,it.Z)(r,"setMultipleImage",$e),(0,it.Z)(r,"setImageCounter",Ye),(0,it.Z)(r,"enableDesktopToAppUICExperiment",Ge),r);return c.createElement(c.Fragment,null,c.createElement(Qo,{isBorderOrange:q,isErrorBoxEnabled:ne||Pe,"data-test":"overlaywrapper",isUicAtBottom:Fe},c.createElement($o,{className:"mathContainer".concat(h?"-":"").concat(h),onScroll:(0,ct.Z)((function(){tn=!0}),500),isErrorBoxEnabled:ne||Pe,isSlimmerVersion:re,isImageUrl:!!L,isMobile:yt,isUicAtBottom:Fe,multipleImageSupport:Ke},c.createElement("div",{id:"paste-capture-parent"},c.createElement("div",{id:"paste-capture-area-"+h,ref:Nn,contentEditable:"true",tabIndex:-1})),c.createElement(cs,{isVisible:Kn&&!Zt,position:Jn,onMenuItemClick:function(e){switch(e){case"paste":ln.handlePaste();break;case"cut":ln.handleCtrlX(et.selection.start,et.selection.end),ln.updateCursorPosition();break;case"copy":ln.handleCopy();break;default:return null}Vn(!1)}}),c.createElement(Jo,{id:et.prefix+"-loader","aria-label":"editor-loader",isOpen:$t,onClose:function(){},hideCloseButton:!0},c.createElement(ot.Z,{size:"large"}),c.createElement("p",null,(null===He||void 0===He?void 0:He.loadingText)||"Processing...")),c.createElement(rs.og,null,c.createElement("div",{onDragEnter:Tt,onDragLeave:Mt,onDragOver:Pt,onDrop:At,className:"".concat(o," editor editable"),id:et.prefix+h,"data-test":et.prefix,role:"textbox","aria-label":"editorInput",tabIndex:0,onKeyDown:function(e){if(null===on||void 0===on||on(!0),ue&&!et.isAndroid){if("v"===e.key&&(e.ctrlKey||e.metaKey)){var t,n;if(Ie)null===(t=cn.current)||void 0===t||t.focus();if(Nn&&Nn.current&&(et.isFirefox||et.isSafari))return void(null===Nn||void 0===Nn||null===(n=Nn.current)||void 0===n||n.focus())}ln.handleKey(e)}else"Enter"===e.key&&ue&&Zt&&et.isAndroid?ln.handleKey(e):ue&&Zt&&et.isAndroid&&qn(e)},onMouseDown:function(e){e.preventDefault(),ue&&(ln.handleMouseDown(e),St(!0))},onMouseMove:function(e){var t;(e.preventDefault(),function(e){var t;if(Et){var n=null===(t=document)||void 0===t?void 0:t.getElementsByClassName("mathContainer".concat(h?"-":"").concat(h));if((null===n||void 0===n?void 0:n.length)>0){for(var r=n[0],i=0;i<(null===n||void 0===n?void 0:n.length);i++){var a;null!==(a=n[i])&&void 0!==a&&a.classList.contains("renderer")||(r=n[i])}if(r&&Et){var o,s=e.clientY,l=null===(o=r)||void 0===o?void 0:o.getBoundingClientRect(),c=s-l.top,u=l.bottom-s;c<20&&(r.scrollTop-=20),u<20&&(r.scrollTop+=20)}}}}(e),ue)&&(ln.handleMouseMove(e),Ie&&(null===(t=cn.current)||void 0===t||t.focus()))},onClick:hn,onContextMenu:function(e){if(!Zt&&!et.isFirefox){e.preventDefault();var t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.left,r=Math.min(Math.max(e.clientY-t.top,0),60),i=window.innerHeight-e.clientY<105;er({x:n,y:i?r+(window.innerHeight-e.clientY-105):r}),Vn(!0)}},ref:cn,suppressContentEditableWarning:!0,onPaste:ke,onCut:function(e){var t;e.preventDefault();var n=(null===(t=window.getSelection())||void 0===t?void 0:t.toString())||"";cn.current&&n&&(e.clipboardData.setData("text/plain",n),ln.handleCut(e.target.id,n))},onSelect:function(e){var t,n=window.getSelection(),r=null===n||void 0===n?void 0:n.toString(),i=r&&(null===n||void 0===n||null===(t=n.getRangeAt(0).startContainer.parentElement)||void 0===t?void 0:t.id)||"editor01-"+h;cn.current&&r?ln.handleSelect(i,r):e.preventDefault()},onMouseUp:function(){St(!1)}},c.createElement("span",{id:et.prefix+h+"-cursor",className:ue?"cursor":"hide-cursor",contentEditable:!1}),c.createElement(Xo,{className:"mathEditorDisplay",ocr:!(!L&&!$),multipleImageSupport:Ke,ref:function(e){if(null!==e&&e.textContent&&e.textContent.trim()!=Ee.trim()&&et.setInput){var t=jn(et.flatList);et.setInput(t),pn(t)}else(null!==e&&e.textContent&&e.textContent.trim()==Ee.trim()&&et.setInput||et.setInput)&&(et.setInput(""),pn(""))},id:"MathDisplayContainer"},c.createElement("span",{id:"MathJaxSpan-"+h,className:Jt?"emptyText":"mjx-process",dangerouslySetInnerHTML:{__html:en}}),wt&&!$t&&c.createElement(ns,{isInTarget:kt},(null===He||void 0===He?void 0:He.placeholderText)||"Drop images here or upload from your computer"))))),Ke&&Zt?c.createElement(xs,{multipleImages:Qe,isMobile:Zt,ocrData:He},c.createElement(jo,(0,rt.Z)({},tr,{ref:v}))):c.createElement(es,{multipleImageSupport:Ke,onContextMenu:function(e){return e.preventDefault()}},c.createElement(jo,(0,rt.Z)({},tr,{ref:v})))),!et.isOpen&&sn&&sn.length>0&&!V&&!Oe&&c.createElement(st.Listbox,{inputId:"input",className:Zt?"listDirection":"",isOpen:!et.isOpen,onSelectOption:function(e){if(sn[e].value&&et.setOpen){var t,n,r,i,a=sn&&(null===(t=sn[e])||void 0===t?void 0:t.questionId);Rn(a),Ki({latestImageUrl:""}),et.setOpen(!0),ln.clearEditorState(),ln.reflectResponseToEditor(sn[e].value),ln.updateCursorPosition(),ln.dispatchChanges(),Tn(!0),null===we||void 0===we||we(C.TYPEAHEAD),null===Je||void 0===Je||Je(null===(n=sn[e])||void 0===n?void 0:n.value),on(!1),Xe({type:P.CLICKSTREAM_INTERACTION,data:{eventname:Y,interaction:{element:{name:J,type:A.LINK},type:A.SEARCH},content:{metadata:{search:{search_id:he,track_id:me,strack_id:pe,profile:S.BIGEGG_SUGGEST,term:null===(r=sn[e])||void 0===r?void 0:r.value,auto_type:Ce(f||"",le||"",ge||""),result_id:null===(i=sn[e])||void 0===i?void 0:i.questionId,result_rank:e+1,result_type:T.SUGGESTIONS,match_count:sn.length,intent:E.STUDY,results:Zn?Zn.typeaheadSearchResults:void 0}}}},eventVersion:3})}},options:sn||[],pseudoFocusedIndex:-1,selectedIndex:-1}))},Es=et.ZP.div.withConfig({componentId:"sc-183e3fn-0"})(["display:flex;align-items:center;font-family:",";color:",";margin-top:7px;"],ua.Z.family.aspira,p.Z.red700),Ss=function(e){var t=e.message,n=e["data-test"];return c.createElement(Es,{"data-test":n},c.createElement(d.Z,{size:"small",svgColor:p.Z.red700}),t)},Is=Ss,ks=Vi.Z.md,ws=((0,et.iv)(["@font-face{font-family:'Mathway';src:url(",");}"],Wo()),et.ZP.div.withConfig({componentId:"ontpz2-0"})(["display:flex;flex-wrap:wrap;"])),Ts=et.ZP.button.withConfig({componentId:"ontpz2-1"})(["font-family:'Mathway' !important;height:40px;margin:0 "," "," 0;border-radius:4px;border:none;cursor:pointer;background-color:",";color:",";box-shadow:0px 2px 2px 0px rgba(34,34,34,0.25);"],(function(e){return e.theme.cuiTheme.spacing.xs}),(function(e){return e.theme.cuiTheme.spacing.xs}),(function(e){return e.darkTheme?p.Z.grey700:p.Z.grey050}),(function(e){return e.darkTheme?p.Z.white:p.Z.grey950})),Ms=et.ZP.button.withConfig({componentId:"ontpz2-2"})(["font-family:",";height:40px;width:208px;margin:0 "," "," 0;border-radius:4px;border:none;cursor:pointer;background-color:",";color:",";font-size:",";box-shadow:0px 2px 2px 0px rgba(34,34,34,0.25);@media only screen and (max-width:","){width:100%;}"],(function(e){return e.theme.cuiTheme.font.family}),(function(e){return e.theme.cuiTheme.spacing.xs}),(function(e){return e.theme.cuiTheme.spacing.xs}),(function(e){return e.darkTheme?p.Z.grey700:p.Z.grey050}),(function(e){return e.darkTheme?p.Z.white:p.Z.grey950}),(function(e){return e.theme.cuiTheme.font.size.xxs}),Vi.Z.sm.max),Ps=et.ZP.div.withConfig({componentId:"ontpz2-3"})(["display:flex;justify-content:center;.math-button{width:35px;padding-left:5px;}.geometry-button{width:59px;}.greekAlphabet-button{width:44px;}@media (max-width:","){.math-button{width:34px;padding-left:5px;}.geometry-button{width:51px;}.greekAlphabet-button{width:41px;}}"],ks.max),As=et.ZP.span.withConfig({componentId:"ontpz2-4"})(["font-weight:",";"],(function(e){return e.theme.cuiTheme.font.weight.medium})),_s=function(e){var t,n=e.subject,r=e.darkTheme,i=void 0!==r&&r,a=e.setKeyPressValue,o=e.physicsEquations,s=e.mtcConversationId,l=(0,h.createTheme)({},h.themes.horizon),u=n||"math",d=Ie[u],p=(t=o,Se.map((function(e){var n=t.find((function(t){return t.dataId===e.dataId}));return n&&(e.Label=n.Label),e}))),m=function(e){a(e),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.INFO,message_name:Q,message_detail:u},content:s?{metadata:{multi_turn_chat:{conversation_id:s}}}:void 0},eventVersion:3})};return c.createElement(h.ThemeProvider,{theme:l},c.createElement(ws,{"data-test":_a},"physics"===n?p.map((function(e,t){var n=e.Label,r=e.Text,a=e.dataId;return c.createElement(Ms,{key:t,darkTheme:i,onClick:function(){return m(e)},"data-test":a},c.createElement(As,null,"".concat(n,": ")),c.createElement("span",{dangerouslySetInnerHTML:{__html:r}}))})):"greekAlphabet"===n?ke.map((function(e,t){var n=e.id,r=e.label;return c.createElement(Ps,{"data-test":n,key:t},c.createElement(Ts,{darkTheme:i,key:t,onClick:function(){return m(e)},className:"".concat(u,"-button"),"data-test":"key-".concat(n)},c.createElement("span",{dangerouslySetInnerHTML:{__html:r}})))})):d.keys.map((function(e,t){var n=e.id,r=e.character||e.uni;return c.createElement(Ps,{"data-test":n,key:t},c.createElement(Ts,{key:t,darkTheme:i,onClick:function(){return m(e)},className:"".concat(u,"-button"),"data-test":"key-".concat(n)},r))}))))},Os=_s,Ns=et.ZP.div.withConfig({componentId:"sc-1251l4u-0"})(["padding-top:",";max-width:40rem;@media only screen and (max-width:","){display:",";grid-template-columns:1fr auto;}"],(function(e){return e.theme.cuiTheme.font.size.sm}),Vi.Z.sm.max,(function(e){return e.open?"inline":"inline-grid"})),Zs=et.ZP.p.withConfig({componentId:"sc-1251l4u-1"})(["overflow:hidden;width:100%;padding:0;margin:0;font-size:","rem;line-height:","rem;text-overflow:ellipsis;color:",";a,a:visited{font-size:inherit;font-weight:normal;color:",";svg{min-height:initial;min-width:initial;width:0.75rem;height:0.75rem;}}@media only screen and (max-width:","){display:",";height:",";color:",";white-space:",";}"],.75,.975,(function(e){return e.theme.cuiTheme.colors.border.medium600}),(function(e){return e.theme.cuiTheme.colors.border.dark700}),Vi.Z.sm.max,(function(e){return e.open?"inline":"inline-block"}),(function(e){return e.open?"auto":"12px"}),(function(e){return e.theme.cuiTheme.colors.border.medium600}),(function(e){return e.open?"normal":"nowrap"})),Hs=(0,et.ZP)(go.rU).withConfig({componentId:"sc-1251l4u-2"})(["display:none;font-size:","rem;line-height:","rem;&:hover{cursor:pointer;}@media only screen and (max-width:","){display:inline;padding-left:",";}"],.75,.975,Vi.Z.sm.max,(function(e){return e.open?Ye.Z.px4:0})),Ls=function(e){var t=e.mtcDisclaimerLocalisation,n=void 0===t?je.mtcLegalDisclaimer:t,r=(0,c.useState)(!0),i=(0,a.Z)(r,2),o=i[0],s=i[1],l=new Set([Hi.PHONE,Hi.TABLET]),u=Ji(),d=l.has(u);return(0,c.useEffect)((function(){var e=setTimeout((function(){d&&s(!1)}),5e3);return function(){clearTimeout(e)}}),[]),c.createElement(Ns,{open:o},c.createElement(Zs,{"data-test":"".concat("lastDisclaimerShown","-dataTest"),open:o},n.text||"Instant responses come from subject-matter experts, AI models trained on Chegg's learning content, or OpenAI\u200b. Automated chats are recorded & may be used to improve your experience. Please don\u2019t share sensitive info."),c.createElement(Hs,{open:o,onClick:function(){s(!o)},hasButtonBehavior:!0,isInline:!0,"aria-hidden":!0},o?"See less":"See more"))},zs=n(68456),Rs=et.ZP.div.withConfig({componentId:"sc-1s7pa37-0"})([""]),Ds=function(e){var t=e.handleSubject,n=e.darkTheme,r=e.currentSubject,i=e.allSubjects,o=e.mtcConversationId,s=e.isUicAtBottom,l=Object.keys(i),u=Object.values(i).findIndex((function(e){return e===r})),d=u>-1?l[u]:l[0],h=(0,c.useState)(d),p=(0,a.Z)(h,2),m=p[0],v=p[1],f=new Set([Hi.PHONE,Hi.TABLET]),g=Ji(),y=f.has(g),b=(0,c.useRef)(!0),x=(0,c.useState)("180px"),C=(0,a.Z)(x,2),E=C[0],S=C[1];return(0,c.useEffect)((function(){S(y?"auto":"180px")}),[y]),(0,c.useEffect)((function(){b.current||Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.SELECT,element:{text:m.toLowerCase(),name:V,type:A.DROP_DOWN,region_name:s?oe:N}},content:o?{metadata:{multi_turn_chat:{conversation_id:o}}}:void 0},eventVersion:3}),b.current=!1}),[m]),c.createElement(Rs,{onClick:function(e){return e.stopPropagation()},className:"subject-dropdown-".concat(m.toLowerCase().replace(" ","-"))},c.createElement(zs.FloatingDropdown,{inputId:Oa,options:l,onSelectValue:function(e){v(e),t(i[e])},"data-test":Oa,labelText:"",value:m,width:E,defaultValue:d,visuallyHideLabel:!0,adjustToBackgroundColor:n?"dark":void 0}))},Us=n(72284),Bs=n(16151),Fs=et.ZP.button.withConfig({componentId:"sc-1uiwe5a-0"})(["align-items:center;background-color:",";border:",";border-radius:",";cursor:pointer;display:flex;height:",";justify-content:center;margin:0;padding:0;width:",";",""],p.Z.orange800,Ye.Z.px8,(function(e){return e.theme.cuiTheme.radius.circle}),Ye.Z.px40,Ye.Z.px40,(function(e){return e.disabled?(0,et.iv)(["background-color:",";cursor:default;"],p.Z.grey200):(0,et.iv)(["&:hover{","}"],(0,Je.Z)())})),js=((0,et.ZP)(Bs.Z).withConfig({componentId:"sc-1uiwe5a-1"})(["margin-left:-1px;"]),["data-test","disabled","isLoading"]),qs=(0,c.forwardRef)((function(e,t){var n=e["data-test"],r=e.disabled,i=e.isLoading,a=(0,mr.Z)(e,js);return c.createElement(Fs,(0,rt.Z)({},a,{"data-test":n,disabled:r||i,ref:t}),i?c.createElement(ot.Z,{"aria-hidden":!0,"data-test":n&&"".concat(n,"-loading"),svgColor:p.Z.grey600}):c.createElement(Us.Z,{"aria-hidden":!0,"data-test":n&&"".concat(n,"-arrow-icon"),pointing:Te.RIGHT,svgColor:r?p.Z.grey600:p.Z.white}))})),Ws=qs,Gs=(0,et.ZP)(ca.SecondaryButton).withConfig({componentId:"sc-1lxdnf7-0"})(["height:",";width:auto;border-radius:100px;border:1px solid rgba(226,225,230,1) !important;box-shadow:unset !important;"],(function(e){return e.theme.cuiTheme.font.size.xl})),Ks=et.ZP.div.withConfig({componentId:"sc-1lxdnf7-1"})(["height:",";width:48.625rem;display:flex;flex-direction:row;align-items:centre;gap:",";margin-bottom:16px;@media (max-width:","){height:",";width:34.938rem;}"],(function(e){return e.theme.cuiTheme.font.size.xl}),(function(e){return e.theme.cuiTheme.font.size.sm}),(function(e){return e.theme.cuiTheme.breakpoints.lg.max}),(function(e){return e.theme.cuiTheme.font.size.xl})),Vs=et.ZP.p.withConfig({componentId:"sc-1lxdnf7-2"})(["size:14px;margin-top:",";margin-right:",";display:flex;justify-content:center;align-items:center;color:rgba(48,44,65,1);font-weight:700;"],(function(e){return e.theme.cuiTheme.font.size.md}),(function(e){return e.theme.cuiTheme.font.size.xs})),Qs=et.ZP.span.withConfig({componentId:"sc-1lxdnf7-3"})(["font-size:small;"]),$s=function(e){var t=e.setTryMsg,n=e["data-test"],r=e.mtcLabelLocalisation,i=void 0===r?je.mtcLabels:r,o=(0,c.useState)(3),s=(0,a.Z)(o,2),l=s[0],u=s[1],d=(0,c.useState)(!1),h=(0,a.Z)(d,2),p=h[0],m=h[1],v=(0,c.useState)(!0),f=(0,a.Z)(v,2),g=f[0],y=f[1];(0,c.useEffect)((function(){var e=function(){window.innerWidth>=parseInt(Vi.Z.lg.min,10)?(u(2),m(!1),y(!0)):(u(0),m(!0),y(!1))};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[]);return c.createElement(c.Fragment,null,g&&c.createElement(Ks,null,!p&&c.createElement(Vs,null,i.tryItOut||"Try it out!"),i.tryItOutLabel.slice(0,l).map((function(e,r){return c.createElement(Gs,{key:r,"aria-label":e,"data-test":"".concat(n,"-").concat(r),id:"".concat(n,"-").concat(r),variant:"outlined",onClick:function(){!function(e){t(e),Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{element:{name:se,type:A.COMPONENT,text:e},type:A.SELECT}},eventVersion:3})}(e)}},c.createElement(Qs,null,e))}))))},Xs=n(20358),Ys=n(97005),Js=n(15253),el=(0,nr.ZP)(ys||(ys=(0,tr.Z)(["\n  query getTextbookSearchResultsByISBN(\n    $profile: String\n    $query: String\n    $page: Int\n    $contentType: String\n    $skipIntent: Boolean\n  ) {\n    search(\n      profile: $profile\n      query: $query\n      page: $page\n      contentType: $contentType\n      skipIntent: $skipIntent\n    ) {\n      textbooks {\n        responseContent {\n          docs {\n            ... on SearchTextbook {\n              url\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),tl=function(){var e=(0,i.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=nl(),r=rl(t),e.abrupt("return",n.query({query:el,variables:r,errorPolicy:ge.ALL}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nl=function(){return new Xs.f({defaultOptions:{watchQuery:{fetchPolicy:"no-cache",errorPolicy:"ignore"},query:{fetchPolicy:"no-cache",errorPolicy:"all"}},cache:new Ys.h,link:(0,Js.L)({uri:"".concat((0,ao.getConfig)(ze)),headers:{"apollographql-client-name":"chegg-web-uic","apollographql-client-version":"v1"}})})},rl=function(e){return{profile:_e,query:e,page:1,contentType:"textbooks",skipIntent:!0}},il=tl,al=n(23892),ol=n.n(al),sl=n(10249),ll=n(27061),cl=(ol()()||{}).publicRuntimeConfig,ul=(void 0===cl?{}:cl).uicDataSource||(0,ao.getConfig)(ze)||ll.env.UIC_DATA_SOURCE;(0,sl.addGqlRoute)(ze,ul);var dl,hl,pl=(0,nr.ZP)(bs||(bs=(0,tr.Z)(["\n  query getStudySearchResultsWithHtml(\n    $profile: String\n    $queryHtml: String\n    $page: Int\n    $showSpellcheck: Boolean\n    $showSqna: Boolean\n    $showSqnaOnly: Boolean\n    $showUversity: Boolean\n    $matchScoreLimit: Int\n    $matchScoreV2Limit: Int\n    $contentType: String\n    $skipIntent: Boolean\n    $contentTypesLimit: [ContentTypeLimit!]\n    $uuid: UUID\n    $source: SearchStudySourceInput\n  ) {\n    searchWithHtml(\n      input: {\n        profile: $profile\n        queryHtml: $queryHtml\n        page: $page\n        showSqna: $showSqna\n        showSqnaOnly: $showSqnaOnly\n        matchScoreLimit: $matchScoreLimit\n        matchScoreV2Limit: $matchScoreV2Limit\n        showSpellcheck: $showSpellcheck\n        showUversity: $showUversity\n        contentType: $contentType\n        skipIntent: $skipIntent\n        contentTypesLimit: $contentTypesLimit\n        source: $source\n      }\n    ) {\n      searchId(uuid: $uuid)\n      order\n      ...StudyField\n      ...SpellcheckField\n      __typename\n    }\n  }\n\n  fragment SearchResponseContentFields on SearchResponseContent {\n    numFound\n    start\n    limit\n    __typename\n  }\n\n  fragment StudyField on SearchResult {\n    study {\n      responseContent {\n        docs {\n          __typename\n          ... on SearchQna {\n            id\n            uuid\n            title\n            source\n            questionHighlight\n            question\n            url\n            answerDisplay\n            score\n            matchScore\n            matchScoreV2\n            isSqna\n            questionStatus\n            __typename\n            answerFormats\n          }\n          ... on SearchTbsProblem {\n            id\n            source\n            bookEditionNumber\n            title\n            bookTitle\n            chapterName\n            answerDisplay\n            problemName\n            ean\n            url\n            question\n            questionHighlight\n            solutionId\n            score\n            matchScore\n            matchScoreV2\n            __typename\n          }\n        }\n        ...SearchResponseContentFields\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n\n  fragment SpellcheckField on SearchResult {\n    spellcheck {\n      responseContent {\n        docs {\n          __typename\n          ... on SearchSpellcheck {\n            correctedQuery\n            confidence\n            __typename\n          }\n        }\n        ...SearchResponseContentFields\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n"])));!function(e){e.QNA="QNA",e.TBS="TBS"}(dl||(dl={})),function(e){e.NoExactMatchingSearchResults="NO_EXACT_MATCH"}(hl||(hl={}));var ml,vl=function(e){return null!==e.matchScore},fl=function(e){var t,n,r,i,a=(null===(t=e.searchWithHtml)||void 0===t||null===(n=t.study)||void 0===n||null===(r=n.responseContent)||void 0===r?void 0:r.docs).filter(vl).sort((function(e,t){return t.matchScore-e.matchScore}));return{searchId:null===(i=e.searchWithHtml)||void 0===i?void 0:i.searchId,data:a}},gl=function(e){var t,n,r,i=(0,u.useLazyQuery)(pl,{errorPolicy:ge.ALL,fetchPolicy:fe.NO_CACHE,context:(0,it.Z)({headers:(0,it.Z)({},He,e?"UIC-".concat(e):Le)},ze,!0)}),o=(0,a.Z)(i,2),s=o[0],l=o[1],c=l.called,d=l.data,h=function(e){if(e){var t=e.queryHtml,n=e.page;s({variables:{profile:_e,queryHtml:t,page:void 0===n?1:n,showSqna:!0,skipIntent:!0,showSpellcheck:!0,source:dl.QNA,contentType:Oe,contentTypesLimit:[{contentType:Oe,limit:10}]}})}};return l.loading?{status:Mr.Loading}:c?null!==d&&void 0!==d&&null!==(t=d.searchWithHtml)&&void 0!==t&&null!==(n=t.study)&&void 0!==n&&null!==(r=n.responseContent)&&void 0!==r&&r.docs?{data:fl(d),fetch:h,status:Mr.Ok}:{fetch:h,metadata:{code:hl.NoExactMatchingSearchResults},status:Mr.Error}:{fetch:h,status:Mr.NotCalled}},yl=Vi.Z.sm,bl=Vi.Z.lg;!function(e){e.CONTROLS_SECTION="controls-section",e.TEXTAREA="textarea",e.SUBMIT_BUTTON="submit-button"}(ml||(ml={}));var xl=et.ZP.div.withConfig({componentId:"sc-9pku2s-0"})(["align-items:center;display:flex;border-right:1px solid ",";justify-content:flex-end;> button{margin-right:",";}@media (max-width:","){height:auto;border-right:none;}"],p.Z.grey500,Ye.Z.px16,bl.max),Cl=et.ZP.form.withConfig({componentId:"sc-9pku2s-1"})(["max-width:",";.listDirection{bottom:100%;top:unset;}"],(function(e){return e.isSlimmerVersion?"1440px":"900px"})),El=et.ZP.div.withConfig({componentId:"sc-9pku2s-2"})(["display:flex;@media (max-width:","){flex-direction:column;}"],bl.max),Sl=et.ZP.div.withConfig({componentId:"sc-9pku2s-3"})(["display:flex;"," @media (max-width:","){flex-direction:column-reverse;}"],(function(e){return e.showKeyboardAnimation?"\n    max-height: 500px;\n    transition: max-height 500ms ease-in;\n    &.hidden {\n      max-height: 0;\n      transition: max-height 500ms ease-out;\n      overflow: hidden;\n    }\n  ":"\n    &.hidden {\n      display: none\n    };\n  "}),bl.max),Il=et.ZP.div.withConfig({componentId:"sc-9pku2s-4"})(["flex-grow:1;max-width:",";position:relative;"],(function(e){return e.isSlimmerVersion?"932px":"640px"})),kl=et.ZP.div.withConfig({componentId:"sc-9pku2s-5"})(["display:flex;@media (max-width:","){margin-top:20px;justify-content:space-between;}"],bl.max),wl=et.ZP.div.withConfig({componentId:"sc-9pku2s-6"})(["margin-left:20px;@media (max-width:","){margin-left:0;}"],bl.max),Tl=et.ZP.div.withConfig({componentId:"sc-9pku2s-7"})(["flex-grow:1;margin-top:20px;@media only screen and (min-width:",") and (max-width:","){&{height:",";margin-top:",";overflow-y:",";}}"],yl.min,yl.max,(function(e){return e.isUicAtBottom?"118px":"unset"}),(function(e){return e.isUicAtBottom?"revert":"20px"}),(function(e){return e.isUicAtBottom?"scroll":"unset"})),Ml=et.ZP.div.withConfig({componentId:"sc-9pku2s-8"})(["margin:-10px 6px 0px 0px;"]),Pl=et.ZP.span.withConfig({componentId:"sc-9pku2s-9"})(["font-weight:",";font-size:",";letter-spacing:normal;"],ua.Z.weight.medium,ua.Z.size.px12),Al=et.ZP.div.withConfig({componentId:"sc-9pku2s-10"})(["display:flex;align-items:center;font-family:",";color:",";margin-top:7px;"],ua.Z.family.aspira,p.Z.red700),_l=function(e){var t=e.htmlQuery,n=void 0===t?void 0:t,r=e.exactMatch,i=void 0===r?void 0:r,a=e.exactMatchQuestionId,o=void 0===a?void 0:a,s=e.greatMatchQuestionIds,l=void 0===s?void 0:s,c=e.greatMatchQuestions,u=void 0===c?void 0:c,d=e.practiceMatchQuestion,h=void 0===d?void 0:d,p=e.searchId,m=void 0===p?"":p,v=e.strackId,f=void 0===v?"":v,g=e.trackId;return{htmlQuery:n,exactMatch:i,exactMatchQuestionId:o,greatMatchQuestionIds:l,greatMatchQuestions:u,practiceMatchQuestion:h,searchId:m,strackId:f,trackId:void 0===g?"":g}},Ol=function(){return("0000000000000"+(Math.abs(16777215*Math.random()<<0).toString(16)+Math.abs(16777215*Math.random()<<0).toString(16))).slice(-12)},Nl=function(){return Ol()},Zl=function(e){e=e.trim().replace(/-/g,"");var t=/^\d{9}(\d|X)$/.test(e),n=/^(978|979)\d{10}$/.test(e);return t||n},Hl=function(e){if(!(0,x.OP)(e))return!1;var t=e.split(",");if(t.length>1){var n=!1;return t.forEach((function(e){if(n=n||Zl(e))return!0})),n}return 1==t.length&&Zl(t[0])},Ll=function(e,t){if(x.Ax)try{window.sessionStorage.setItem(e,t)}catch(n){return}},zl=n(92525),Rl=n(31655);function Dl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ul(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dl(Object(n),!0).forEach((function(t){(0,it.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Bl,Fl=".chegg.com";(function(e){e.EXPERIMENT_IDENTIFIER="V",e.ID_TOKEN="id_token",e.ACCESS_TOKEN="access_token",e.JERICHO_SESSION="PHPSESSID",e.ORDER_REDIRECT="hwh_order_ref",e.LANG_PREFERENCE="langPreference",e.QA_AUDIENCE="qa_audience",e.EC_UPLOAD_PENDING="ec_upload_pending",e.COUPON_CODE="applied_coupon_code",e.PreviousTruex="sbm_previous_truex_gcs",e.CSID="CSID",e.CVID="CVID",e.EXP_OPT_IN="chegg_web_cbr_exp_opt_in",e.EXP_UAE="chegg_web_cbr_exp_uae",e.OPT_USER_PROFILE="opt-user-profile",e.HIDE_GET_APP_CTA="hide_get_app_cta",e.EXP_AA="chegg_web_cbr_aa_experiment",e.EXP_MTC="chegg_web_cbr_exp_mtc",e.AL_CELL="alCell",e.REWORKED_SEARCH_EXP="reworked-search-exp",e.HIDE_MWEB_TO_APP_SIGNIN_MODAL="hide_mweb_to_app_signin_modal",e.CLOUDFRONT_COUNTRY_CODE="country_code",e.LAST_ACCESSED_SUBJECT="last_accessed_subject",e.MULTIPLE_IMAGE_TOOLTIP="multiple_image_tooltip"})(Bl||(Bl={}));var jl=function(e){switch(e){case Bl.OPT_USER_PROFILE:case Bl.EXPERIMENT_IDENTIFIER:case Bl.ID_TOKEN:case Bl.ACCESS_TOKEN:case Bl.JERICHO_SESSION:case Bl.ORDER_REDIRECT:case Bl.EC_UPLOAD_PENDING:case Bl.CLOUDFRONT_COUNTRY_CODE:case Bl.LANG_PREFERENCE:case Bl.COUPON_CODE:case Bl.PreviousTruex:case Bl.EXP_UAE:case Bl.EXP_AA:return Fl}},ql=function(e,t){var n=jl(e);if(null!==t&&void 0!==t&&t.res){var r=n?" path=/; domain=".concat(n):"";t.res.setHeader("Set-Cookie",["".concat(e,"=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0;").concat(r)])}else Rl.Z.remove(e,{domain:n})},Wl=function(e,t,n){return Rl.Z.set(e,t,Ul(Ul({},n),{},{domain:jl(e)}))},Gl=function(e){return Rl.Z.get(e)};function Kl(e,t,n){var r=new Date;r.setTime(r.getTime()+60*n*60*1e3);var i="expires="+r.toUTCString();document.cookie=e+"="+t+";"+i}var Vl=function(){var e=Gl(Bl.CVID),t=!0===(0,ao.getConfig)("expMTC"),n=(0,zl.useSafeOptimizelyFeature)("mtc",void 0,{overrideUserId:e}),r=n.clientReady,i=n.isEnabled,a=(0,l.useRouter)(),o=null===a||void 0===a?void 0:a.query.mtc,s="prod"===(0,ao.getConfig)("optimizelyConfig").optimizelyDeployEnv;return"disabled"===o&&ql(Bl.EXP_MTC),"enabled"===o&&Wl(Bl.EXP_MTC,"enabled",{}),"enabled"===Gl(Bl.EXP_MTC)||"enabled"===o?{isLoading:!1,isEnabled:t}:"disabled"===o?{isLoading:!1,isEnabled:!1}:s?{isLoading:!r,isEnabled:i&&t}:{isLoading:!1,isEnabled:!1}},Ql=et.ZP.div.withConfig({componentId:"sj7gtn-0"})(["background:",";border-radius:",";position:relative;"],(function(e){var t=e.isErrorBoxEnabled;return"".concat(t?p.Z.red100:p.Z.white)}),(function(e){return e.theme.cuiTheme.spacing.xs})),$l=et.ZP.img.withConfig({componentId:"sj7gtn-1"})(["width:100%;padding:",";"],(function(e){return e.theme.cuiTheme.spacing.xs})),Xl=et.ZP.div.withConfig({componentId:"sj7gtn-2"})(["display:flex;justify-content:center;svg{margin-right:5px;}"]),Yl=et.ZP.div.withConfig({componentId:"nnbpk4-0"})(["display:flex;align-items:flex-start;"]),Jl=et.ZP.div.withConfig({componentId:"nnbpk4-1"})(["margin-right:",";"],Ye.Z.px16),ec=et.ZP.span.withConfig({componentId:"nnbpk4-2"})(["font-weight:",";font-size:",";letter-spacing:normal;line-height:1.138rem;margin:0;letter-spacing:0.016rem;"],(function(e){return e.isLarge?ua.Z.weight.bold:ua.Z.weight.normal}),ua.Z.size.px14),tc=et.ZP.span.withConfig({componentId:"nnbpk4-3"})(["font-weight:",";font-size:",";letter-spacing:normal;line-height:",";margin:0;letter-spacing:0.022rem;"],ua.Z.weight.normal,ua.Z.size.px12,Ye.Z.px16),nc=(0,et.ZP)(Zo.Z).withConfig({componentId:"nnbpk4-4"})(["margin-left:0.625rem;cursor:pointer;"]),rc=function(e){var t=e.tooltipTitle,n=e.tooltipSubHeading,r=void 0===n?"":n,i=e.isCloseIcon,a=void 0!==i&&i,o=e.handleCloseIconClick;return c.createElement(c.Fragment,null,c.createElement(Yl,{"data-test":Ba},c.createElement(Jl,{"data-test":Fa,isCloseIcon:a},c.createElement(ec,{isLarge:!!r},t),r?c.createElement(tc,null,r):""),a&&o&&c.createElement(nc,{size:"xsmall",svgColor:"white",iconFill:"circle",onClick:function(e){return o(e)},"data-test":ja})))},ic=rc,ac=function(e){var t=e.className,n=e["data-test"],r=e.clientId,o=e.placeholder,I=e.editorId,k=void 0===I?"":I,M=e.isSubmitting,O=e.onClickSubmitButton,Z=e.value,R=void 0===Z?"":Z,D=e.onChange,U=void 0===D?x.ZT:D,B=e.editorInput,F=e.shouldClearEditor,j=void 0!==F&&F,W=e.onClearEditor,G=void 0===W?x.ZT:W,K=e.image,V=e.onImageChange,Q=e.submitButtonAriaLabel,Y=e.showKeyboard,J=void 0===Y||Y,ee=e.showUploadImage,te=void 0===ee||ee,ie=e.darkTheme,ae=void 0!==ie&&ie,se=e.isBorderOrange,le=void 0===se||se,ce=e.onFocus,ue=void 0===ce||ce,he=e.imageButtonId,pe=void 0===he?"":he,me=e.keyboardButtonId,ve=void 0===me?"":me,fe=e.populateHtml,ge=void 0===fe?"":fe,ye=e.enableAutoSuggest,Ee=e.isSlimmerVersion,Se=void 0!==Ee&&Ee,Ie=e.clearState,ke=void 0!==Ie&&Ie,we=e.localisationData,Te=void 0===we?je:we,Pe=e.showKeyboardAnimation,Ae=void 0!==Pe&&Pe,_e=e.handleControlBtnOnClick,Oe=e.showLegalDisclaimer,He=void 0!==Oe&&Oe,Le=e.hideTypeahead,ze=void 0!==Le&&Le,Re=e.hideAutoSuggestOnFirstLoad,De=void 0!==Re&&Re,Ue=e.showSpills,Be=void 0!==Ue&&Ue,qe=e.enableNewLineOnEnter,We=void 0!==qe&&qe,Ge=e.mtcConversationId,Ke=e.onImageUploadButtonClick,$e=e.enableDesktopToAppUICExperiment,Ye=e.multipleImageSupport,Je=void 0!==Ye&&Ye,et=e.isUicAtBottom,tt=void 0!==et&&et,rt=e.enableMultipleImageTooltip,it=void 0!==rt&&rt,at=(0,c.useRef)(),ot=(0,c.useRef)(null),st=Vl(),lt=Gl(Bl.MULTIPLE_IMAGE_TOOLTIP),ct=new Set([Hi.PHONE,Hi.TABLET,Hi.LAPTOP]),ut=Ji(),dt=ct.has(ut),ht=(0,c.useState)(!(!Je||!it||lt)),pt=(0,a.Z)(ht,2),mt=pt[0],vt=pt[1];(0,c.useEffect)((function(){if(!lt&&it){vt(!0);var e=setTimeout((function(){vt(!1),Kl(Bl.MULTIPLE_IMAGE_TOOLTIP,!0,1)}),5e3);return function(){return clearTimeout(e)}}}),[]);var ft=Te.tooltipTexts,gt=Te.subjectsList,yt=Te.physicsEquationsLabels,bt=Te.ocrData,xt=Te.editorInlineErrors,Ct=Te.sideBottomErrors,Et=Te.mtcLabels,St=Te.mtcLegalDisclaimer,It=(0,c.useRef)(null),kt=function(){var e;Je&&_r(!0),Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.CLICK,element:{name:L,type:A.ICON,region_name:Je?de:tt?oe:z}},content:Ge?{metadata:{multi_turn_chat:{conversation_id:Ge}}}:void 0},eventVersion:3}),null===(e=It.current)||void 0===e||e.click(),_e&&_e("upload_image")},wt=(0,c.useState)(!1),Tt=(0,a.Z)(wt,2),Mt=Tt[0],Pt=Tt[1],At=void 0!=j?j:Mt,_t=void 0!=G?G:Pt,Ot=(0,c.useState)(),Nt=(0,a.Z)(Ot,2),Zt=Nt[0],Ht=Nt[1],Lt=void 0!=K?K:Zt,zt=void 0!=V?V:Ht,Rt=(0,h.createTheme)({},h.themes.horizon),Dt=(0,c.useState)(""),Ut=(0,a.Z)(Dt,2),Bt=Ut[0],Ft=Ut[1],jt=(0,c.useState)(""),qt=(0,a.Z)(jt,2),Wt=qt[0],Gt=qt[1],Kt=(0,c.useState)(""),Vt=(0,a.Z)(Kt,2),Qt=Vt[0],$t=Vt[1],Xt=(0,c.useState)(""),Yt=(0,a.Z)(Xt,2),Jt=Yt[0],en=Yt[1],tn=(0,c.useState)(!1),nn=(0,a.Z)(tn,2),rn=nn[0],an=nn[1],on=(0,c.useState)(""),sn=(0,a.Z)(on,2),ln=sn[0],cn=sn[1],un=(0,c.useState)(!1),dn=(0,a.Z)(un,2),hn=dn[0],pn=dn[1],mn=(0,c.useState)(null),vn=(0,a.Z)(mn,2),fn=vn[0],gn=vn[1],yn=(0,c.useState)(""),bn=(0,a.Z)(yn,2),xn=bn[0],Cn=bn[1],En=(0,c.useState)(""),Sn=(0,a.Z)(En,2),In=Sn[0],kn=Sn[1],wn=(0,c.useState)(null),Tn=(0,a.Z)(wn,2),Mn=Tn[0],Pn=Tn[1],An=(0,c.useState)(!1),_n=(0,a.Z)(An,2),On=_n[0],Nn=_n[1],Zn=(0,c.useState)(!1),Hn=(0,a.Z)(Zn,2),Ln=Hn[0],zn=Hn[1],Rn=(0,c.useState)(!1),Dn=(0,a.Z)(Rn,2),Un=Dn[0],Bn=Dn[1],Fn=(0,c.useState)(R),jn=(0,a.Z)(Fn,2),qn=jn[0],Wn=jn[1],Gn=(0,c.useState)(""),Kn=(0,a.Z)(Gn,2),Vn=Kn[0],Qn=Kn[1],Yn=(0,c.useState)(null),Jn=(0,a.Z)(Yn,2),er=Jn[0],tr=Jn[1],nr=(0,c.useState)(!!ue),rr=(0,a.Z)(nr,2),ir=rr[0],ar=rr[1],or=(0,c.useState)(""),sr=(0,a.Z)(or,2),lr=sr[0],cr=sr[1],ur=(0,c.useState)({legacyStrackId:"",legacyTrackId:"",legacySearchId:""}),dr=(0,a.Z)(ur,2),hr=dr[0],pr=dr[1],mr=(0,c.useState)({role:"user",messageType:"user_hard_coded_text"}),vr=(0,a.Z)(mr,2),fr=vr[0],gr=(vr[1],(0,c.useState)(!1)),yr=(0,a.Z)(gr,2),br=yr[0],xr=yr[1],Cr=(0,c.useState)({counter:0,imageData:[{imagePreview:"",fileName:null}]}),Er=(0,a.Z)(Cr,2),Ir=Er[0],wr=Er[1],Tr=(0,c.useState)(!1),Mr=(0,a.Z)(Tr,2),Pr=Mr[0],_r=Mr[1],Or=(0,c.useState)(0),Nr=(0,a.Z)(Or,2),Zr=Nr[0],Hr=Nr[1],Lr=(0,c.useState)(void 0),zr=(0,a.Z)(Lr,2),Rr=zr[0],Dr=zr[1];(0,c.useEffect)((function(){(Qr()||We)&&xr(!0)}),[]);var Ur=(0,l.useRouter)(),Br=gl(),Fr="loading"===Br.status,jr="ok"===Br.status,qr="not-called"===Br.status,Wr=(0,u.useReactiveVar)(Ki).latestImageUrl,Gr=function(){var e;if(Je&&Ir&&Ir.counter>0){var t=Kr(Ir.imageData);e=qi(qn,t)}else{var n=Wr||er;e=qi(qn,n?[n]:[""])}return e},Kr=function(e){for(var t=[],n=0;n<e.length;n++){var r;null!==(r=e[n])&&void 0!==r&&r.imagePreview&&t.push(e[n].imagePreview)}return t};(0,c.useEffect)((function(){zn(!1),Nn(!1)}),[qn]),(0,c.useEffect)((function(){Bt&&(0,g.setLinkHeader)("X-Chegg-Search-Id",Bt)}),[Bt]);var Vr=function(){var e=(0,i.Z)(s().mark((function e(t,n){var r,i,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return st.isEnabled&&!Qr()&&($t(Ol()),Ft((0,b.hu)()),Gt(Nl())),r=_l({searchId:Bt,strackId:Wt,trackId:Qt}),Ll(Ze,JSON.stringify(r)),i={editorValue:t===C.TYPEAHEAD?Rr:qn,autoType:Ce(qn,xn,In),searchSubmitType:t},Ll("search-query-metadata",JSON.stringify(i)),Bn(!0),e.next=8,Xr(qn);case 8:e.sent?a=T.TEXTBOOKS:(o=Gr(),Qn(o),a=T.QUESTIONS,ti(o,t,n)),Xe(Qe(xe(qn),xn,In,t,a,tt,Ge,fr,Wt,Qt,Bt));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Qr=function(){var e;return"/"==(null===Ur||void 0===Ur?void 0:Ur.asPath)||(null===Ur||void 0===Ur||null===(e=Ur.asPath)||void 0===e?void 0:e.startsWith("/?"))},$r=function(e){return e?e=(e=(e=xe(e)).trim()).replace(/-/g,""):e},Xr=function(){var e=(0,i.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,x.OP)(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=$r(t),r=!1,!Qr()||!Hl(n)){e.next=8;break}return e.next=7,Yr(n);case 7:r=e.sent;case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Yr=function(){var e=(0,i.Z)(s().mark((function e(t){var n,r,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.split(",").length>1)){e.next=5;break}return Nn(!0),Bn(!1),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:ne,message_detail:"Please search 1 EAN or ISBN at a time."}},eventVersion:3}),e.abrupt("return",!0);case 5:return e.prev=5,e.next=8,Jr(t);case 8:if(1==(null===(n=e.sent)||void 0===n?void 0:n.length)){e.next=16;break}return zn(!0),Bn(!1),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:re,message_detail:"Sorry, we couldn't find anything matching your search."}},eventVersion:3}),e.abrupt("return",!0);case 16:if(i=n[0],a=null===(r=i.url)||void 0===r?void 0:r.trim(),!(0,x.OP)(a)){e.next=22;break}return e.next=21,ei(a);case 21:return e.abrupt("return",e.sent);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(5),Bn(!1),(0,y.O7)({error:"".concat($n.FAILED_ISBN_SEARCH,": Failed to get isbn search results."),location:Xn.UIC_SUBMIT,severity:y.zb.ERROR},{errorMessage:e.t0.message,teamName:Me.GARUDA});case 28:return e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,null,[[5,24]])})));return function(t){return e.apply(this,arguments)}}(),Jr=function(){var e=(0,i.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,il(t).then((function(e){var t,n,r;return null===(t=e.data.search)||void 0===t||null===(n=t.textbooks)||void 0===n||null===(r=n.responseContent)||void 0===r?void 0:r.docs})).catch((function(e){throw new Error(null===e||void 0===e?void 0:e.message)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ei=function(){var e=(0,i.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ur.push(t);case 2:return e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ti=function(e,t,n){O?O(e,Bt,Wt,Qt,t,Ce(xe(qn),xn,In),n,Je?Zr:K?1:0):function(e){Fr||Br.fetch({queryHtml:e})}(e)},ni=void 0!=M?M:Un;(0,c.useEffect)((function(){if(!Fr&&!qr){var e=_l({htmlQuery:Vn,exactMatch:!1});if(jr){var t=function(e){var t=[],n=[];e.forEach((function(e){var r=e.matchScore;r&&r>=98?t.push(e):n.push(e)}));var r,i,a=null,o=[],s=null;return 0!==t.length?(a=t[0],o=t.slice(1,6),s=null!==(r=t[5])&&void 0!==r?r:null):(o=n.slice(0,5),s=null!==(i=n[5])&&void 0!==i?i:null),{bestMatch:a,greatMatches:o,practiceMatch:s}}(Br.data.data),n=t.bestMatch,r=t.greatMatches,i=t.practiceMatch;e=_l({htmlQuery:Vn,exactMatch:!!n,exactMatchQuestionId:n?n.id:null,greatMatchQuestionIds:null===r||void 0===r?void 0:r.map((function(e){return e.id})),greatMatchQuestions:r,practiceMatchQuestion:i,searchId:Bt,strackId:Wt,trackId:Qt}),Xe({type:P.SEARCH_QUERY,data:{search_track_id:Qt||void 0,search_strack_id:Wt||void 0,search_id:Bt||void 0,search_type:Mn,search_profile:S.BIGEGG_SRP,search_term:R,search_auto_type:Ce(xe(qn),xn,In),search_page_number:1,search_page_size:Br.data.data.length,search_match_count:Br.data.data.length,search_intent:E.STUDY,search_results:Br.data.data.length>0?Ve(Br.data.data):void 0},eventVersion:4})}else{var a;(null===(a=Br.metadata)||void 0===a?void 0:a.code)===hl.NoExactMatchingSearchResults&&(0,y.O7)({error:"".concat($n.FAILED_SEARCH,": No exact matching search results found."),location:Xn.UIC_SUBMIT,severity:y.zb.WARNING},{teamName:Me.GARUDA})}Ll(Ze,JSON.stringify(e)),Ki({latestImageUrl:""}),"/"!==Ur.pathname&&Bn(!1),Ur.pathname===Ne?(Ur.push(Ne,void 0,{shallow:!0}),sessionStorage.setItem("curr_path",Ne)):(Ur.push(Ne),sessionStorage.setItem("curr_path",Ne))}}),[Br.status]),(0,c.useEffect)((function(){Lt&&""!==Wr&&Ki({latestImageUrl:Lt})}),[Lt]),(0,c.useEffect)((function(){qn.length>=Fe?(pn(!0),Xe({type:P.CLICKSTREAM_NOTIFICATIONS,data:{notifications:{type:w.ERROR,message_name:$,message_detail:X},content:Ge?{metadata:{multi_turn_chat:{conversation_id:Ge}}}:void 0},eventVersion:3}),(0,y.O7)({error:"".concat($n.CHAR_LIMIT_EXCEEDED,": Entered query exceeded max character limit > ").concat(Fe),location:Xn.UIC_EDITOR,severity:y.zb.WARNING},{teamName:Me.GARUDA})):pn(!1)}),[qn]);return Ar(ot,(function(e){e&&e.currentTarget&&ot.current!==e.currentTarget&&(document.body.style.removeProperty("user-select"),ar(!1))})),(0,c.useEffect)((function(){Xe({type:P.CLICKSTREAM_COMPONENT_VIEW,data:{eventname:q,component_view:{component:{name:z,type:A.COMPONENT,region_name:tt?oe:N}}},eventVersion:3})}),[]),(0,c.useEffect)((function(){hr.legacySearchId&&hr.legacyStrackId&&hr.legacyTrackId?($t(hr.legacyTrackId),Ft(hr.legacySearchId),Gt(hr.legacyStrackId)):($t(Ol()),Ft((0,b.hu)()),Gt(Nl()))}),[hr]),(0,c.useEffect)((function(){}),[Mn]),c.createElement(c.Fragment,null,c.createElement(Sr.Provider,{value:{notifications:fn,setNotifications:gn}},c.createElement("div",{ref:ot},Be&&Qr()&&c.createElement($s,{setTryMsg:cr,"data-test":"try-it-out-button",mtcLabelLocalisation:Et}),c.createElement(Cl,{className:t,isSlimmerVersion:Se,onSubmit:function(e){return e.preventDefault()}},c.createElement(El,{"data-test":n||void 0},c.createElement(Il,{isSlimmerVersion:Se},c.createElement(h.ThemeProvider,{theme:Rt},c.createElement(ji,null,c.createElement(Ql,{isErrorBoxEnabled:hn||On||Ln},c.createElement(Cs,{className:t+"-editor",uicClientId:r,editorRef:at,placeholder:o,keyPressValue:Jt,setKeyPressValue:en,imageBlobDisplayRef:It,value:qn,onChange:U,onChangeInternal:Wn,editorInput:B,clearEditorState:At,onClearEditorState:_t,imageUrl:Lt,onImageUrlChange:zt,onClickSubmitButton:Vr,isLoading:ni,isBorderOrange:le,handleShowKeyboard:rn,populateHtml:ge,backButtonImage:er,setBackButtonImage:tr,enableAutoSuggest:ye,editorCharacterLimitExceeded:hn,isSlimmerVersion:Se,clearState:ke,setTranscribedContent:Cn,transcribedContent:xn,isInsideClicked:ir,setIsInsideClicked:ar,setPasteContent:kn,pasteContent:In,setSearchSubmitType:Pn,searchId:Bt,strackId:Wt,trackId:Qt,isErrorBoxEnabled:Ln||On,tryMsg:lr,setTryMsg:cr,hideTypeahead:ze,ocrLocalisationData:bt,sideBottomErrors:Ct,setLegacyIds:pr,enableNewLineOnEnter:br,mtcConversationId:Ge,isUicAtBottom:tt,hideAutoSuggestOnFirstLoad:De,editorId:k,enableDesktopToAppUICExperiment:$e,multipleImages:Ir,setMultipleImage:wr,multipleImageSupport:Je,singleImage:Pr,setImageCounter:Hr,setTypeaheadClickedValue:Dr})),c.createElement("div",null,hn&&c.createElement(Al,null,c.createElement(d.Z,{size:"small",svgColor:p.Z.red700}),null===xt||void 0===xt?void 0:xt.inputLimitExceeded),On&&c.createElement(Is,{message:(null===xt||void 0===xt?void 0:xt.multipleIsbnDetectedError)||"","data-test":n&&"".concat(n,"-error-message")}),Ln&&c.createElement(Is,{message:(null===xt||void 0===xt?void 0:xt.noMatchingIsbnFound)||"","data-test":n&&"".concat(n,"-error-message")}))))),c.createElement(kl,null,c.createElement(wl,null,c.createElement(xl,null,te&&c.createElement(nt,{id:pe,"aria-label":"Upload image",disabled:Je?5===Zr:!(!Lt&&!er),onClick:Ke?function(){null===Ke||void 0===Ke||Ke(kt)}:kt},c.createElement(f.Tooltip,{"data-test":"upload-image",position:Je&&it?dt?"topRight":"bottomRight":"top",open:!(!Je||!mt)||void 0,targetElement:c.createElement(m.Z,{"aria-hidden":!0,svgColor:p.Z.grey})},Je?mt?c.createElement(ic,{tooltipTitle:ft.multipleImageSupport.title,tooltipSubHeading:ft.multipleImageSupport.message,isCloseIcon:!0,handleCloseIconClick:function(e){e.stopPropagation(),vt(!1),Kl(Bl.MULTIPLE_IMAGE_TOOLTIP,!0,1)}}):c.createElement(ic,{tooltipTitle:5===Zr?ft.maxLimitReached:ft.uploadImage,tooltipSubHeading:it&&5!==Zr?ft.multipleImageSupport.message:""}):c.createElement(ic,{tooltipTitle:ft.uploadImage,isCloseIcon:!1}))),J?c.createElement(nt,{id:ve,"aria-label":"open keyboard",active:rn,onClick:function(){an(!rn),_e&&_e("keyboard"),function(e){Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:e?_.EXPAND:_.COLLAPSE,element:{name:H,type:A.ICON,region_name:tt?oe:N}},content:Ge?{metadata:{multi_turn_chat:{conversation_id:Ge}}}:void 0},eventVersion:3})}(!rn)},"data-test":"control-button"},c.createElement(f.Tooltip,{"data-test":"special-symbols",position:"top",targetElement:c.createElement(v.Z,{"aria-hidden":!0,svgColor:rn?p.Z.white:p.Z.grey})},c.createElement(Pl,null,ft.specialSymbols))):null)),c.createElement(wl,null,c.createElement(Ws,{className:"".concat(t||"","-submit-button"),"aria-label":Q,"data-test":n&&"".concat(n,"-submit-button"),disabled:!be(qn)||hn,isLoading:ni,onClick:function(){Pn(C.BUTTON_SUBMIT),Vr(C.BUTTON_SUBMIT)}})))),c.createElement(Sl,{className:"".concat(rn?"show":"hidden"),showKeyboardAnimation:Ae},c.createElement(Tl,{className:"".concat(t,"-keyboard"),isUicAtBottom:tt},c.createElement(Os,{setKeyPressValue:en,subject:ln,darkTheme:ae,physicsEquations:yt,mtcConversationId:Ge})),c.createElement(Ml,null,c.createElement(Ds,{handleSubject:function(e){cn(e)},darkTheme:ae,currentSubject:ln,allSubjects:gt,mtcConversationId:Ge,isUicAtBottom:tt}))),He&&c.createElement(Ls,{mtcDisclaimerLocalisation:St}))),c.createElement(kr,null)))},oc=function(e){var t=e.className,n=void 0===t?"":t,r=e["data-test"],i=e.editorRef,o=e.enableAutoSuggest,s=void 0===o||o,l=e.placeholder,u=e.onClickSubmitButton,d=e.value,p=void 0===d?"":d,m=e.onChange,v=void 0===m?x.ZT:m,f=e.editorInput,g=e.shouldClearEditor,y=e.onClearEditor,b=e.image,C=e.onImageChange,E=e.showMathKeyboard,S=e.localisationData,I=void 0===S?je:S,k=(0,c.useRef)(null),w=(0,h.createTheme)({},h.themes.horizon),T=I.ocrData,M=I.sideBottomErrors,P=(0,c.useState)(""),A=(0,a.Z)(P,2),_=A[0],O=A[1],N=(0,c.useState)(p),Z=(0,a.Z)(N,2),H=Z[0],L=Z[1],z=(0,c.useState)(!1),R=(0,a.Z)(z,2),D=R[0],U=R[1],B=void 0!=g?g:D,F=void 0!=y?y:U,j=(0,c.useState)(),q=(0,a.Z)(j,2),W=q[0],G=q[1],K=void 0!=b?b:W,V=void 0!=C?C:G;return c.createElement(c.Fragment,null,c.createElement(El,{"data-test":r||void 0},c.createElement(Il,null,c.createElement(h.ThemeProvider,{theme:w},c.createElement(ji,null,c.createElement(Cs,{className:n,editorRef:i,enableAutoSuggest:s,placeholder:l,keyPressValue:_,setKeyPressValue:O,imageBlobDisplayRef:k,value:H,onChange:v,onChangeInternal:L,editorInput:f,clearEditorState:B,onClearEditorState:F,imageUrl:K,onImageUrlChange:V,onClickSubmitButton:u,handleShowKeyboard:E,ocrLocalisationData:T,sideBottomErrors:M}))))))},sc=n(33238),lc=function(e,t){e=e.replace(Ge,"");var n=new Mi(e).Parse();null!==n&&void 0!==n&&n.prev&&li(t,n)},cc=function(e,t){var n=new yi(e).Parse();null!==n&&void 0!==n&&n.prev&&li(t,n)},uc=function(e){var t="",n="";if(e){var r=Dr();t=function(e){var t=[];return e&&e.length>0&&(0,sc.parse)(e,{lowerCaseTagName:!1}).querySelectorAll("img").forEach((function(e){var n=e.getAttribute("src")||"";t.push(n.trim())})),t.join(",")}(e);var i=function(e,t){for(var n=(0,sc.parse)(e).querySelectorAll("div"),r=n.length?n[0].childNodes:[],i=r.length-1;i>=0;i--){var a=r[i];"code"==a.rawTagName?lc(r[i].textContent,t):"p"==a.rawTagName&&cc(r[i].textContent,t)}return t}(e,r);n=function(e){var t=(0,sc.parse)(e).querySelectorAll("body");t[0].childNodes.forEach((function(e){var t=null,n=e.childNodes;(0,at.Z)(n).forEach((function(e){if("span"!==e.rawTagName||e.getAttribute("class"))t=null;else if(t){var n=e.textContent.replace(/\uFEFF/g,"");t.textContent+=n,e.parentNode.removeChild(e)}else(t=e).removeAttribute("id")}))}));var n="";return t.forEach((function(e){n+=e.innerHTML})),n}("<body>"+On(i)+"</body>")}return{imageUrl:t,html:n}},dc=n(11861),hc=function(e){var t,n=e.asciiMath,r=e.rendererHtml,i=e["data-test"],o=e.className,s=(0,h.createTheme)({},h.themes.horizon),l=(0,c.useState)(!1),u=(0,a.Z)(l,2),d=u[0],p=u[1],m=n?uc(n):{html:null===r||void 0===r?void 0:r.html,imageUrl:null===r||void 0===r?void 0:r.imageUrl};return c.createElement(h.ThemeProvider,{theme:s},c.createElement($o,{className:"mathContainer renderer","data-test":i},c.createElement(rs.og,null,c.createElement("div",{className:"".concat(o||"test","-editor editor"),role:"textbox","aria-label":"editorInput",tabIndex:0,style:{margin:"10px"}},c.createElement(Xo,{className:"mathEditorDisplay"},c.createElement("span",{dangerouslySetInnerHTML:{__html:null===m||void 0===m?void 0:m.html}})," "))),(null===m||void 0===m?void 0:m.imageUrl)&&c.createElement($l,{src:null===m||void 0===m?void 0:m.imageUrl.split(",")[0],alt:"student submitted image, transcription available"}),d&&(null===m||void 0===m?void 0:m.imageUrl.split(",").slice(1).map((function(e,t){return c.createElement($l,{key:t,src:e,alt:"student submitted image, transcription available"})}))),(null===m||void 0===m||null===(t=m.imageUrl)||void 0===t?void 0:t.split(",").length)>1&&c.createElement(Xl,null,c.createElement(ca.SecondaryButton,{variant:"outlined",onClick:function(){return function(){var e;p(!d),d||Xe({type:P.CLICKSTREAM_INTERACTION,data:{interaction:{type:_.EXPAND,element:{name:ve,type:A.BUTTON,region_name:de,value:null===m||void 0===m||null===(e=m.imageUrl)||void 0===e?void 0:e.split(",").length.toString()}}},eventVersion:3})}()},"data-test":"".concat(d?"Hide":"Show"," all images"),size:"small"},c.createElement(dc.Z,{pointing:d?"up":"down"}),c.createElement("span",null),"".concat(d?"Hide":"Show"," all images")))))},pc=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ll(Re,String(e))},mc=n(9366),vc=n(78763),fc=n(75719),gc=n(47093),yc=(0,et.ZP)(ea.Modal).withConfig({componentId:"l7ukzq-0"})(["box-shadow:0px 8px 12px 6px rgba(13,13,15,0.15),0px 4px 4px 0px rgba(13,13,15,0.3);border-radius:",";#PAQ-get-app-modal{box-shadow:0px 8px 12px 6px rgba(13,13,15,0.15),0px 4px 4px 0px rgba(13,13,15,0.3);border-radius:",";}button[aria-label='close dialog']{top:0;right:0;padding:1.25rem;}button[aria-label='close dialog'] > svg{height:",";width:",";min-height:",";min-width:",";}@media only screen and (max-width:","){button[aria-label='close dialog']{padding:",";}button[aria-label='close dialog'] > svg{height:",";width:",";min-height:",";min-width:",";}#PAQ-get-app-modal >:first-child{padding:",";}}"],Ye.Z.px8,Ye.Z.px8,Ye.Z.px24,Ye.Z.px24,Ye.Z.px24,Ye.Z.px24,Vi.Z.sm.max,Ye.Z.px8,Ye.Z.px16,Ye.Z.px16,Ye.Z.px16,Ye.Z.px16,Ye.Z.px32),bc=et.ZP.div.withConfig({componentId:"l7ukzq-1"})(["display:flex;align-items:center;flex-direction:column;text-align:center;"]),xc=et.ZP.h2.withConfig({componentId:"l7ukzq-2"})(["font-weight:",";font-size:",";line-height:",";margin:"," 0 0 0;@media only screen and (max-width:","){font-size:",";margin:",";}"],ua.Z.weight.bold,ua.Z.size.px32,ua.Z.lineHeight.sm,Ye.Z.px32,Vi.Z.sm.max,ua.Z.size.px28,(function(e){return e.modalType===$i.MWEB_TO_APP_SIGN_IN?0:"".concat(Ye.Z.px24," 0 0 0")})),Cc=et.ZP.p.withConfig({componentId:"l7ukzq-3"})(["font-size:",";line-height:",";"],(function(e){return e.modalType===$i.MWEB_TO_APP_SIGN_IN?ua.Z.size.px14:ua.Z.size.px16}),ua.Z.lineHeight.md),Ec=et.ZP.div.withConfig({componentId:"l7ukzq-4"})(["margin:"," 0 "," 0;@media only screen and (max-width:","){margin:"," 0 "," 0;}"],Ye.Z.px16,Ye.Z.px32,Vi.Z.sm.max,Ye.Z.px8,Ye.Z.px24),Sc=et.ZP.span.withConfig({componentId:"l7ukzq-5"})(["font-size:",";font-weight:",";"],(function(e){return e.modalType===$i.PAQ&&ua.Z.size.px12}),(function(e){return e.modalType===$i.PAQ&&ua.Z.weight.medium})),Ic=et.ZP.span.withConfig({componentId:"l7ukzq-6"})(["text-decoration:underline;padding-left:2px;cursor:pointer;user-select:none;font-weight:",";"],(function(e){return e.isBold?ua.Z.weight.bold:ua.Z.weight.medium})),kc=(0,et.ZP)(fc.Checkbox).withConfig({componentId:"l7ukzq-7"})(["margin-top:",";@media only screen and (max-width:","){text-align:left;margin:"," 0 0 ",";}"],Ye.Z.px32,Vi.Z.sm.max,Ye.Z.px24,Ye.Z.px8),wc=(0,et.ZP)(gc.Z).withConfig({componentId:"l7ukzq-8"})(["height:9.875rem;width:9.625rem;border-radius:",";min-height:initial;min-width:initial;"],Ye.Z.px16),Tc=(0,et.ZP)(ca.Button).withConfig({componentId:"l7ukzq-9"})(["padding:6px ",";height:",";width:95%;"],Ye.Z.px24,Ye.Z.px40),Mc=function(e){switch(e.modalType){case $i.PAQ:return c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:"140",width:"140",viewBox:"0 0 29 29"},c.createElement("path",{fill:"#FFFFFF",d:"M0,0 h29v29H0z","shape-rendering":"crispEdges"}),c.createElement("path",{fill:"#000000",d:"M0 0h7v1H0zM10 0h1v1H10zM12 0h1v1H12zM15 0h2v1H15zM19 0h1v1H19zM22,0 h7v1H22zM0 1h1v1H0zM6 1h1v1H6zM8 1h10v1H8zM19 1h1v1H19zM22 1h1v1H22zM28,1 h1v1H28zM0 2h1v1H0zM2 2h3v1H2zM6 2h1v1H6zM9 2h1v1H9zM12 2h1v1H12zM15 2h1v1H15zM18 2h1v1H18zM20 2h1v1H20zM22 2h1v1H22zM24 2h3v1H24zM28,2 h1v1H28zM0 3h1v1H0zM2 3h3v1H2zM6 3h1v1H6zM10 3h1v1H10zM14 3h3v1H14zM19 3h2v1H19zM22 3h1v1H22zM24 3h3v1H24zM28,3 h1v1H28zM0 4h1v1H0zM2 4h3v1H2zM6 4h1v1H6zM8 4h2v1H8zM11 4h1v1H11zM13 4h3v1H13zM17 4h3v1H17zM22 4h1v1H22zM24 4h3v1H24zM28,4 h1v1H28zM0 5h1v1H0zM6 5h1v1H6zM10 5h3v1H10zM15 5h2v1H15zM18 5h3v1H18zM22 5h1v1H22zM28,5 h1v1H28zM0 6h7v1H0zM8 6h1v1H8zM10 6h1v1H10zM12 6h1v1H12zM14 6h1v1H14zM16 6h1v1H16zM18 6h1v1H18zM20 6h1v1H20zM22,6 h7v1H22zM9 7h1v1H9zM13 7h1v1H13zM17 7h1v1H17zM19 7h1v1H19zM0 8h1v1H0zM2 8h1v1H2zM4 8h1v1H4zM6 8h1v1H6zM9 8h2v1H9zM16 8h2v1H16zM20 8h1v1H20zM24 8h1v1H24zM27 8h1v1H27zM2 9h2v1H2zM7 9h1v1H7zM9 9h2v1H9zM15 9h2v1H15zM20 9h3v1H20zM25 9h1v1H25zM28,9 h1v1H28zM4 10h1v1H4zM6 10h5v1H6zM14 10h1v1H14zM20 10h4v1H20zM26,10 h3v1H26zM0 11h1v1H0zM2 11h1v1H2zM7 11h1v1H7zM10 11h1v1H10zM13 11h1v1H13zM15 11h3v1H15zM20 11h1v1H20zM22 11h1v1H22zM27 11h1v1H27zM3 12h1v1H3zM5 12h2v1H5zM9 12h1v1H9zM13 12h1v1H13zM17 12h1v1H17zM19 12h2v1H19zM22 12h1v1H22zM25 12h1v1H25zM27,12 h2v1H27zM2 13h2v1H2zM7 13h5v1H7zM13 13h1v1H13zM21 13h2v1H21zM25 13h1v1H25zM28,13 h1v1H28zM0 14h1v1H0zM2 14h1v1H2zM5 14h2v1H5zM8 14h4v1H8zM13 14h2v1H13zM18 14h1v1H18zM21 14h1v1H21zM23 14h3v1H23zM27,14 h2v1H27zM2 15h2v1H2zM7 15h2v1H7zM12 15h2v1H12zM16 15h4v1H16zM25 15h1v1H25zM27 15h1v1H27zM1 16h1v1H1zM4 16h1v1H4zM6 16h2v1H6zM11 16h2v1H11zM14 16h1v1H14zM16 16h2v1H16zM19 16h1v1H19zM21 16h2v1H21zM25 16h1v1H25zM27,16 h2v1H27zM1 17h3v1H1zM7 17h2v1H7zM10 17h1v1H10zM15 17h2v1H15zM20 17h1v1H20zM22 17h1v1H22zM25 17h2v1H25zM28,17 h1v1H28zM0 18h1v1H0zM6 18h5v1H6zM13 18h1v1H13zM16 18h2v1H16zM20 18h1v1H20zM22 18h1v1H22zM24 18h1v1H24zM27,18 h2v1H27zM1 19h1v1H1zM5 19h1v1H5zM10 19h2v1H10zM15 19h1v1H15zM17 19h1v1H17zM19 19h2v1H19zM22 19h4v1H22zM27 19h1v1H27zM0 20h1v1H0zM2 20h9v1H2zM12 20h1v1H12zM17 20h1v1H17zM20 20h5v1H20zM8 21h1v1H8zM13 21h1v1H13zM19 21h2v1H19zM24 21h1v1H24zM26,21 h3v1H26zM0 22h7v1H0zM10 22h1v1H10zM14 22h1v1H14zM17 22h4v1H17zM22 22h1v1H22zM24 22h2v1H24zM27,22 h2v1H27zM0 23h1v1H0zM6 23h1v1H6zM11 23h1v1H11zM13 23h6v1H13zM20 23h1v1H20zM24 23h2v1H24zM27 23h1v1H27zM0 24h1v1H0zM2 24h3v1H2zM6 24h1v1H6zM8 24h4v1H8zM14 24h1v1H14zM16 24h3v1H16zM20 24h5v1H20zM0 25h1v1H0zM2 25h3v1H2zM6 25h1v1H6zM11 25h4v1H11zM16 25h1v1H16zM23 25h2v1H23zM26,25 h3v1H26zM0 26h1v1H0zM2 26h3v1H2zM6 26h1v1H6zM8 26h2v1H8zM11 26h2v1H11zM14 26h1v1H14zM17 26h1v1H17zM19 26h3v1H19zM23 26h3v1H23zM28,26 h1v1H28zM0 27h1v1H0zM6 27h1v1H6zM12 27h2v1H12zM15 27h1v1H15zM17 27h2v1H17zM20 27h1v1H20zM24 27h1v1H24zM27 27h1v1H27zM0 28h7v1H0zM8 28h1v1H8zM12 28h1v1H12zM14 28h3v1H14zM19 28h2v1H19zM22 28h1v1H22zM24 28h1v1H24zM27,28 h2v1H27z","shape-rendering":"crispEdges"}));case $i.UIC:return c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:"140",width:"140",viewBox:"0 0 29 29"},c.createElement("path",{fill:"#FFFFFF",d:"M0,0 h29v29H0z","shape-rendering":"crispEdges"}),c.createElement("path",{fill:"#000000",d:"M0 0h7v1H0zM9 0h2v1H9zM19 0h1v1H19zM22,0 h7v1H22zM0 1h1v1H0zM6 1h1v1H6zM8 1h1v1H8zM11 1h1v1H11zM13 1h3v1H13zM17 1h1v1H17zM19 1h1v1H19zM22 1h1v1H22zM28,1 h1v1H28zM0 2h1v1H0zM2 2h3v1H2zM6 2h1v1H6zM10 2h3v1H10zM18 2h1v1H18zM20 2h1v1H20zM22 2h1v1H22zM24 2h3v1H24zM28,2 h1v1H28zM0 3h1v1H0zM2 3h3v1H2zM6 3h1v1H6zM9 3h1v1H9zM14 3h2v1H14zM19 3h2v1H19zM22 3h1v1H22zM24 3h3v1H24zM28,3 h1v1H28zM0 4h1v1H0zM2 4h3v1H2zM6 4h1v1H6zM8 4h2v1H8zM11 4h1v1H11zM13 4h3v1H13zM17 4h3v1H17zM22 4h1v1H22zM24 4h3v1H24zM28,4 h1v1H28zM0 5h1v1H0zM6 5h1v1H6zM11 5h5v1H11zM18 5h3v1H18zM22 5h1v1H22zM28,5 h1v1H28zM0 6h7v1H0zM8 6h1v1H8zM10 6h1v1H10zM12 6h1v1H12zM14 6h1v1H14zM16 6h1v1H16zM18 6h1v1H18zM20 6h1v1H20zM22,6 h7v1H22zM9 7h9v1H9zM19 7h1v1H19zM0 8h1v1H0zM2 8h1v1H2zM4 8h1v1H4zM6 8h1v1H6zM10 8h1v1H10zM12 8h1v1H12zM17 8h1v1H17zM20 8h1v1H20zM24 8h1v1H24zM27 8h1v1H27zM1 9h2v1H1zM7 9h1v1H7zM10 9h2v1H10zM15 9h2v1H15zM20 9h3v1H20zM25 9h1v1H25zM28,9 h1v1H28zM2 10h1v1H2zM6 10h4v1H6zM12 10h1v1H12zM14 10h1v1H14zM20 10h4v1H20zM26,10 h3v1H26zM0 11h2v1H0zM3 11h2v1H3zM11 11h3v1H11zM15 11h1v1H15zM17 11h1v1H17zM20 11h1v1H20zM22 11h1v1H22zM27 11h1v1H27zM0 12h1v1H0zM4 12h4v1H4zM11 12h3v1H11zM15 12h1v1H15zM17 12h1v1H17zM19 12h2v1H19zM22 12h1v1H22zM25 12h1v1H25zM27,12 h2v1H27zM3 13h1v1H3zM8 13h1v1H8zM12 13h2v1H12zM16 13h1v1H16zM21 13h2v1H21zM25 13h1v1H25zM28,13 h1v1H28zM1 14h2v1H1zM4 14h1v1H4zM6 14h1v1H6zM9 14h3v1H9zM13 14h2v1H13zM16 14h1v1H16zM18 14h1v1H18zM21 14h1v1H21zM23 14h3v1H23zM27,14 h2v1H27zM0 15h1v1H0zM2 15h1v1H2zM4 15h2v1H4zM8 15h3v1H8zM12 15h2v1H12zM17 15h3v1H17zM25 15h1v1H25zM27 15h1v1H27zM0 16h1v1H0zM2 16h2v1H2zM5 16h2v1H5zM8 16h2v1H8zM11 16h1v1H11zM14 16h1v1H14zM17 16h1v1H17zM19 16h1v1H19zM21 16h2v1H21zM25 16h1v1H25zM27,16 h2v1H27zM5 17h1v1H5zM7 17h1v1H7zM11 17h1v1H11zM16 17h1v1H16zM20 17h1v1H20zM22 17h1v1H22zM25 17h2v1H25zM28,17 h1v1H28zM0 18h1v1H0zM3 18h2v1H3zM6 18h2v1H6zM13 18h1v1H13zM16 18h2v1H16zM20 18h1v1H20zM22 18h1v1H22zM24 18h1v1H24zM27,18 h2v1H27zM1 19h2v1H1zM4 19h2v1H4zM11 19h1v1H11zM15 19h3v1H15zM19 19h2v1H19zM22 19h4v1H22zM27 19h1v1H27zM0 20h1v1H0zM2 20h3v1H2zM6 20h2v1H6zM10 20h2v1H10zM15 20h3v1H15zM20 20h5v1H20zM8 21h2v1H8zM13 21h1v1H13zM16 21h1v1H16zM19 21h2v1H19zM24 21h1v1H24zM26,21 h3v1H26zM0 22h7v1H0zM10 22h1v1H10zM14 22h1v1H14zM17 22h4v1H17zM22 22h1v1H22zM24 22h2v1H24zM27,22 h2v1H27zM0 23h1v1H0zM6 23h1v1H6zM10 23h2v1H10zM13 23h2v1H13zM16 23h3v1H16zM20 23h1v1H20zM24 23h2v1H24zM27 23h1v1H27zM0 24h1v1H0zM2 24h3v1H2zM6 24h1v1H6zM8 24h2v1H8zM11 24h2v1H11zM14 24h5v1H14zM20 24h5v1H20zM0 25h1v1H0zM2 25h3v1H2zM6 25h1v1H6zM10 25h3v1H10zM14 25h1v1H14zM16 25h1v1H16zM23 25h2v1H23zM26,25 h3v1H26zM0 26h1v1H0zM2 26h3v1H2zM6 26h1v1H6zM8 26h2v1H8zM11 26h3v1H11zM16 26h2v1H16zM19 26h3v1H19zM23 26h3v1H23zM28,26 h1v1H28zM0 27h1v1H0zM6 27h1v1H6zM10 27h1v1H10zM12 27h1v1H12zM14 27h2v1H14zM17 27h2v1H17zM20 27h1v1H20zM24 27h1v1H24zM27 27h1v1H27zM0 28h7v1H0zM8 28h8v1H8zM17 28h1v1H17zM19 28h2v1H19zM22 28h1v1H22zM24 28h1v1H24zM27,28 h2v1H27z","shape-rendering":"crispEdges"}));case $i.MWEB_TO_APP_SIGN_IN:return c.createElement(wc,{size:"small"});default:return c.createElement(c.Fragment,null)}},Pc=function(e){var t=e.modalType,n=e.isOpen,r=e.isCheckboxChecked,i=e.onClose,a=e.handleCTAButtonClick,o=e.handleCheckboxClick,s=e.copyLinkCallback,l=e.downloadAppLink,u=e.experimentVariation,d=new Set([Hi.PHONE]),h=Ji(),p=d.has(h);(0,c.useEffect)((function(){t===$i.MWEB_TO_APP_SIGN_IN&&n&&function(e){var t=new Date;t.setHours(t.getHours()+24),Wl(e,"1",{expires:t})}(Bl.HIDE_MWEB_TO_APP_SIGNIN_MODAL)}),[t,n]);var m=function(){l&&navigator.clipboard.writeText(l),s&&s()},v=function(){return c.createElement(Sc,{modalType:t},"Don't have a camera?",c.createElement(Ic,{isBold:t===$i.UIC,onClick:m},"Copy a link to the app"))};return c.createElement(yc,{id:"".concat(t,"-get-app-modal"),isOpen:n,onClose:i,"aria-label":"Download app modal",size:"md",shouldCloseOnClickOutside:!1,focusFirstActiveElement:!1,renderFullScreenWithMarginOnMobile:!0,"data-test":Ka[t]},c.createElement(bc,null,function(){switch(t){case $i.PAQ:return c.createElement(c.Fragment,null,c.createElement(vc.SquareLogo,{size:p?"medium":"large"}),c.createElement(xc,null,so.PAQModal),c.createElement(Cc,null,lo.PAQModal),c.createElement(Ec,null,c.createElement(Mc,{modalType:$i.PAQ})),c.createElement("div",null,v()));case $i.UIC:return c.createElement(c.Fragment,null,c.createElement(mc.Z,{size:p?"small":"medium"}),c.createElement(xc,null,so.UICModal),c.createElement(Cc,null,lo.UICModal," ",v()),c.createElement(Ec,null,c.createElement(Mc,{modalType:$i.UIC})),c.createElement("div",null,c.createElement(ca.SecondaryButton,{onClick:a,"data-test":Wa},co),c.createElement(kc,{inputId:qa,checked:r,size:"small",onClick:o},"Don't show this message again")));case $i.MWEB_TO_APP_SIGN_IN:return c.createElement(c.Fragment,null,c.createElement(xc,{modalType:$i.MWEB_TO_APP_SIGN_IN},so.MWebToAppSignIn[u]),c.createElement(Cc,{modalType:$i.MWEB_TO_APP_SIGN_IN},lo.MWebToAppSignIn[u]),c.createElement(Ec,null,c.createElement(Mc,{modalType:$i.MWEB_TO_APP_SIGN_IN})),c.createElement(Tc,{onClick:a,"data-test":Wa},uo));default:return c.createElement(c.Fragment,null)}}()))},Ac=Pc,_c=function(){}},73706:function(){}}]);
//# sourceMappingURL=94366-de60866aaae7d6a9.js.map